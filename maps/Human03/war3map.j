globals
    // User-defined
unit udg_WaterElemental= null
group udg_StartingParty= null
group udg_BanditsVillage= null
group udg_SkeletonsArcher= null
group udg_Heroes= null
group udg_SkeletonsAmbush= null
group udg_Priests= null
group udg_SkeletonsMortarFodder= null
unit udg_Abomination= null
unit udg_KelThuzad= null
boolean udg_OpeningCancelled= false
boolean udg_Grain01Cancelled= false
boolean udg_WarehouseCancelled= false
group udg_SkeletonsPatrol01= null
unit udg_Arthas= null
unit udg_Jaina= null
group udg_SkeletonShipGroup= null
group udg_SkeletonFinalGroup= null
group udg_SkeletonBeforeMortarsGroup= null
group udg_PeasantPatrolGroup01= null
group udg_PeasantPatrolGroup02= null
destructable udg_Trees= null
quest udg_QuestFountain= null
quest udg_QuestInvestigateVillages= null
quest udg_QuestSkeleton= null
unit udg_Captain= null
quest udg_QuestDestroyGranary= null
group udg_FootmenDefending= null
unit udg_Granary01= null
questitem udg_GranaryReq= null
integer udg_GranaryReqInteger= 0
unit udg_Airship= null
unit udg_Acolyte01= null
unit udg_Acolyte02= null
group udg_BanditsCamp= null
group udg_AcolyteGroup= null
boolean udg_EncounterCancelled= false
effect udg_StacieBang= null
effect udg_AchillesBang= null
effect udg_AlricBang= null
unit udg_MortarTeam01= null
unit udg_MortarTeam02= null
questitem udg_QuestInvestigateReq= null
questitem udg_QuestFountainReq= null
boolean udg_GrainCancelled= false
boolean udg_EndingCancelled= false
unit udg_Skeleton01= null
unit udg_Skeleton02= null
unit udg_Skeleton03= null
unit udg_Skeleton04= null
integer udg_Tax= 0
fogmodifier udg_RiverRouteVis= null
location udg_CameraPosition= null
group udg_DefendersGroup= null
fogmodifier udg_BanditSightVis1= null
fogmodifier udg_BanditSightVis2= null
fogmodifier udg_BanditSightVis3= null
fogmodifier udg_BanditSightVis4= null
fogmodifier udg_BridgeVis= null
group udg_SelectionGroup= null
location udg_PositionArthas= null
location udg_PositionJaina= null
location udg_PositionCamera= null
boolean udg_GameOver= false
fogmodifier udg_GrainCinVis= null
fogmodifier udg_PriestsVis= null
fogmodifier udg_ArcherVis= null
fogmodifier udg_MortarTeamVis= null

    // Generated
rect gg_rct_AbominationAttack= null
rect gg_rct_AbominationAttack_2= null
rect gg_rct_AirshipStart= null
rect gg_rct_AmbushSkeletons= null
rect gg_rct_AmbushStart= null
rect gg_rct_ArcherPanCamera= null
rect gg_rct_ArcherVisibility= null
rect gg_rct_ArthasGranaryPost= null
rect gg_rct_ArthasGranaryTeleport= null
rect gg_rct_ArthasMove01= null
rect gg_rct_ArthasMove02= null
rect gg_rct_ArthasPost= null
rect gg_rct_ArthasStart= null
rect gg_rct_Bandit= null
rect gg_rct_BANDIT_SIGHT= null
rect gg_rct_BANDIT_SIGHT_2= null
rect gg_rct_BANDIT_SIGHT_3= null
rect gg_rct_BANDIT_SIGHT_4= null
rect gg_rct_BanditRoamCamp= null
rect gg_rct_BanditsVillageArea01= null
rect gg_rct_BanditsVillageArea02= null
rect gg_rct_BridgeOut= null
rect gg_rct_BridgeOutVillagerDestination= null
rect gg_rct_Captain1a= null
rect gg_rct_Captain1b= null
rect gg_rct_CaptainMoveStart= null
rect gg_rct_CaptainPost= null
rect gg_rct_CrateSkeleton01= null
rect gg_rct_DefendZone= null
rect gg_rct_EndCin_Arthas= null
rect gg_rct_EndCin_Jaina= null
rect gg_rct_EndCin_MoveOrderUnits= null
rect gg_rct_EndCin_MoveUnits= null
rect gg_rct_EndCrate01= null
rect gg_rct_EndCrate02= null
rect gg_rct_EndCrate03= null
rect gg_rct_EndCrate04= null
rect gg_rct_EndingSafetyGroupArea= null
rect gg_rct_Exit= null
rect gg_rct_FacingPoint= null
rect gg_rct_FinalCin_Abomination= null
rect gg_rct_FinalCin_Arthas= null
rect gg_rct_FinalCin_Jaina= null
rect gg_rct_Footman01= null
rect gg_rct_Footman02= null
rect gg_rct_Footman03= null
rect gg_rct_Footman04= null
rect gg_rct_Footman1b= null
rect gg_rct_Footman2b= null
rect gg_rct_Footman3b= null
rect gg_rct_Footman4b= null
rect gg_rct_FootmenDefendingArea= null
rect gg_rct_FountainOfLifeReveal= null
rect gg_rct_FountainOfLifeZone= null
rect gg_rct_FountainSkeleton01= null
rect gg_rct_FountainSkeleton02= null
rect gg_rct_Ghoul01= null
rect gg_rct_Ghoul02= null
rect gg_rct_GrainArea= null
rect gg_rct_Granary_Warehouse_Ping= null
rect gg_rct_Granary02Area= null
rect gg_rct_Granary03Area= null
rect gg_rct_HolyLightHintArea= null
rect gg_rct_JainaGranaryPost= null
rect gg_rct_JainaGranaryTeleport= null
rect gg_rct_JainaMove01= null
rect gg_rct_JainaMove02= null
rect gg_rct_JainaPost= null
rect gg_rct_KelThuzadAppear= null
rect gg_rct_KelThuzadPost= null
rect gg_rct_KelThuzadRevealer= null
rect gg_rct_KidsLaughing= null
rect gg_rct_KidsRunningArea= null
rect gg_rct_LakeLoop01= null
rect gg_rct_LakeLoop02= null
rect gg_rct_LakeLoop03= null
rect gg_rct_LakeLoop04= null
rect gg_rct_LakeLoop05= null
rect gg_rct_LakeLoop06= null
rect gg_rct_LakeLoop07= null
rect gg_rct_LakeLoop08= null
rect gg_rct_LakeLoop09= null
rect gg_rct_MortarTeam_Visibility= null
rect gg_rct_MortarTeamArea= null
rect gg_rct_MortarTeamCreate01= null
rect gg_rct_MortarTeamVisibility= null
rect gg_rct_MurlocArea= null
rect gg_rct_MurlocObserverDestination= null
rect gg_rct_MurlocPatrolPoint01= null
rect gg_rct_MurlocPatrolPoint02= null
rect gg_rct_Ogre_Attack_Move= null
rect gg_rct_OgreFace= null
rect gg_rct_OgreHide= null
rect gg_rct_Patrol01End= null
rect gg_rct_Patrol01Start= null
rect gg_rct_PatrolHello01area= null
rect gg_rct_PatrollSmallArea= null
rect gg_rct_PeasantPatrolArea= null
rect gg_rct_Priest_ArthasJaina_Here= null
rect gg_rct_Priest01GranaryPost= null
rect gg_rct_Priest02GranaryPost= null
rect gg_rct_Priests= null
rect gg_rct_PriestsStartArea= null
rect gg_rct_ResetCam= null
rect gg_rct_ResetCamGrain= null
rect gg_rct_RiverRouteVisibility= null
rect gg_rct_SheepArea= null
rect gg_rct_SheepBanditArea= null
rect gg_rct_SkeletonArchers= null
rect gg_rct_SkeletonBeforeMortars= null
rect gg_rct_SkeletonFinalGroup= null
rect gg_rct_SkeletonShip= null
rect gg_rct_SkeletonsMortarFodderEnd= null
rect gg_rct_SkeletonsMortarFodderStart= null
rect gg_rct_SkeletonSound= null
rect gg_rct_StartArthas= null
rect gg_rct_StartCaptain= null
rect gg_rct_StartJaina= null
rect gg_rct_StreamLoop01= null
rect gg_rct_TaxVillagerFace= null
rect gg_rct_TreesArea= null
rect gg_rct_VillagerActivateFountainQuest= null
rect gg_rct_VillageRaiseSkeletonStart= null
rect gg_rct_VillagerConcernedArea= null
rect gg_rct_VillagerConcernedDestination= null
rect gg_rct_VillagerHello01= null
rect gg_rct_VillagerHello02= null
rect gg_rct_VillagerKidsRunDest= null
rect gg_rct_VillagerKidsRunning01= null
rect gg_rct_VillagerKidsRunning02= null
rect gg_rct_VillagerKidsRunning03= null
rect gg_rct_VillagerRunDest09= null
rect gg_rct_VillagerTaxes= null
rect gg_rct_VillageRunDest01= null
rect gg_rct_VillageRunDest02= null
rect gg_rct_VillageRunDest03= null
rect gg_rct_VillageRunDest04= null
rect gg_rct_VillageRunDest05= null
rect gg_rct_VillageRunDest06= null
rect gg_rct_VillageRunDest07= null
rect gg_rct_VillageRunDest08= null
rect gg_rct_WaterElementalPost= null
rect gg_rct_MortarTeam_ArthasNear= null
rect gg_rct_FlySound= null
rect gg_rct_OgrePatroler= null
camerasetup gg_cam_Camera_001= null
camerasetup gg_cam_Camera_002= null
camerasetup gg_cam_Camera_003= null
camerasetup gg_cam_Camera_004= null
camerasetup gg_cam_Camera_005= null
camerasetup gg_cam_Camera_006= null
camerasetup gg_cam_Camera_007= null
camerasetup gg_cam_Arthas= null
camerasetup gg_cam_Jaina= null
camerasetup gg_cam_Formation= null
camerasetup gg_cam_GroupShot= null
camerasetup gg_cam_OgreBattle01= null
camerasetup gg_cam_OgreBattle02= null
camerasetup gg_cam_EscapeCam= null
camerasetup gg_cam_Granary01= null
camerasetup gg_cam_Granary02= null
camerasetup gg_cam_GranaryPriests= null
camerasetup gg_cam_Abomination= null
camerasetup gg_cam_Preload= null
camerasetup gg_cam_Granary04= null
camerasetup gg_cam_Ending01= null
camerasetup gg_cam_Ending02= null
camerasetup gg_cam_Ending03= null
camerasetup gg_cam_FinalCin1= null
camerasetup gg_cam_FinalCin2= null
sound gg_snd_H03Captain01= null
sound gg_snd_H03Arthas02= null
sound gg_snd_H03Arthas05= null
sound gg_snd_H03Arthas04= null
sound gg_snd_H03Jaina07= null
sound gg_snd_H03Arthas06= null
sound gg_snd_H03Arthas08= null
sound gg_snd_H03Jaina09= null
sound gg_snd_H03Footman13= null
sound gg_snd_H03Footman15= null
sound gg_snd_H03Arthas14= null
sound gg_snd_H03Arthas16= null
sound gg_snd_H03Arthas11= null
sound gg_snd_H03Arthas12= null
sound gg_snd_H03Jaina18= null
sound gg_snd_H03Jaina20= null
sound gg_snd_H03Jaina22= null
sound gg_snd_H03Arthas17= null
sound gg_snd_H03Arthas19= null
sound gg_snd_H03Arthas24= null
sound gg_snd_H03Priest21= null
sound gg_snd_H03Priest23= null
sound gg_snd_H03Arthas31= null
sound gg_snd_H03Arthas35= null
sound gg_snd_H03Arthas36= null
sound gg_snd_H03Arthas38= null
sound gg_snd_H03Jaina34= null
sound gg_snd_H03Jaina37= null
sound gg_snd_H03KelThuzad32= null
sound gg_snd_H03KelThuzad33= null
sound gg_snd_H03Dwarf26= null
sound gg_snd_H03Arthas27= null
sound gg_snd_H03VillagerF39= null
sound gg_snd_H03VillagerF53= null
sound gg_snd_H03VillagerM10= null
sound gg_snd_H03VillagerM40= null
sound gg_snd_H03VillagerM41= null
sound gg_snd_H03VillagerM45= null
sound gg_snd_H03VillagerM49= null
sound gg_snd_H03VillagerM50= null
sound gg_snd_H01VillagerC38= null
sound gg_snd_H01VillagerC37= null
sound gg_snd_H03Bandit51= null
sound gg_snd_H03Bandit52= null
sound gg_snd_H01VillagerF39= null
sound gg_snd_H01VillagerF40= null
sound gg_snd_H01VillagerF41= null
sound gg_snd_H01VillagerF42= null
sound gg_snd_H03Arthas25= null
sound gg_snd_MortarTeamWhat1= null
sound gg_snd_DefendCaster= null
sound gg_snd_RaiseSkeleton= null
sound gg_snd_AbominationYesAttack2= null
sound gg_snd_AbominationPissed5= null
sound gg_snd_WaterLakeLoop1= null
sound gg_snd_WaterStreamLoop1= null
sound gg_snd_H03Captain03= null
sound gg_snd_RaiseSkeleton01= null
sound gg_snd_RaiseSkeleton02= null
sound gg_snd_RaiseSkeleton03= null
sound gg_snd_DefendCaster01= null
sound gg_snd_DefendCaster02= null
sound gg_snd_LordaeronSummerFliesLoop1= null
sound gg_snd_DivineShield= null
trigger gg_trg_fileio= null
trigger gg_trg_map_config= null
trigger gg_trg_status= null
trigger gg_trg_heroes= null
trigger gg_trg_item_locations= null
trigger gg_trg_debug= null
trigger gg_trg_zoom= null
trigger gg_trg_irregulars= null
trigger gg_trg_AP_Load_Arthas= null
trigger gg_trg_AP_Load_Jaina= null
trigger gg_trg_MapInitialization= null
trigger gg_trg_Difficulty_Easy= null
trigger gg_trg_Difficulty_Normal= null
trigger gg_trg_Difficulty_Hard= null
trigger gg_trg_SetupOpeningAllies= null
trigger gg_trg_SetupHeroes= null
trigger gg_trg_SetupHeroGroup= null
trigger gg_trg_SetupCaptain= null
trigger gg_trg_SetupKelThuzad= null
trigger gg_trg_SetupAbomination= null
trigger gg_trg_SetupFootmenDefendingGroup= null
trigger gg_trg_SetupBanditVillageGroup= null
trigger gg_trg_SetupBanditCampGroup= null
trigger gg_trg_SetupAcolyteGroup= null
trigger gg_trg_SetupStartingPartyGroup= null
trigger gg_trg_SetupSkeletonArcherGroup= null
trigger gg_trg_SetupSkeletonGroup01= null
trigger gg_trg_SetupSkeletonGroup02= null
trigger gg_trg_SetupSkeletonShipGroup= null
trigger gg_trg_SetupPeasantPatrolGroup= null
trigger gg_trg_SetupSkeletonBeforeMortars= null
trigger gg_trg_SetupSkeletonFinalGroup= null
trigger gg_trg_SetupSkeletonsMortarFodder= null
trigger gg_trg_SetupPriestGroup= null
trigger gg_trg_SetupVillagerKidsJumping= null
trigger gg_trg_SetupCreeps= null
trigger gg_trg_SetupVillagerVision= null
trigger gg_trg_SetupScoreScreen= null
trigger gg_trg_Bubble= null
trigger gg_trg_VillagerConcernedDead= null
trigger gg_trg_VillagerBridgeOutDead= null
trigger gg_trg_VillagerFountainQuest= null
trigger gg_trg_SetupQuests= null
trigger gg_trg_Next_Level_Run= null
trigger gg_trg_Victory_Cheat= null
trigger gg_trg_DefeatCheat= null
trigger gg_trg_OpeningCancelled= null
trigger gg_trg_Opening01= null
trigger gg_trg_Opening02= null
trigger gg_trg_Opening03= null
trigger gg_trg_Opening04= null
trigger gg_trg_OgreRun= null
trigger gg_trg_JainaKillOgre= null
trigger gg_trg_JainaPost= null
trigger gg_trg_Water_Elemental_Hint_Queued= null
trigger gg_trg_GrainCinematicCancelled= null
trigger gg_trg_Grain01= null
trigger gg_trg_Grain01_Queue= null
trigger gg_trg_JainaFaceGrainery= null
trigger gg_trg_ArthasFaceGrainery= null
trigger gg_trg_Priests= null
trigger gg_trg_Priest_Queue= null
trigger gg_trg_EndingCancelled= null
trigger gg_trg_Ending01= null
trigger gg_trg_Ending01_Queue= null
trigger gg_trg_EncounterCancelled= null
trigger gg_trg_Encounter= null
trigger gg_trg_MortarTeamDialogue_DESTRUCTION= null
trigger gg_trg_AcolytesBusy= null
trigger gg_trg_AbominationDies= null
trigger gg_trg_Spawn_Ghouls= null
trigger gg_trg_SheepOgreArea= null
trigger gg_trg_SheepBanditArea= null
trigger gg_trg_SkeletonShip= null
trigger gg_trg_SkeletonFinal= null
trigger gg_trg_SkeletonBeforeMortars= null
trigger gg_trg_PeasantPatrolSmall= null
trigger gg_trg_PeasantPatrolHello01= null
trigger gg_trg_PeasantPatrol= null
trigger gg_trg_StartKidsRunning= null
trigger gg_trg_KidsRunningArea= null
trigger gg_trg_KidsLaughing= null
trigger gg_trg_KidsRunningDest01= null
trigger gg_trg_KidsRunningDest02= null
trigger gg_trg_KidsRunningDest03= null
trigger gg_trg_Ogre01= null
trigger gg_trg_BanditBusy= null
trigger gg_trg_VillagerConcernedMessage= null
trigger gg_trg_VillagerConcernedMessage_Queued= null
trigger gg_trg_Stacie_Killed= null
trigger gg_trg_VillagerHello= null
trigger gg_trg_Marie_Killed= null
trigger gg_trg_VillagerHello01= null
trigger gg_trg_Farmer_Killed= null
trigger gg_trg_VillagerTaxesMessage= null
trigger gg_trg_TaxEvader_Killed= null
trigger gg_trg_ClicksMetGold= null
trigger gg_trg_ClicksMetItem= null
trigger gg_trg_PayoutGold= null
trigger gg_trg_PayoutItem= null
trigger gg_trg_Clicks= null
trigger gg_trg_VillagerBridgeOutMessage= null
trigger gg_trg_Achilles_Dead= null
trigger gg_trg_MurlocPatrol= null
trigger gg_trg_MurlocObserver= null
trigger gg_trg_VillagerSplendora= null
trigger gg_trg_VillagerInRange= null
trigger gg_trg_Que_Splendora_Speech= null
trigger gg_trg_VillagerDies= null
trigger gg_trg_StartAttack= null
trigger gg_trg_SuicideBandits= null
trigger gg_trg_BanditsAllDie= null
trigger gg_trg_Stacie= null
trigger gg_trg_Achilles= null
trigger gg_trg_Marie= null
trigger gg_trg_Linda= null
trigger gg_trg_Jillian= null
trigger gg_trg_FountainSideQuest= null
trigger gg_trg_FountainSideQuest_Que= null
trigger gg_trg_Alric_is_Killed= null
trigger gg_trg_Fountain_Found= null
trigger gg_trg_StartDefend= null
trigger gg_trg_SkeletonsDyingCheck= null
trigger gg_trg_SkeletonsAllDead= null
trigger gg_trg_Defend_Hint_Que= null
trigger gg_trg_RemoveDeadFromGroup= null
trigger gg_trg_Holy_Light_Hint= null
trigger gg_trg_Holy_Light_Hint_Q= null
trigger gg_trg_AmbushStart= null
trigger gg_trg_AttackingSkeletons01= null
trigger gg_trg_AttackingSkeletons02= null
trigger gg_trg_AttackingSkeletons03= null
trigger gg_trg_CrateSkeleton01= null
trigger gg_trg_MortarTeamStart= null
trigger gg_trg_MortarTeamDialogue= null
trigger gg_trg_DefeatArthasDeath= null
trigger gg_trg_DefeatJainaDeath= null
trigger gg_trg_Victory= null
unit gg_unit_hcth_0062= null
unit gg_unit_hfoo_0003= null
unit gg_unit_hfoo_0004= null
unit gg_unit_nvil_0068= null
unit gg_unit_nogr_0008= null
unit gg_unit_nogr_0009= null
unit gg_unit_nogr_0012= null
unit gg_unit_nvil_0022= null
unit gg_unit_nC09_0001= null
unit gg_unit_nC08_0155= null
unit gg_unit_uaco_0100= null
unit gg_unit_nC04_0118= null
unit gg_unit_nvil_0124= null
unit gg_unit_nvil_0123= null
unit gg_unit_hfoo_0005= null
unit gg_unit_nvil_0024= null
unit gg_unit_nvlk_0026= null
unit gg_unit_nC10_0121= null
unit gg_unit_nvil_0033= null
unit gg_unit_nvil_0034= null
unit gg_unit_nenf_0102= null
unit gg_unit_ngni_0080= null
unit gg_unit_nvlk_0025= null
unit gg_unit_hfoo_0042= null
unit gg_unit_hfoo_0043= null
unit gg_unit_nban_0044= null
unit gg_unit_nban_0045= null
unit gg_unit_nban_0046= null
unit gg_unit_nvil_0047= null
unit gg_unit_nvil_0048= null
unit gg_unit_nvil_0049= null
unit gg_unit_nvil_0120= null
unit gg_unit_nska_0105= null
unit gg_unit_nmrl_0014= null
unit gg_unit_nvil_0010= null
unit gg_unit_nvil_0119= null
unit gg_unit_uske_0066= null
unit gg_unit_hmpr_0072= null
unit gg_unit_hmpr_0073= null
unit gg_unit_nC02_0039= null
unit gg_unit_uktn_0109= null
unit gg_unit_nshe_0081= null
unit gg_unit_nrog_0127= null
unit gg_unit_nban_0126= null
unit gg_unit_nvil_0125= null
unit gg_unit_nC03_0092= null
unit gg_unit_nvil_0116= null
unit gg_unit_nban_0088= null
unit gg_unit_nmrl_0023= null
unit gg_unit_nC00_0093= null
unit gg_unit_uske_0098= null
unit gg_unit_nvil_0099= null
unit gg_unit_uaco_0095= null
unit gg_unit_ngwr_0074= null
unit gg_unit_nvil_0085= null
unit gg_unit_uske_0065= null
unit gg_unit_uske_0069= null
unit gg_unit_uske_0087= null
unit gg_unit_uske_0096= null
unit gg_unit_nC01_0002= null
unit gg_unit_uabo_0110= null
unit gg_unit_uaco_0038= null
unit gg_unit_uaco_0040= null
unit gg_unit_nska_0153= null
unit gg_unit_nska_0027= null
unit gg_unit_nska_0137= null
unit gg_unit_unec_0139= null
unit gg_unit_nban_0140= null
unit gg_unit_nban_0141= null
unit gg_unit_nmrl_0142= null
unit gg_unit_nrog_0143= null
unit gg_unit_nska_0144= null
unit gg_unit_nska_0145= null
unit gg_unit_nska_0146= null
unit gg_unit_uske_0147= null
unit gg_unit_uske_0148= null
unit gg_unit_nska_0149= null
unit gg_unit_nska_0150= null
unit gg_unit_nska_0151= null
unit gg_unit_nska_0152= null
destructable gg_dest_LTba_2334= null
destructable gg_dest_LTcr_2313= null
destructable gg_dest_LTcr_1798= null
destructable gg_dest_LTcr_2310= null
destructable gg_dest_LTcr_2312= null
string array p_original_names
string array io_lines
constant integer NUM_FILE_LINES= 10
string last_filename= ""
constant integer MISSION_ID= 103
integer NUM_HEROES= 2
constant player USER_PLAYER= Player(1)
integer array hero_global_slots
constant integer item_channel_1= 1
constant integer item_channel_2= - 1
constant integer item_channel_2_hero_slot= - 1
constant integer HERO_ID_ALL= - 1
constant integer HERO_ID_NONE= 0
constant integer HERO_ID_PALADIN_ARTHAS= 1
constant integer HERO_ID_JAINA= 2
constant integer HERO_ID_MURADIN_BRONZEBEARD= 3
constant integer HERO_ID_THRALL= 4
constant integer HERO_ID_CAIRNE_BLOODHOOF= 5
constant integer HERO_ID_GROM_HELLSCREAM= 6
constant integer HERO_ID_DEATH_KNIGHT_ARTHAS= 7
constant integer HERO_ID_KEL_THUZAD= 8
constant integer HERO_ID_ARTHAS_TFT= 9
constant integer HERO_ID_SYLVANAS= 10
constant integer HERO_ID_VARIMATHRAS= 11
constant integer HERO_ID_ANUB_ARAK= 12
constant integer HERO_ID_TYRANDE= 13
constant integer HERO_ID_FURION= 14
constant integer HERO_ID_ILLIDAN= 15
constant integer HERO_ID_TYRANDE_TFT= 16
constant integer HERO_ID_MALFURION= 17
constant integer HERO_ID_MAIEV= 18
constant integer HERO_ID_KAEL_THAS= 19
constant integer HERO_ID_DEMON_ILLIDAN= 20
constant integer HERO_ID_LADY_VASHJ= 21
constant integer HERO_ID_AKAMA= 22
constant integer HERO_ID_LORD_GARITHOS= 23
constant string COMM_VERSION= "1.0"
constant integer MAX_UPDATE_ID= 100000
integer error_state= 0
integer world_id= - 1
integer last_unlock_packet= - 1
integer last_location_packet= - 1
integer last_message_packet= - 1
integer last_hero_packet= - 1
integer last_item_packet= - 1
integer last_item_channel_packet= - 1
integer checks_before_timeout= 2
boolean array locations_checked
constant integer MAX_LOCATIONS= 30
constant integer MAX_ITEMS_PER_PACKET= 12
integer update_index= - 1
integer hero_status_index= - 1
integer num_channel_1_items_received= 0
integer num_channel_2_items_received= 0
timer status_ack_ping_timer
trigger t_captain_promoted
unit item_channel_1_target= null
unit item_channel_2_target= null
integer array HERO_MAX_LEVEL
integer array hero_hashes
trigger t_hero_update
trigger t_hero_pickup_item
trigger t_hero_configure_all
trigger t_hero_set_all_max_level
timer hero_update_status_timer
integer array hero_abil_1
integer array hero_abil_2
integer array hero_abil_3
integer array hero_abil_4
trigger t_location_found= null
trigger t_help
trigger t_print
trigger t_xp
trigger t_xp2
trigger t_health
trigger t_dragon
trigger t_speed
trigger t_zoom
trigger t_irregulars_on_cast


//JASSHelper struct globals:

endglobals


//===========================================================================
// 
// Human03
// 
//   Warcraft III map script
//   Generated by the Warcraft III World Editor
//   Date: Sat Sep 20 00:49:31 2025
//   Map Author: Blizzard Entertainment
// 
//===========================================================================

//***************************************************************************
//*
//*  Global Variables
//*
//***************************************************************************


function InitGlobals takes nothing returns nothing
    set udg_WaterElemental=null
    set udg_StartingParty=CreateGroup()
    set udg_BanditsVillage=CreateGroup()
    set udg_SkeletonsArcher=CreateGroup()
    set udg_Heroes=CreateGroup()
    set udg_SkeletonsAmbush=CreateGroup()
    set udg_Priests=CreateGroup()
    set udg_SkeletonsMortarFodder=CreateGroup()
    set udg_OpeningCancelled=false
    set udg_Grain01Cancelled=false
    set udg_WarehouseCancelled=false
    set udg_SkeletonsPatrol01=CreateGroup()
    set udg_SkeletonShipGroup=CreateGroup()
    set udg_SkeletonFinalGroup=CreateGroup()
    set udg_SkeletonBeforeMortarsGroup=CreateGroup()
    set udg_PeasantPatrolGroup01=CreateGroup()
    set udg_PeasantPatrolGroup02=CreateGroup()
    set udg_FootmenDefending=CreateGroup()
    set udg_GranaryReqInteger=0
    set udg_BanditsCamp=CreateGroup()
    set udg_AcolyteGroup=CreateGroup()
    set udg_EncounterCancelled=false
    set udg_GrainCancelled=false
    set udg_EndingCancelled=false
    set udg_Skeleton01=null
    set udg_Skeleton02=null
    set udg_Skeleton03=null
    set udg_Skeleton04=null
    set udg_Tax=0
    set udg_DefendersGroup=CreateGroup()
    set udg_SelectionGroup=CreateGroup()
    set udg_GameOver=false
endfunction

//***************************************************************************
//*
//*  Unit Item Tables
//*
//***************************************************************************

function Unit000076_DropItems takes nothing returns nothing
    local widget trigWidget= null
    local unit trigUnit= null
    local integer itemID= 0
    local boolean canDrop= true

    set trigWidget=bj_lastDyingWidget
    if ( trigWidget == null ) then
        set trigUnit=GetTriggerUnit()
    endif

    if ( trigUnit != null ) then
        set canDrop=not IsUnitHidden(trigUnit)
        if ( canDrop and GetChangingUnit() != null ) then
            set canDrop=( GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
        endif
    endif

    if ( canDrop ) then
        // Item set 0
        call RandomDistReset()
        call RandomDistAddItem('I011', 100)
        set itemID=RandomDistChoose()
        if ( trigUnit != null ) then
            call UnitDropItem(trigUnit, itemID)
        else
            call WidgetDropItem(trigWidget, itemID)
        endif

    endif

    set bj_lastDyingWidget=null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

function Unit000092_DropItems takes nothing returns nothing
    local widget trigWidget= null
    local unit trigUnit= null
    local integer itemID= 0
    local boolean canDrop= true

    set trigWidget=bj_lastDyingWidget
    if ( trigWidget == null ) then
        set trigUnit=GetTriggerUnit()
    endif

    if ( trigUnit != null ) then
        set canDrop=not IsUnitHidden(trigUnit)
        if ( canDrop and GetChangingUnit() != null ) then
            set canDrop=( GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
        endif
    endif

    if ( canDrop ) then
        // Item set 0
        call RandomDistReset()
        call RandomDistAddItem('I016', 100)
        set itemID=RandomDistChoose()
        if ( trigUnit != null ) then
            call UnitDropItem(trigUnit, itemID)
        else
            call WidgetDropItem(trigWidget, itemID)
        endif

    endif

    set bj_lastDyingWidget=null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

function Unit000109_DropItems takes nothing returns nothing
    local widget trigWidget= null
    local unit trigUnit= null
    local integer itemID= 0
    local boolean canDrop= true

    set trigWidget=bj_lastDyingWidget
    if ( trigWidget == null ) then
        set trigUnit=GetTriggerUnit()
    endif

    if ( trigUnit != null ) then
        set canDrop=not IsUnitHidden(trigUnit)
        if ( canDrop and GetChangingUnit() != null ) then
            set canDrop=( GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
        endif
    endif

    if ( canDrop ) then
        // Item set 0
        call RandomDistReset()
        call RandomDistAddItem('I014', 100)
        set itemID=RandomDistChoose()
        if ( trigUnit != null ) then
            call UnitDropItem(trigUnit, itemID)
        else
            call WidgetDropItem(trigWidget, itemID)
        endif

    endif

    set bj_lastDyingWidget=null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

function Unit000117_DropItems takes nothing returns nothing
    local widget trigWidget= null
    local unit trigUnit= null
    local integer itemID= 0
    local boolean canDrop= true

    set trigWidget=bj_lastDyingWidget
    if ( trigWidget == null ) then
        set trigUnit=GetTriggerUnit()
    endif

    if ( trigUnit != null ) then
        set canDrop=not IsUnitHidden(trigUnit)
        if ( canDrop and GetChangingUnit() != null ) then
            set canDrop=( GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
        endif
    endif

    if ( canDrop ) then
        // Item set 0
        call RandomDistReset()
        call RandomDistAddItem('I012', 100)
        set itemID=RandomDistChoose()
        if ( trigUnit != null ) then
            call UnitDropItem(trigUnit, itemID)
        else
            call WidgetDropItem(trigWidget, itemID)
        endif

    endif

    set bj_lastDyingWidget=null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction

function Unit000126_DropItems takes nothing returns nothing
    local widget trigWidget= null
    local unit trigUnit= null
    local integer itemID= 0
    local boolean canDrop= true

    set trigWidget=bj_lastDyingWidget
    if ( trigWidget == null ) then
        set trigUnit=GetTriggerUnit()
    endif

    if ( trigUnit != null ) then
        set canDrop=not IsUnitHidden(trigUnit)
        if ( canDrop and GetChangingUnit() != null ) then
            set canDrop=( GetChangingUnitPrevOwner() == Player(PLAYER_NEUTRAL_AGGRESSIVE) )
        endif
    endif

    if ( canDrop ) then
        // Item set 0
        call RandomDistReset()
        call RandomDistAddItem('I017', 100)
        set itemID=RandomDistChoose()
        if ( trigUnit != null ) then
            call UnitDropItem(trigUnit, itemID)
        else
            call WidgetDropItem(trigWidget, itemID)
        endif

    endif

    set bj_lastDyingWidget=null
    call DestroyTrigger(GetTriggeringTrigger())
endfunction


//***************************************************************************
//*
//*  Sounds
//*
//***************************************************************************

function InitSounds takes nothing returns nothing
    set gg_snd_H03Captain01=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Captain01.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Captain01, "H03Captain01")
    call SetSoundDuration(gg_snd_H03Captain01, 5564)
    set gg_snd_H03Arthas02=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas02.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas02, "H03Arthas02")
    call SetSoundDuration(gg_snd_H03Arthas02, 3186)
    set gg_snd_H03Arthas05=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas05.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas05, "H03Arthas05")
    call SetSoundDuration(gg_snd_H03Arthas05, 8097)
    set gg_snd_H03Arthas04=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas04.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas04, "H03Arthas04")
    call SetSoundDuration(gg_snd_H03Arthas04, 3291)
    set gg_snd_H03Jaina07=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina07.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina07, "H03Jaina07")
    call SetSoundDuration(gg_snd_H03Jaina07, 5146)
    set gg_snd_H03Arthas06=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas06.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas06, "H03Arthas06")
    call SetSoundDuration(gg_snd_H03Arthas06, 5067)
    set gg_snd_H03Arthas08=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas08.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas08, "H03Arthas08")
    call SetSoundDuration(gg_snd_H03Arthas08, 4310)
    set gg_snd_H03Jaina09=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina09.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina09, "H03Jaina09")
    call SetSoundDuration(gg_snd_H03Jaina09, 6426)
    set gg_snd_H03Footman13=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Footman13.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Footman13, "H03Footman13")
    call SetSoundDuration(gg_snd_H03Footman13, 4205)
    set gg_snd_H03Footman15=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Footman15.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Footman15, "H03Footman15")
    call SetSoundDuration(gg_snd_H03Footman15, 6713)
    set gg_snd_H03Arthas14=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas14.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas14, "H03Arthas14")
    call SetSoundDuration(gg_snd_H03Arthas14, 1384)
    set gg_snd_H03Arthas16=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas16.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas16, "H03Arthas16")
    call SetSoundDuration(gg_snd_H03Arthas16, 1619)
    set gg_snd_H03Arthas11=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas11.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas11, "H03Arthas11")
    call SetSoundDuration(gg_snd_H03Arthas11, 2011)
    set gg_snd_H03Arthas12=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas12.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas12, "H03Arthas12")
    call SetSoundDuration(gg_snd_H03Arthas12, 6765)
    set gg_snd_H03Jaina18=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina18.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina18, "H03Jaina18")
    call SetSoundDuration(gg_snd_H03Jaina18, 3840)
    set gg_snd_H03Jaina20=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina20.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina20, "H03Jaina20")
    call SetSoundDuration(gg_snd_H03Jaina20, 13008)
    set gg_snd_H03Jaina22=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina22.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina22, "H03Jaina22")
    call SetSoundDuration(gg_snd_H03Jaina22, 4310)
    set gg_snd_H03Arthas17=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas17.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas17, "H03Arthas17")
    call SetSoundDuration(gg_snd_H03Arthas17, 2638)
    set gg_snd_H03Arthas19=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas19.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas19, "H03Arthas19")
    call SetSoundDuration(gg_snd_H03Arthas19, 1828)
    set gg_snd_H03Arthas24=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas24.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas24, "H03Arthas24")
    call SetSoundDuration(gg_snd_H03Arthas24, 1044)
    set gg_snd_H03Priest21=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Priest21.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Priest21, "H03Priest21")
    call SetSoundDuration(gg_snd_H03Priest21, 6765)
    set gg_snd_H03Priest23=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Priest23.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Priest23, "H03Priest23")
    call SetSoundDuration(gg_snd_H03Priest23, 6974)
    set gg_snd_H03Arthas31=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas31.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas31, "H03Arthas31")
    call SetSoundDuration(gg_snd_H03Arthas31, 2951)
    set gg_snd_H03Arthas35=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas35.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas35, "H03Arthas35")
    call SetSoundDuration(gg_snd_H03Arthas35, 2403)
    set gg_snd_H03Arthas36=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas36.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas36, "H03Arthas36")
    call SetSoundDuration(gg_snd_H03Arthas36, 3761)
    set gg_snd_H03Arthas38=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas38.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas38, "H03Arthas38")
    call SetSoundDuration(gg_snd_H03Arthas38, 4884)
    set gg_snd_H03Jaina34=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina34.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina34, "H03Jaina34")
    call SetSoundDuration(gg_snd_H03Jaina34, 4205)
    set gg_snd_H03Jaina37=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Jaina37.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Jaina37, "H03Jaina37")
    call SetSoundDuration(gg_snd_H03Jaina37, 6164)
    set gg_snd_H03KelThuzad32=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03KelThuzad32.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03KelThuzad32, "H03KelThuzad32")
    call SetSoundDuration(gg_snd_H03KelThuzad32, 4493)
    set gg_snd_H03KelThuzad33=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03KelThuzad33.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03KelThuzad33, "H03KelThuzad33")
    call SetSoundDuration(gg_snd_H03KelThuzad33, 4153)
    set gg_snd_H03Dwarf26=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Dwarf26.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Dwarf26, "H03Dwarf26")
    call SetSoundDuration(gg_snd_H03Dwarf26, 5198)
    set gg_snd_H03Arthas27=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas27.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas27, "H03Arthas27")
    call SetSoundDuration(gg_snd_H03Arthas27, 3892)
    set gg_snd_H03VillagerF39=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerF39.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerF39, "H03VillagerF39")
    call SetSoundDuration(gg_snd_H03VillagerF39, 3787)
    set gg_snd_H03VillagerF53=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerF53.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerF53, "H03VillagerF53")
    call SetSoundDuration(gg_snd_H03VillagerF53, 1985)
    set gg_snd_H03VillagerM10=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM10.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM10, "H03VillagerM10")
    call SetSoundDuration(gg_snd_H03VillagerM10, 8097)
    set gg_snd_H03VillagerM40=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM40.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM40, "H03VillagerM40")
    call SetSoundDuration(gg_snd_H03VillagerM40, 9064)
    set gg_snd_H03VillagerM41=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM41.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM41, "H03VillagerM41")
    call SetSoundDuration(gg_snd_H03VillagerM41, 1253)
    set gg_snd_H03VillagerM45=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM45.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM45, "H03VillagerM45")
    call SetSoundDuration(gg_snd_H03VillagerM45, 4075)
    set gg_snd_H03VillagerM49=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM49.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM49, "H03VillagerM49")
    call SetSoundDuration(gg_snd_H03VillagerM49, 1697)
    set gg_snd_H03VillagerM50=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03VillagerM50.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03VillagerM50, "H03VillagerM50")
    call SetSoundDuration(gg_snd_H03VillagerM50, 1227)
    set gg_snd_H01VillagerC38=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerC38.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerC38, "H01VillagerC38")
    call SetSoundDuration(gg_snd_H01VillagerC38, 1253)
    set gg_snd_H01VillagerC37=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerC37.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerC37, "H01VillagerC37")
    call SetSoundDuration(gg_snd_H01VillagerC37, 940)
    set gg_snd_H03Bandit51=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Bandit51.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Bandit51, "H03Bandit51")
    call SetSoundDuration(gg_snd_H03Bandit51, 1593)
    set gg_snd_H03Bandit52=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Bandit52.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Bandit52, "H03Bandit52")
    call SetSoundDuration(gg_snd_H03Bandit52, 1750)
    set gg_snd_H01VillagerF39=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerF39.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerF39, "H01VillagerF39")
    call SetSoundDuration(gg_snd_H01VillagerF39, 1724)
    set gg_snd_H01VillagerF40=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerF40.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerF40, "H01VillagerF40")
    call SetSoundDuration(gg_snd_H01VillagerF40, 1280)
    set gg_snd_H01VillagerF41=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerF41.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerF41, "H01VillagerF41")
    call SetSoundDuration(gg_snd_H01VillagerF41, 914)
    set gg_snd_H01VillagerF42=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human01\\H01VillagerF42.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H01VillagerF42, "H01VillagerF42")
    call SetSoundDuration(gg_snd_H01VillagerF42, 2951)
    set gg_snd_H03Arthas25=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Arthas25.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Arthas25, "H03Arthas25")
    call SetSoundDuration(gg_snd_H03Arthas25, 2011)
    set gg_snd_MortarTeamWhat1=CreateSound("Units\\Human\\MortarTeam\\MortarTeamWhat1.wav", false, true, true, 10, 10, "DefaultEAXON")
    call SetSoundParamsFromLabel(gg_snd_MortarTeamWhat1, "MortarTeamWhat")
    call SetSoundDuration(gg_snd_MortarTeamWhat1, 1105)
    set gg_snd_DefendCaster=CreateSound("Abilities\\Spells\\Human\\Defend\\DefendCaster.wav", false, true, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_DefendCaster, "Defend")
    call SetSoundDuration(gg_snd_DefendCaster, 1166)
    set gg_snd_RaiseSkeleton=CreateSound("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.wav", false, false, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_RaiseSkeleton, "RaiseSkeletonArcher")
    call SetSoundDuration(gg_snd_RaiseSkeleton, 2329)
    set gg_snd_AbominationYesAttack2=CreateSound("Units\\Undead\\Abomination\\AbominationYesAttack2.wav", false, true, true, 10, 10, "DefaultEAXON")
    call SetSoundParamsFromLabel(gg_snd_AbominationYesAttack2, "AbominationYesAttack")
    call SetSoundDuration(gg_snd_AbominationYesAttack2, 1195)
    set gg_snd_AbominationPissed5=CreateSound("Units\\Undead\\Abomination\\AbominationPissed5.wav", false, true, true, 10, 10, "DefaultEAXON")
    call SetSoundParamsFromLabel(gg_snd_AbominationPissed5, "AbominationPissed")
    call SetSoundDuration(gg_snd_AbominationPissed5, 1734)
    set gg_snd_WaterLakeLoop1=CreateSound("Sound\\Ambient\\DoodadEffects\\WaterLakeLoop1.wav", true, true, true, 10, 10, "DoodadsEAX")
    call SetSoundParamsFromLabel(gg_snd_WaterLakeLoop1, "LakeLoop")
    call SetSoundDuration(gg_snd_WaterLakeLoop1, 3297)
    set gg_snd_WaterStreamLoop1=CreateSound("Sound\\Ambient\\DoodadEffects\\WaterStreamLoop1.wav", true, true, true, 10, 10, "DoodadsEAX")
    call SetSoundParamsFromLabel(gg_snd_WaterStreamLoop1, "StreamLoop")
    call SetSoundDuration(gg_snd_WaterStreamLoop1, 2008)
    set gg_snd_H03Captain03=CreateSound("Sound\\Dialogue\\HumanCampaign\\Human03\\H03Captain03.mp3", false, false, false, 10, 10, "")
    call SetSoundParamsFromLabel(gg_snd_H03Captain03, "H03Captain03")
    call SetSoundDuration(gg_snd_H03Captain03, 1071)
    set gg_snd_RaiseSkeleton01=CreateSound("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.wav", false, false, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_RaiseSkeleton01, "RaiseSkeletonArcher")
    call SetSoundDuration(gg_snd_RaiseSkeleton01, 2329)
    set gg_snd_RaiseSkeleton02=CreateSound("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.wav", false, false, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_RaiseSkeleton02, "RaiseSkeletonArcher")
    call SetSoundDuration(gg_snd_RaiseSkeleton02, 2329)
    set gg_snd_RaiseSkeleton03=CreateSound("Abilities\\Spells\\Undead\\RaiseSkeletonWarrior\\RaiseSkeleton.wav", false, false, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_RaiseSkeleton03, "RaiseSkeletonArcher")
    call SetSoundDuration(gg_snd_RaiseSkeleton03, 2329)
    set gg_snd_DefendCaster01=CreateSound("Abilities\\Spells\\Human\\Defend\\DefendCaster.wav", false, true, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_DefendCaster01, "Defend")
    call SetSoundDuration(gg_snd_DefendCaster01, 1166)
    set gg_snd_DefendCaster02=CreateSound("Abilities\\Spells\\Human\\Defend\\DefendCaster.wav", false, true, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_DefendCaster02, "Defend")
    call SetSoundDuration(gg_snd_DefendCaster02, 1166)
    set gg_snd_LordaeronSummerFliesLoop1=CreateSound("Sound\\Ambient\\DoodadEffects\\LordaeronSummerFliesLoop1.wav", true, true, true, 10, 10, "DoodadsEAX")
    call SetSoundParamsFromLabel(gg_snd_LordaeronSummerFliesLoop1, "FliesLoop")
    call SetSoundDuration(gg_snd_LordaeronSummerFliesLoop1, 1962)
    set gg_snd_DivineShield=CreateSound("Abilities\\Spells\\Human\\DivineShield\\DivineShield.wav", false, true, true, 10, 10, "SpellsEAX")
    call SetSoundParamsFromLabel(gg_snd_DivineShield, "DivineShield")
    call SetSoundDuration(gg_snd_DivineShield, 1955)
endfunction

//***************************************************************************
//*
//*  Destructable Objects
//*
//***************************************************************************

function CreateAllDestructables takes nothing returns nothing
    local destructable d
    local trigger t
    local real life
    set gg_dest_LTba_2334=CreateDestructable('LTba', - 5312.0, 832.0, 306.000, 0.906, 1)
    set gg_dest_LTcr_1798=CreateDestructable('LTcr', - 3200.0, 1088.0, 0.000, 0.957, 1)
    set gg_dest_LTcr_2310=CreateDestructable('LTcr', - 5184.0, 640.0, 0.000, 0.977, 0)
    set gg_dest_LTcr_2312=CreateDestructable('LTcr', - 5184.0, 384.0, 0.000, 1.133, 1)
    set gg_dest_LTcr_2313=CreateDestructable('LTcr', - 5824.0, 320.0, 0.000, 1.093, 1)
endfunction

//***************************************************************************
//*
//*  Items
//*
//***************************************************************************

function CreateAllItems takes nothing returns nothing
    local integer itemID

    call CreateItem('I013', - 6678.4, - 4454.2)
    call CreateItem('I015', - 4932.0, 2671.3)
endfunction

//***************************************************************************
//*
//*  Unit Creation
//*
//***************************************************************************

//===========================================================================
function CreateUnitsForPlayer1 takes nothing returns nothing
    local player p= Player(1)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set gg_unit_hfoo_0003=CreateUnit(p, 'hfoo', 4504.8, - 4652.7, 168.984)
    set gg_unit_hfoo_0004=CreateUnit(p, 'hfoo', 4493.2, - 4533.4, 170.886)
    set gg_unit_hcth_0062=CreateUnit(p, 'hcth', 4277.5, - 4551.6, 346.522)
endfunction

//===========================================================================
function CreateUnitsForPlayer2 takes nothing returns nothing
    local player p= Player(2)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set gg_unit_nC09_0001=CreateUnit(p, 'nC09', 2204.1, - 496.7, 139.600)
    set gg_unit_nC01_0002=CreateUnit(p, 'nC01', 2980.3, 1045.9, 57.592)
    set gg_unit_nvil_0010=CreateUnit(p, 'nvil', 1530.7, - 1704.5, 213.634)
    set gg_unit_nvil_0022=CreateUnit(p, 'nvil', 5578.0, - 438.9, 318.119)
    set gg_unit_nvil_0024=CreateUnit(p, 'nvil', 5435.7, - 213.9, 181.401)
    set gg_unit_nvlk_0025=CreateUnit(p, 'nvlk', 3028.8, - 717.4, 147.826)
    set gg_unit_nvlk_0026=CreateUnit(p, 'nvlk', 3071.9, - 940.4, 341.608)
    set u=CreateUnit(p, 'nC11', 6723.4, 799.2, 238.683)
    set gg_unit_nvil_0033=CreateUnit(p, 'nvil', 6057.4, - 186.1, 147.144)
    set gg_unit_nvil_0034=CreateUnit(p, 'nvil', 6206.0, 67.6, 175.270)
    set gg_unit_nC02_0039=CreateUnit(p, 'nC02', 885.1, 177.6, 135.422)
    set gg_unit_nvil_0047=CreateUnit(p, 'nvil', 5968.1, - 1335.4, 27.412)
    set gg_unit_nvil_0048=CreateUnit(p, 'nvil', 5695.5, 348.6, 272.854)
    set gg_unit_nvil_0049=CreateUnit(p, 'nvil', 6025.3, - 452.7, 97.276)
    set gg_unit_nvil_0068=CreateUnit(p, 'nvil', - 1315.5, - 961.6, 39.937)
    set u=CreateUnit(p, 'nC06', 6817.1, 848.7, 181.666)
    set u=CreateUnit(p, 'nC05', 6683.5, 912.8, 286.047)
    set u=CreateUnit(p, 'nC07', 6756.4, 923.0, 229.809)
    set gg_unit_nvil_0085=CreateUnit(p, 'nvil', - 2217.5, - 726.0, 345.553)
    set gg_unit_nC03_0092=CreateUnit(p, 'nC03', 6600.3, 766.9, 227.585)
    set gg_unit_nC00_0093=CreateUnit(p, 'nC00', 3726.3, - 1744.4, 340.751)
    set gg_unit_nvil_0099=CreateUnit(p, 'nvil', - 2497.6, - 825.0, 8.932)
    set gg_unit_nvil_0116=CreateUnit(p, 'nvil', 5663.6, - 1338.7, 222.326)
    set gg_unit_nC04_0118=CreateUnit(p, 'nC04', 2106.1, - 407.3, 335.289)
    set gg_unit_nvil_0119=CreateUnit(p, 'nvil', 502.6, 49.5, 93.124)
    set gg_unit_nvil_0120=CreateUnit(p, 'nvil', 622.4, 123.0, 118.476)
    set gg_unit_nC10_0121=CreateUnit(p, 'nC10', 5558.0, 89.6, 298.119)
    set gg_unit_nvil_0123=CreateUnit(p, 'nvil', 948.9, 449.7, 139.222)
    set gg_unit_nvil_0124=CreateUnit(p, 'nvil', 588.6, - 27.7, 94.699)
    set gg_unit_nvil_0125=CreateUnit(p, 'nvil', 5262.3, - 471.3, 320.690)
    set gg_unit_nC08_0155=CreateUnit(p, 'nC08', 2207.7, - 378.4, 228.000)
endfunction

//===========================================================================
function CreateUnitsForPlayer6 takes nothing returns nothing
    local player p= Player(6)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=CreateUnit(p, 'nska', - 6806.0, - 4532.8, 209.098)
    set u=CreateUnit(p, 'uske', - 6527.3, - 3173.2, 289.938)
    set gg_unit_nska_0027=CreateUnit(p, 'nska', - 1798.8, - 589.4, 209.098)
    set u=CreateUnit(p, 'nska', - 6550.5, - 4430.1, 209.098)
    set u=CreateUnit(p, 'nska', - 5164.6, 3249.6, 209.098)
    set u=CreateUnit(p, 'uske', - 7074.4, - 2914.1, 289.938)
    set u=CreateUnit(p, 'uske', - 5503.6, 2423.2, 280.259)
    set gg_unit_uaco_0038=CreateUnit(p, 'uaco', - 5724.2, 428.1, 236.940)
    set gg_unit_uaco_0040=CreateUnit(p, 'uaco', - 5242.2, 470.3, 311.749)
    set u=CreateUnit(p, 'nska', - 1030.9, 1968.4, 209.098)
    set u=CreateUnit(p, 'nska', - 2051.3, 3033.3, 209.098)
    set u=CreateUnit(p, 'nska', - 988.1, 3339.2, 209.098)
    set u=CreateUnit(p, 'uske', - 6664.6, - 4564.3, 226.182)
    set u=CreateUnit(p, 'uske', - 6790.2, - 4388.4, 38.937)
    set u=CreateUnit(p, 'nska', - 1942.8, 2785.4, 209.098)
    set u=CreateUnit(p, 'nska', - 1043.1, 2955.3, 209.098)
    set u=CreateUnit(p, 'nska', - 1905.1, 2108.1, 209.098)
    set u=CreateUnit(p, 'nska', - 1409.9, 2265.7, 209.098)
    set u=CreateUnit(p, 'nska', - 1067.0, 2361.3, 209.098)
    set gg_unit_uske_0065=CreateUnit(p, 'uske', - 1437.8, - 860.6, 42.661)
    set gg_unit_uske_0066=CreateUnit(p, 'uske', - 1450.3, - 968.3, 159.109)
    set u=CreateUnit(p, 'nska', - 1336.6, 2696.5, 209.098)
    set gg_unit_uske_0069=CreateUnit(p, 'uske', - 2151.3, 150.4, 280.259)
    set u=CreateUnit(p, 'uske', - 4848.6, 4030.4, 280.259)
    set u=CreateUnit(p, 'uske', - 5261.2, 3234.2, 280.259)
    set u=CreateUnit(p, 'uske', - 1174.9, 1082.4, 58.542)
    set u=CreateUnit(p, 'uske', - 4274.3, 3810.0, 280.259)
    set u=CreateUnit(p, 'uske', - 5468.8, 2474.6, 280.259)
    set u=CreateUnit(p, 'nska', - 6375.9, - 2751.2, 209.098)
    set u=CreateUnit(p, 'uske', - 6379.3, - 5181.9, 53.450)
    set gg_unit_uske_0087=CreateUnit(p, 'uske', - 6076.6, - 3859.2, 48.792)
    set u=CreateUnit(p, 'nska', - 3414.5, - 615.9, 209.098)
    set u=CreateUnit(p, 'nska', - 6397.3, - 3219.0, 209.098)
    set u=CreateUnit(p, 'nska', - 3438.0, - 465.3, 209.098)
    set u=CreateUnit(p, 'uske', - 6455.7, - 3411.1, 289.938)
    set gg_unit_uaco_0095=CreateUnit(p, 'uaco', - 5227.0, 841.5, 208.015)
    set gg_unit_uske_0096=CreateUnit(p, 'uske', - 6052.2, - 3726.0, 169.711)
    set u=CreateUnit(p, 'uske', - 3223.9, - 344.1, 141.926)
    set gg_unit_uske_0098=CreateUnit(p, 'uske', - 2621.6, - 876.0, 235.708)
    set gg_unit_uaco_0100=CreateUnit(p, 'uaco', - 5913.6, 408.9, 317.359)
    set u=CreateUnit(p, 'uske', - 6827.3, - 3049.5, 236.982)
    set u=CreateUnit(p, 'nska', - 5352.6, - 2321.9, 209.098)
    set u=CreateUnit(p, 'nska', - 2380.5, - 263.9, 209.098)
    set gg_unit_nska_0105=CreateUnit(p, 'nska', - 2028.0, - 353.0, 209.098)
    set u=CreateUnit(p, 'nska', - 6086.7, - 2820.0, 209.098)
    set gg_unit_uktn_0109=CreateUnit(p, 'uktn', - 5555.3, 545.7, 81.633)
    set gg_unit_uabo_0110=CreateUnit(p, 'uabo', - 5911.1, 1092.5, 259.082)
    set u=CreateUnit(p, 'uske', - 4609.1, 1977.1, 280.259)
    set u=CreateUnit(p, 'nska', - 5178.4, - 2315.7, 209.098)
    set u=CreateUnit(p, 'uske', - 6222.3, - 2727.5, 106.000)
    set t=CreateTrigger()
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_DEATH)
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_CHANGE_OWNER)
    call TriggerAddAction(t, function Unit000092_DropItems)
    set u=CreateUnit(p, 'nska', - 3898.9, - 2361.2, 209.098)
    set u=CreateUnit(p, 'nska', - 4212.8, - 2458.8, 209.098)
    set u=CreateUnit(p, 'nska', - 5849.4, - 1693.9, 301.023)
    set u=CreateUnit(p, 'unec', - 1959.3, - 206.9, 206.242)
    set gg_unit_nska_0137=CreateUnit(p, 'nska', - 2521.4, - 596.5, 209.098)
    set gg_unit_unec_0139=CreateUnit(p, 'unec', - 2510.8, - 1023.4, 95.670)
    set gg_unit_nska_0144=CreateUnit(p, 'nska', - 1306.0, 2119.8, 209.098)
    set gg_unit_nska_0145=CreateUnit(p, 'nska', - 1452.1, 2467.3, 209.098)
    set gg_unit_nska_0146=CreateUnit(p, 'nska', - 1683.7, 2539.6, 209.098)
    set gg_unit_uske_0147=CreateUnit(p, 'uske', - 5577.7, 2724.6, 280.259)
    set gg_unit_uske_0148=CreateUnit(p, 'uske', - 4742.1, 4016.9, 280.259)
    set gg_unit_nska_0149=CreateUnit(p, 'nska', - 4046.4, - 2503.0, 209.098)
    set gg_unit_nska_0150=CreateUnit(p, 'nska', - 6573.2, - 5131.4, 209.098)
    set gg_unit_nska_0151=CreateUnit(p, 'nska', - 6336.3, - 2278.9, 209.098)
    set gg_unit_nska_0152=CreateUnit(p, 'nska', - 6253.6, - 2185.6, 209.098)
    set gg_unit_nska_0153=CreateUnit(p, 'nska', - 5253.3, - 2173.3, 209.098)
endfunction

//===========================================================================
function CreateBuildingsForPlayer9 takes nothing returns nothing
    local player p= Player(9)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=CreateUnit(p, 'hwtw', 896.0, 2944.0, 270.000)
endfunction

//===========================================================================
function CreateUnitsForPlayer9 takes nothing returns nothing
    local player p= Player(9)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set gg_unit_hfoo_0005=CreateUnit(p, 'hfoo', 185.5, 2568.5, 176.644)
    set gg_unit_hfoo_0042=CreateUnit(p, 'hfoo', 135.9, 2802.4, 191.075)
    set gg_unit_hfoo_0043=CreateUnit(p, 'hfoo', 174.3, 2978.6, 193.507)
    set gg_unit_hmpr_0072=CreateUnit(p, 'hmpr', - 2373.8, - 3016.9, 254.329)
    set gg_unit_hmpr_0073=CreateUnit(p, 'hmpr', - 2469.0, - 3150.1, 333.383)
endfunction

//===========================================================================
function CreateNeutralHostileBuildings takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set gg_unit_ngwr_0074=CreateUnit(p, 'ngwr', - 6240.0, 1184.0, 270.000)
    set gg_unit_ngni_0080=CreateUnit(p, 'ngni', - 3168.0, 1248.0, 270.000)
endfunction

//===========================================================================
function CreateNeutralHostile takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_AGGRESSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=CreateUnit(p, 'nogm', 6380.4, - 5096.7, 152.840)
    set t=CreateTrigger()
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_DEATH)
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_CHANGE_OWNER)
    call TriggerAddAction(t, function Unit000126_DropItems)
    set gg_unit_nogr_0008=CreateUnit(p, 'nogr', 6479.7, - 3824.8, 158.248)
    set gg_unit_nogr_0009=CreateUnit(p, 'nogr', 6613.2, - 3491.6, 175.243)
    set gg_unit_nogr_0012=CreateUnit(p, 'nogr', 6173.3, - 4793.2, 42.299)
    set u=CreateUnit(p, 'nmrl', 6000.0, 3854.0, 113.499)
    set gg_unit_nmrl_0014=CreateUnit(p, 'nmrl', 5412.9, 3740.1, 169.498)
    set u=CreateUnit(p, 'nmrl', 5816.1, 3906.2, 5.527)
    set u=CreateUnit(p, 'nmrr', 5354.3, 3895.0, 236.372)
    set u=CreateUnit(p, 'nmrl', 4787.1, 1855.3, 357.417)
    set u=CreateUnit(p, 'nmrl', 4871.8, 1971.8, 322.378)
    set gg_unit_nmrl_0023=CreateUnit(p, 'nmrl', 3898.9, 3491.7, 39.447)
    set gg_unit_nban_0044=CreateUnit(p, 'nban', 6450.3, - 861.4, 15.425)
    set gg_unit_nban_0045=CreateUnit(p, 'nban', 6311.6, - 1016.3, 153.923)
    set gg_unit_nban_0046=CreateUnit(p, 'nban', 6357.3, - 833.9, 127.665)
    set gg_unit_nban_0088=CreateUnit(p, 'nban', 1876.0, 4148.6, 170.992)
    set gg_unit_nenf_0102=CreateUnit(p, 'nenf', 1791.3, 4298.2, 226.887)
    set u=CreateUnit(p, 'nban', 5788.1, - 1700.5, 127.665)
    set gg_unit_nban_0126=CreateUnit(p, 'nban', 5746.0, - 1509.2, 127.665)
    set gg_unit_nrog_0127=CreateUnit(p, 'nrog', 1563.8, 4418.6, 71.707)
    set gg_unit_nban_0140=CreateUnit(p, 'nban', 6197.2, - 941.5, 153.923)
    set gg_unit_nban_0141=CreateUnit(p, 'nban', 6182.5, - 1072.4, 153.923)
    set gg_unit_nmrl_0142=CreateUnit(p, 'nmrl', 5203.9, 3692.3, 47.609)
    set gg_unit_nrog_0143=CreateUnit(p, 'nrog', 1748.8, 3979.6, 71.707)
endfunction

//===========================================================================
function CreateNeutralPassiveBuildings takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=CreateUnit(p, 'nfoh', - 6784.0, 3776.0, 270.000)
    set u=CreateUnit(p, 'nmh1', 5472.0, 4256.0, 270.000)
    set t=CreateTrigger()
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_DEATH)
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_CHANGE_OWNER)
    call TriggerAddAction(t, function Unit000117_DropItems)
    set u=CreateUnit(p, 'nten', 1952.0, 4512.0, 270.000)
    set t=CreateTrigger()
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_DEATH)
    call TriggerRegisterUnitEvent(t, u, EVENT_UNIT_CHANGE_OWNER)
    call TriggerAddAction(t, function Unit000109_DropItems)
endfunction

//===========================================================================
function CreateNeutralPassive takes nothing returns nothing
    local player p= Player(PLAYER_NEUTRAL_PASSIVE)
    local unit u
    local integer unitID
    local trigger t
    local real life

    set u=CreateUnit(p, 'nshe', 5148.2, - 1358.6, 147.243)
    set u=CreateUnit(p, 'nshe', 5228.1, - 1308.3, 281.984)
    set u=CreateUnit(p, 'nshe', 5175.3, - 1306.5, 153.484)
    set gg_unit_nshe_0081=CreateUnit(p, 'nshe', 6004.6, - 4933.4, 185.960)
    set t=CreateTrigger()
    call TriggerRegisterUnitEvent(t, gg_unit_nshe_0081, EVENT_UNIT_DEATH)
    call TriggerRegisterUnitEvent(t, gg_unit_nshe_0081, EVENT_UNIT_CHANGE_OWNER)
    call TriggerAddAction(t, function Unit000076_DropItems)
    set u=CreateUnit(p, 'nshe', 5300.1, - 1309.9, 187.916)
    set u=CreateUnit(p, 'nshe', 5261.9, - 1394.9, 70.974)
    set u=CreateUnit(p, 'nshe', 5262.9, - 1240.2, 95.221)
    set u=CreateUnit(p, 'nshe', 5229.4, - 1388.8, 54.230)
    set u=CreateUnit(p, 'nshe', 5293.8, - 1428.4, 141.706)
    set u=CreateUnit(p, 'nshe', 1431.2, 4205.1, 59.669)
    set u=CreateUnit(p, 'nshe', 1467.5, 4148.3, 28.137)
endfunction

//===========================================================================
function CreatePlayerBuildings takes nothing returns nothing
    call CreateBuildingsForPlayer9()
endfunction

//===========================================================================
function CreatePlayerUnits takes nothing returns nothing
    call CreateUnitsForPlayer1()
    call CreateUnitsForPlayer2()
    call CreateUnitsForPlayer6()
    call CreateUnitsForPlayer9()
endfunction

//===========================================================================
function CreateAllUnits takes nothing returns nothing
    call CreateNeutralHostileBuildings()
    call CreateNeutralPassiveBuildings()
    call CreatePlayerBuildings()
    call CreateNeutralHostile()
    call CreateNeutralPassive()
    call CreatePlayerUnits()
endfunction

//***************************************************************************
//*
//*  Regions
//*
//***************************************************************************

function CreateRegions takes nothing returns nothing
    local weathereffect we

    set gg_rct_AbominationAttack=Rect(- 5824.0, 480.0, - 5664.0, 640.0)
    set gg_rct_AbominationAttack_2=Rect(- 5472.0, - 384.0, - 5312.0, - 224.0)
    set gg_rct_AirshipStart=Rect(- 7392.0, 1088.0, - 7136.0, 1440.0)
    set gg_rct_AmbushSkeletons=Rect(- 5824.0, 1920.0, - 3616.0, 4128.0)
    set gg_rct_AmbushStart=Rect(- 5920.0, 1888.0, - 4352.0, 4672.0)
    set gg_rct_ArcherPanCamera=Rect(- 288.0, 2688.0, - 32.0, 2912.0)
    set gg_rct_ArcherVisibility=Rect(- 480.0, 2624.0, - 224.0, 2848.0)
    set gg_rct_ArthasGranaryPost=Rect(- 3360.0, 1408.0, - 3232.0, 1536.0)
    set gg_rct_ArthasGranaryTeleport=Rect(- 3520.0, 1824.0, - 3392.0, 1952.0)
    set gg_rct_ArthasMove01=Rect(4032.0, - 4032.0, 4096.0, - 3968.0)
    set gg_rct_ArthasMove02=Rect(3360.0, - 3232.0, 3424.0, - 3168.0)
    set gg_rct_ArthasPost=Rect(4608.0, - 3680.0, 4704.0, - 3584.0)
    set gg_rct_ArthasStart=Rect(3872.0, - 4384.0, 3968.0, - 4288.0)
    set gg_rct_Bandit=Rect(4256.0, - 1472.0, 6528.0, 1248.0)
    set gg_rct_BANDIT_SIGHT=Rect(4480.0, 64.0, 4576.0, 160.0)
    set gg_rct_BANDIT_SIGHT_2=Rect(4896.0, - 320.0, 4992.0, - 224.0)
    set gg_rct_BANDIT_SIGHT_3=Rect(5312.0, - 704.0, 5408.0, - 608.0)
    set gg_rct_BANDIT_SIGHT_4=Rect(5664.0, - 1056.0, 5760.0, - 960.0)
    set gg_rct_BanditRoamCamp=Rect(1504.0, 3968.0, 1984.0, 4480.0)
    set gg_rct_BanditsVillageArea01=Rect(5920.0, - 1152.0, 6656.0, - 640.0)
    set gg_rct_BanditsVillageArea02=Rect(5472.0, - 1952.0, 6080.0, - 1440.0)
    set gg_rct_BridgeOut=Rect(288.0, - 416.0, 1408.0, 608.0)
    set gg_rct_BridgeOutVillagerDestination=Rect(864.0, 0.0, 1056.0, 224.0)
    set gg_rct_Captain1a=Rect(4224.0, - 4096.0, 4288.0, - 4032.0)
    set gg_rct_Captain1b=Rect(3616.0, - 3264.0, 3648.0, - 3232.0)
    set gg_rct_CaptainMoveStart=Rect(4096.0, - 4544.0, 4160.0, - 4480.0)
    set gg_rct_CaptainPost=Rect(4736.0, - 3808.0, 4832.0, - 3712.0)
    set gg_rct_CrateSkeleton01=Rect(- 3264.0, 1056.0, - 3136.0, 1184.0)
    set gg_rct_DefendZone=Rect(- 384.0, 1824.0, 1760.0, 3136.0)
    set gg_rct_EndCin_Arthas=Rect(- 5696.0, - 832.0, - 5472.0, - 608.0)
    set gg_rct_EndCin_Jaina=Rect(- 5472.0, - 832.0, - 5248.0, - 608.0)
    set gg_rct_EndCin_MoveOrderUnits=Rect(- 5664.0, - 1120.0, - 5184.0, - 928.0)
    set gg_rct_EndCin_MoveUnits=Rect(- 5664.0, - 1440.0, - 5184.0, - 1280.0)
    set gg_rct_EndCrate01=Rect(- 5888.0, 256.0, - 5760.0, 384.0)
    set gg_rct_EndCrate02=Rect(- 5248.0, 320.0, - 5120.0, 448.0)
    set gg_rct_EndCrate03=Rect(- 5248.0, 608.0, - 5120.0, 704.0)
    set gg_rct_EndCrate04=Rect(- 5408.0, 768.0, - 5280.0, 896.0)
    set gg_rct_EndingSafetyGroupArea=Rect(- 6144.0, 128.0, - 4928.0, 1120.0)
    set gg_rct_Exit=Rect(- 7392.0, 1152.0, - 7040.0, 1568.0)
    set gg_rct_FacingPoint=Rect(3104.0, - 2944.0, 3200.0, - 2848.0)
    set gg_rct_FinalCin_Abomination=Rect(- 6112.0, 896.0, - 6016.0, 992.0)
    set gg_rct_FinalCin_Arthas=Rect(- 6368.0, 832.0, - 6272.0, 928.0)
    set gg_rct_FinalCin_Jaina=Rect(- 6496.0, 1056.0, - 6400.0, 1152.0)
    set gg_rct_Footman01=Rect(4480.0, - 4224.0, 4544.0, - 4160.0)
    set gg_rct_Footman02=Rect(4544.0, - 4352.0, 4608.0, - 4288.0)
    set gg_rct_Footman03=Rect(4224.0, - 4224.0, 4288.0, - 4160.0)
    set gg_rct_Footman04=Rect(4352.0, - 4352.0, 4416.0, - 4288.0)
    set gg_rct_Footman1b=Rect(3744.0, - 3360.0, 3776.0, - 3328.0)
    set gg_rct_Footman2b=Rect(3872.0, - 3488.0, 3904.0, - 3456.0)
    set gg_rct_Footman3b=Rect(3616.0, - 3424.0, 3648.0, - 3392.0)
    set gg_rct_Footman4b=Rect(3712.0, - 3520.0, 3776.0, - 3456.0)
    set gg_rct_FootmenDefendingArea=Rect(- 288.0, 2272.0, 416.0, 3264.0)
    set gg_rct_FountainOfLifeReveal=Rect(- 7008.0, 3616.0, - 6656.0, 4000.0)
    set gg_rct_FountainOfLifeZone=Rect(- 7296.0, 3392.0, - 6336.0, 4288.0)
    set gg_rct_FountainSkeleton01=Rect(- 6880.0, 3968.0, - 6720.0, 4128.0)
    set gg_rct_FountainSkeleton02=Rect(- 7136.0, 3616.0, - 6976.0, 3776.0)
    set gg_rct_Ghoul01=Rect(- 5248.0, 1152.0, - 5152.0, 1280.0)
    set gg_rct_Ghoul02=Rect(- 5440.0, 1248.0, - 5312.0, 1408.0)
    set gg_rct_GrainArea=Rect(- 4128.0, 864.0, - 2816.0, 1568.0)
    set gg_rct_Granary_Warehouse_Ping=Rect(- 6464.0, 992.0, - 5984.0, 1344.0)
    set gg_rct_Granary02Area=Rect(- 6560.0, - 1632.0, - 5120.0, - 320.0)
    set gg_rct_Granary03Area=Rect(- 7232.0, - 1152.0, - 4544.0, 1632.0)
    set gg_rct_HolyLightHintArea=Rect(- 3520.0, 1984.0, - 2688.0, 3872.0)
    set gg_rct_JainaGranaryPost=Rect(- 3488.0, 1184.0, - 3360.0, 1312.0)
    set gg_rct_JainaGranaryTeleport=Rect(- 3712.0, 1760.0, - 3584.0, 1888.0)
    set gg_rct_JainaMove01=Rect(4256.0, - 3904.0, 4320.0, - 3840.0)
    set gg_rct_JainaMove02=Rect(3488.0, - 3168.0, 3584.0, - 3072.0)
    set gg_rct_JainaPost=Rect(4768.0, - 3456.0, 4864.0, - 3360.0)
    set gg_rct_KelThuzadAppear=Rect(- 5920.0, 544.0, - 5472.0, 896.0)
    set gg_rct_KelThuzadPost=Rect(- 5856.0, 576.0, - 5664.0, 768.0)
    set gg_rct_KelThuzadRevealer=Rect(- 5888.0, 416.0, - 5536.0, 800.0)
    set gg_rct_KidsLaughing=Rect(2432.0, - 1376.0, 3648.0, - 416.0)
    set gg_rct_KidsRunningArea=Rect(2560.0, - 1248.0, 3424.0, - 448.0)
    set gg_rct_LakeLoop01=Rect(1536.0, 2208.0, 2720.0, 3232.0)
    set gg_rct_LakeLoop02=Rect(992.0, 3168.0, 2048.0, 5056.0)
    set gg_rct_LakeLoop03=Rect(1952.0, 2912.0, 2976.0, 5088.0)
    set gg_rct_LakeLoop04=Rect(2976.0, 2880.0, 3584.0, 4448.0)
    set gg_rct_LakeLoop05=Rect(3584.0, 3008.0, 5152.0, 4512.0)
    set gg_rct_LakeLoop06=Rect(4608.0, 1664.0, 6336.0, 3168.0)
    set gg_rct_LakeLoop07=Rect(5920.0, 3552.0, 6528.0, 4672.0)
    set gg_rct_LakeLoop08=Rect(5088.0, 4064.0, 5952.0, 4672.0)
    set gg_rct_LakeLoop09=Rect(- 7776.0, - 5248.0, - 5760.0, - 3456.0)
    set gg_rct_MortarTeam_Visibility=Rect(- 6048.0, - 3840.0, - 5952.0, - 3712.0)
    set gg_rct_MortarTeamArea=Rect(- 5696.0, - 4896.0, - 4800.0, - 3136.0)
    set gg_rct_MortarTeamCreate01=Rect(- 5440.0, - 4192.0, - 5312.0, - 4032.0)
    set gg_rct_MortarTeamVisibility=Rect(- 5600.0, - 4352.0, - 5408.0, - 4192.0)
    set gg_rct_MurlocArea=Rect(4192.0, 3200.0, 5888.0, 4096.0)
    set gg_rct_MurlocObserverDestination=Rect(4000.0, 3552.0, 4544.0, 4096.0)
    set gg_rct_MurlocPatrolPoint01=Rect(5344.0, 3680.0, 5472.0, 3776.0)
    set gg_rct_MurlocPatrolPoint02=Rect(5760.0, 3776.0, 5856.0, 3872.0)
    set gg_rct_Ogre_Attack_Move=Rect(5440.0, - 3584.0, 5568.0, - 3328.0)
    set gg_rct_OgreFace=Rect(6912.0, - 3712.0, 6944.0, - 3648.0)
    set gg_rct_OgreHide=Rect(7008.0, - 4160.0, 7200.0, - 3936.0)
    set gg_rct_Patrol01End=Rect(- 1696.0, - 1376.0, - 1120.0, - 864.0)
    set gg_rct_Patrol01Start=Rect(- 3616.0, - 736.0, - 3040.0, - 192.0)
    set gg_rct_PatrolHello01area=Rect(1408.0, - 2144.0, 1888.0, - 1760.0)
    set gg_rct_PatrollSmallArea=Rect(5376.0, - 480.0, 5952.0, 576.0)
    set gg_rct_PeasantPatrolArea=Rect(384.0, - 1600.0, 6304.0, 672.0)
    set gg_rct_Priest_ArthasJaina_Here=Rect(- 3104.0, - 4032.0, - 1408.0, - 2368.0)
    set gg_rct_Priest01GranaryPost=Rect(- 2208.0, - 2976.0, - 2080.0, - 2848.0)
    set gg_rct_Priest02GranaryPost=Rect(- 2144.0, - 3136.0, - 2016.0, - 3008.0)
    set gg_rct_Priests=Rect(- 2336.0, - 3392.0, - 1568.0, - 2848.0)
    set gg_rct_PriestsStartArea=Rect(- 2816.0, - 3808.0, - 1760.0, - 2304.0)
    set gg_rct_ResetCam=Rect(3328.0, - 3296.0, 3456.0, - 3104.0)
    set gg_rct_ResetCamGrain=Rect(- 3232.0, 1056.0, - 3072.0, 1184.0)
    set gg_rct_RiverRouteVisibility=Rect(5088.0, 1024.0, 5536.0, 1536.0)
    set gg_rct_SheepArea=Rect(5920.0, - 5024.0, 6080.0, - 4864.0)
    set gg_rct_SheepBanditArea=Rect(1312.0, 4032.0, 1568.0, 4384.0)
    set gg_rct_SkeletonArchers=Rect(- 2176.0, 1440.0, - 768.0, 3488.0)
    set gg_rct_SkeletonBeforeMortars=Rect(- 4480.0, - 2784.0, - 3776.0, - 2080.0)
    set gg_rct_SkeletonFinalGroup=Rect(- 6560.0, - 2912.0, - 5248.0, - 1632.0)
    set gg_rct_SkeletonShip=Rect(- 7104.0, - 5184.0, - 6240.0, - 3968.0)
    set gg_rct_SkeletonsMortarFodderEnd=Rect(- 6176.0, - 4000.0, - 5888.0, - 3648.0)
    set gg_rct_SkeletonsMortarFodderStart=Rect(- 6656.0, - 3584.0, - 6208.0, - 3040.0)
    set gg_rct_SkeletonSound=Rect(- 5536.0, 192.0, - 5376.0, 320.0)
    set gg_rct_StartArthas=Rect(4224.0, - 3968.0, 4320.0, - 3872.0)
    set gg_rct_StartCaptain=Rect(4352.0, - 4192.0, 4448.0, - 4096.0)
    set gg_rct_StartJaina=Rect(4992.0, - 3328.0, 5120.0, - 3200.0)
    set gg_rct_StreamLoop01=Rect(- 320.0, 96.0, 704.0, 928.0)
    set gg_rct_TaxVillagerFace=Rect(3008.0, 1152.0, 3200.0, 1344.0)
    set gg_rct_TreesArea=Rect(- 6592.0, 3200.0, - 5664.0, 3904.0)
    set gg_rct_VillagerActivateFountainQuest=Rect(6144.0, 384.0, 6848.0, 1280.0)
    set gg_rct_VillageRaiseSkeletonStart=Rect(- 3776.0, - 1440.0, - 1504.0, 640.0)
    set gg_rct_VillagerConcernedArea=Rect(2112.0, - 2464.0, 4032.0, - 1024.0)
    set gg_rct_VillagerConcernedDestination=Rect(3584.0, - 1952.0, 3712.0, - 1728.0)
    set gg_rct_VillagerHello01=Rect(1248.0, - 2368.0, 2048.0, - 1472.0)
    set gg_rct_VillagerHello02=Rect(1792.0, - 960.0, 2432.0, - 128.0)
    set gg_rct_VillagerKidsRunDest=Rect(2496.0, - 768.0, 2656.0, - 640.0)
    set gg_rct_VillagerKidsRunning01=Rect(3136.0, - 640.0, 3264.0, - 512.0)
    set gg_rct_VillagerKidsRunning02=Rect(2752.0, - 896.0, 2880.0, - 768.0)
    set gg_rct_VillagerKidsRunning03=Rect(3200.0, - 1056.0, 3328.0, - 928.0)
    set gg_rct_VillagerRunDest09=Rect(- 2720.0, 64.0, - 2400.0, 384.0)
    set gg_rct_VillagerTaxes=Rect(2720.0, 768.0, 3232.0, 1312.0)
    set gg_rct_VillageRunDest01=Rect(4096.0, 0.0, 4288.0, 256.0)
    set gg_rct_VillageRunDest02=Rect(4160.0, 608.0, 4384.0, 800.0)
    set gg_rct_VillageRunDest03=Rect(3712.0, 672.0, 3968.0, 864.0)
    set gg_rct_VillageRunDest04=Rect(4384.0, 960.0, 4640.0, 1152.0)
    set gg_rct_VillageRunDest05=Rect(5184.0, 192.0, 5408.0, 384.0)
    set gg_rct_VillageRunDest06=Rect(6688.0, 288.0, 6880.0, 480.0)
    set gg_rct_VillageRunDest07=Rect(5344.0, 320.0, 5536.0, 512.0)
    set gg_rct_VillageRunDest08=Rect(4768.0, 512.0, 4928.0, 672.0)
    set gg_rct_WaterElementalPost=Rect(4992.0, - 3552.0, 5056.0, - 3488.0)
    set gg_rct_MortarTeam_ArthasNear=Rect(- 6016.0, - 4992.0, - 4128.0, - 2656.0)
    set gg_rct_FlySound=Rect(- 3264.0, 1184.0, - 3072.0, 1344.0)
    set gg_rct_OgrePatroler=Rect(6304.0, - 4192.0, 6496.0, - 3968.0)
endfunction

//***************************************************************************
//*
//*  Cameras
//*
//***************************************************************************

function CreateCameras takes nothing returns nothing

    set gg_cam_Camera_001=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_ROTATION, 151.3, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_ANGLE_OF_ATTACK, 323.6, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_TARGET_DISTANCE, 1134.1, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_FIELD_OF_VIEW, 90.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_001, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_001, 3988.8, - 4323.7, 0.0)

    set gg_cam_Camera_002=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_ROTATION, 158.8, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_ANGLE_OF_ATTACK, 330.6, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_TARGET_DISTANCE, 1134.1, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_FIELD_OF_VIEW, 90.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_002, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_002, 3988.8, - 4323.8, 0.0)

    set gg_cam_Camera_003=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_ROTATION, 44.7, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_ANGLE_OF_ATTACK, 338.3, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_TARGET_DISTANCE, 1083.5, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_003, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_003, 4381.3, - 4140.5, 0.0)

    set gg_cam_Camera_004=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_ROTATION, 44.7, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_ANGLE_OF_ATTACK, 344.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_TARGET_DISTANCE, 1005.7, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_004, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_004, 4742.6, - 3662.1, 0.0)

    set gg_cam_Camera_005=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_ROTATION, 78.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_ANGLE_OF_ATTACK, 337.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_TARGET_DISTANCE, 869.7, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_005, CAMERA_FIELD_FARZ, 3000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_005, 4778.7, - 3501.5, 0.0)

    set gg_cam_Camera_006=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_ROTATION, 106.3, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_ANGLE_OF_ATTACK, 328.2, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_TARGET_DISTANCE, 869.7, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_006, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_006, 4767.4, - 3509.4, 0.0)

    set gg_cam_Camera_007=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_ROTATION, 70.6, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_ANGLE_OF_ATTACK, 329.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_TARGET_DISTANCE, 1413.1, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Camera_007, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Camera_007, 4448.4, - 3922.4, 0.0)

    set gg_cam_Arthas=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_ROTATION, 212.6, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_ANGLE_OF_ATTACK, 331.7, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_TARGET_DISTANCE, 738.4, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Arthas, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Arthas, 4581.0, - 3706.8, 0.0)

    set gg_cam_Jaina=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_ROTATION, 75.5, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_ANGLE_OF_ATTACK, 339.4, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_TARGET_DISTANCE, 597.1, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Jaina, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Jaina, 4919.3, - 3330.7, 0.0)

    set gg_cam_Formation=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_ROTATION, 43.7, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_ANGLE_OF_ATTACK, 331.1, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_TARGET_DISTANCE, 994.5, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Formation, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Formation, 4321.2, - 3803.8, 0.0)

    set gg_cam_GroupShot=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_ROTATION, 120.5, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_ANGLE_OF_ATTACK, 323.5, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_TARGET_DISTANCE, 924.3, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_GroupShot, CAMERA_FIELD_FARZ, 4000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_GroupShot, 4837.3, - 3555.2, 0.0)

    set gg_cam_OgreBattle01=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_ROTATION, 12.1, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_ANGLE_OF_ATTACK, 333.4, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_TARGET_DISTANCE, 1083.6, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle01, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_OgreBattle01, 5276.5, - 3372.7, 0.0)

    set gg_cam_OgreBattle02=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_ROTATION, 31.8, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_ANGLE_OF_ATTACK, 331.4, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_TARGET_DISTANCE, 1083.6, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_OgreBattle02, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_OgreBattle02, 5276.5, - 3372.7, 0.0)

    set gg_cam_EscapeCam=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_ROTATION, 90.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_ANGLE_OF_ATTACK, 304.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_TARGET_DISTANCE, 1650.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_EscapeCam, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_EscapeCam, 3420.9, - 3204.8, 0.0)

    set gg_cam_Granary01=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_ROTATION, 90.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_ANGLE_OF_ATTACK, 322.1, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_TARGET_DISTANCE, 846.7, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary01, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Granary01, - 3192.5, 1362.4, 0.0)

    set gg_cam_Granary02=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_ROTATION, 81.6, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_ANGLE_OF_ATTACK, 321.4, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_TARGET_DISTANCE, 846.7, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary02, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Granary02, - 3238.7, 1457.8, 0.0)

    set gg_cam_GranaryPriests=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_ROTATION, 274.3, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_ANGLE_OF_ATTACK, 329.5, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_TARGET_DISTANCE, 876.8, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_GranaryPriests, CAMERA_FIELD_FARZ, 6855.6, 0.0)
    call CameraSetupSetDestPosition(gg_cam_GranaryPriests, - 1982.7, - 2945.9, 0.0)

    set gg_cam_Abomination=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_ROTATION, 112.0, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_ANGLE_OF_ATTACK, 336.2, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_TARGET_DISTANCE, 1413.7, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Abomination, CAMERA_FIELD_FARZ, 5000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Abomination, - 5832.5, 1085.6, 0.0)

    set gg_cam_Preload=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_ZOFFSET, 96.8, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_ROTATION, 147.2, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_ANGLE_OF_ATTACK, 342.7, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_TARGET_DISTANCE, 1041.9, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_FIELD_OF_VIEW, 65.0, 0.0)
    call CameraSetupSetField(gg_cam_Preload, CAMERA_FIELD_FARZ, 10000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Preload, 4048.7, - 4404.7, 0.0)

    set gg_cam_Granary04=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_ROTATION, 92.5, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_ANGLE_OF_ATTACK, 327.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_TARGET_DISTANCE, 1061.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Granary04, CAMERA_FIELD_FARZ, 6855.6, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Granary04, - 2231.3, - 2853.4, 0.0)

    set gg_cam_Ending01=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_ROTATION, 95.6, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_ANGLE_OF_ATTACK, 334.7, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_TARGET_DISTANCE, 1390.4, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending01, CAMERA_FIELD_FARZ, 5860.3, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Ending01, - 5536.7, 744.6, 0.0)

    set gg_cam_Ending02=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_ROTATION, 103.8, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_ANGLE_OF_ATTACK, 332.4, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_TARGET_DISTANCE, 1000.7, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending02, CAMERA_FIELD_FARZ, 5860.3, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Ending02, - 5837.2, 1127.9, 0.0)

    set gg_cam_Ending03=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_ROTATION, 108.2, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_ANGLE_OF_ATTACK, 329.8, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_TARGET_DISTANCE, 962.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_Ending03, CAMERA_FIELD_FARZ, 5860.3, 0.0)
    call CameraSetupSetDestPosition(gg_cam_Ending03, - 5648.5, 499.5, 0.0)

    set gg_cam_FinalCin1=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_ROTATION, 129.8, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_ANGLE_OF_ATTACK, 341.5, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_TARGET_DISTANCE, 1175.7, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin1, CAMERA_FIELD_FARZ, 10000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_FinalCin1, - 6395.3, 1301.3, 0.0)

    set gg_cam_FinalCin2=CreateCameraSetup()
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_ZOFFSET, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_ROTATION, 151.4, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_ANGLE_OF_ATTACK, 334.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_TARGET_DISTANCE, 1175.7, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_ROLL, 0.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_FIELD_OF_VIEW, 70.0, 0.0)
    call CameraSetupSetField(gg_cam_FinalCin2, CAMERA_FIELD_FARZ, 10000.0, 0.0)
    call CameraSetupSetDestPosition(gg_cam_FinalCin2, - 6395.3, 1301.3, 0.0)

endfunction

//***************************************************************************
//*
//*  Triggers
//*
//***************************************************************************

//===========================================================================
// Trigger: fileio
//===========================================================================
// This file defines file IO functions for the JASS side of things
// Based off the FileIO module created by Nestharus, see:
// https://www.hiveworkshop.com/threads/codeless-save-load-its-now-a-reality-demo-map-included.226082/


function InitTrig_fileio takes nothing returns nothing
    local integer i= 0

    loop
        exitwhen i >= NUM_FILE_LINES
        set p_original_names[i]=GetPlayerName(Player(i))
        set i=i + 1
    endloop
endfunction

function io_read_file_simple takes string file_name returns nothing
    call Preloader(file_name)
endfunction

function io_read_file takes string file_name returns nothing
    local integer i= 0

    call Preloader(file_name)
    loop
        exitwhen i >= NUM_FILE_LINES
        set io_lines[i]=GetPlayerName(Player(i))
        call SetPlayerName(Player(i), p_original_names[i])
        set i=i + 1
    endloop
endfunction

function io_open_write takes string filename returns nothing
    call PreloadGenClear()
    call PreloadGenStart()
    set last_filename=filename
endfunction

function io_write takes string contents returns nothing
    call Preload(contents)
endfunction

function io_close_write takes nothing returns nothing
    call PreloadGenEnd(last_filename)
    set last_filename=""
endfunction
//===========================================================================
// Trigger: map_config
//===========================================================================
// Map-specific setup used by other scripts

function hero_get_unit_from_index takes integer slot returns unit
    if slot == 0 then
        return udg_Arthas
    elseif slot == 1 then
        return udg_Jaina
    elseif slot == 2 then
        return udg_Arthas
    elseif slot == 3 then
        return udg_Arthas
    endif
    return null
endfunction

function hero_get_index_from_unit takes unit hero returns integer
    local integer i= 0
    loop
        exitwhen hero_get_unit_from_index(i) == hero
        set i=i + 1
        exitwhen i >= NUM_HEROES
    endloop
    return i
endfunction

function hero_update_variable takes integer slot,unit hero returns nothing
    if slot == 0 then
        set udg_Arthas=hero
    elseif slot == 1 then
        set udg_Jaina=hero
    elseif slot == 2 then
        set udg_Arthas=hero
    else
        set udg_Arthas=hero
    endif
endfunction

function InitTrig_map_config takes nothing returns nothing
    set hero_global_slots[0]=HERO_ID_PALADIN_ARTHAS
    set hero_global_slots[1]=HERO_ID_JAINA
    set hero_global_slots[2]=HERO_ID_NONE
    set hero_global_slots[3]=HERO_ID_NONE
endfunction
//===========================================================================
// Trigger: status
//===========================================================================
// defines the packets that communicate with the client
// depends: map_config, fileio

function status_send takes nothing returns nothing
    local integer i= 0
    call io_open_write("status.txt")
    call io_write(I2S(update_index))
    call io_write(COMM_VERSION)
    call io_write(I2S(world_id))
    call io_write(I2S(MISSION_ID))
    call io_write(I2S(last_unlock_packet) + "," + I2S(last_location_packet) + "," + I2S(last_message_packet) + "," + I2S(last_hero_packet) + "," + I2S(last_item_packet) + "," + I2S(last_item_channel_packet) + ",-1")
    call io_write(I2S(hero_status_index))
    call io_write(I2S(num_channel_1_items_received) + "," + I2S(num_channel_2_items_received))
    call io_write("_")
    call io_write("_")
    set update_index=update_index + 1
    if update_index >= MAX_UPDATE_ID then
        set update_index=0
    endif
    loop
        exitwhen i >= MAX_LOCATIONS
        if locations_checked[i] then
            call io_write(I2S(i))
        endif
        set i=i + 1
    endloop
    call io_close_write()
endfunction

function B2I takes boolean b returns integer
    if b then
        return 1
    endif
    return 0
endfunction

function captains_set_ability_usable takes player p returns nothing
    local integer available= GetPlayerTechMaxAllowed(p, 'hcth') - GetPlayerTechCount(p, 'AP00', true)
    if available < 0 then
        set available=0
    endif
    call SetPlayerTechResearched(p, 'RP00', available)
    // General irregular unlocks
    call SetPlayerTechResearched(p, 'RP01', B2I(GetPlayerTechMaxAllowed(p, 'hfoo') != 0))
    call SetPlayerTechResearched(p, 'RP02', B2I(GetPlayerTechMaxAllowed(p, 'hrif') != 0))
    call SetPlayerTechResearched(p, 'RP03', B2I(GetPlayerTechMaxAllowed(p, 'nhea') != 0))
    call SetPlayerTechResearched(p, 'RP04', B2I(GetPlayerTechMaxAllowed(p, 'hkni') != 0))
    call SetPlayerTechResearched(p, 'RP05', B2I(GetPlayerTechMaxAllowed(p, 'hmpr') != 0))
    call SetPlayerTechResearched(p, 'RP06', B2I(GetPlayerTechMaxAllowed(p, 'hsor') != 0))
    call SetPlayerTechResearched(p, 'RP07', B2I(GetPlayerTechMaxAllowed(p, 'hspt') != 0))
    call SetPlayerTechResearched(p, 'RP08', B2I(GetPlayerTechMaxAllowed(p, 'hmtm') != 0))
endfunction

function status_load_unlocks_for_player takes integer target_player returns nothing
    local player p= Player(0)
    call SetPlayerTechMaxAllowed(p, 'nech', - 1)
    call SetPlayerTechMaxAllowed(p, 'nvil', target_player)
    call io_read_file_simple("unlocks.txt")
    set last_unlock_packet=GetPlayerTechMaxAllowed(p, 'nech')
    // captains
    call captains_set_ability_usable(Player(target_player))
endfunction

function status_captain_promoted_actions takes nothing returns nothing
    local player p= GetOwningPlayer(GetTriggerUnit())
    local effect special_effect
    if GetSpellAbilityId() != 'AP00' then
        return
    endif
    call AddPlayerTechResearched(p, 'AP00', 1)
    call captains_set_ability_usable(p)
endfunction

function captains_init takes nothing returns nothing
    call SetPlayerTechMaxAllowed(USER_PLAYER, 'hcth', 0)
    set t_captain_promoted=CreateTrigger()
    call TriggerRegisterAnyUnitEventBJ(t_captain_promoted, EVENT_PLAYER_UNIT_SPELL_CAST)
    call TriggerAddAction(t_captain_promoted, function status_captain_promoted_actions)
endfunction

function status_load_unlocks takes nothing returns nothing
    call status_load_unlocks_for_player(GetPlayerId(USER_PLAYER))
endfunction

function status_load_locations takes nothing returns nothing
    local player p= Player(0)
    local integer i= 0
    local integer loc_id= 0
    call SetPlayerTechMaxAllowed(p, 'nech', - 1)
    call io_read_file("locations.txt")
    loop
        exitwhen i + 2 > StringLength(io_lines[0])
        set loc_id=S2I(SubString(io_lines[0], i, i + 2))
        if loc_id < MAX_LOCATIONS then
            set locations_checked[loc_id]=true
        endif
        set i=i + 2
    endloop
    set i=0
    loop
        exitwhen i + 2 > StringLength(io_lines[1])
        set loc_id=S2I(SubString(io_lines[1], i, i + 2))
        if loc_id < MAX_LOCATIONS then
            set locations_checked[loc_id]=false
        endif
        set i=i + 2
    endloop
    set last_location_packet=GetPlayerTechMaxAllowed(p, 'nech')
endfunction

function status_check_location takes integer location_id returns nothing
    if location_id >= MAX_LOCATIONS then
        call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, "|cffff2222Error: Attempted to check invalid location ID: " + I2S(location_id) + "|r")
        return
    endif
    set locations_checked[location_id]=true
    call status_send()
endfunction

function status_load_messages takes nothing returns nothing
    local integer i= 0
    local player p= Player(0)
    local integer num_messages
    call SetPlayerTechMaxAllowed(p, 'nech', - 1)
    call SetPlayerTechMaxAllowed(p, 'nalb', 0)
    call io_read_file("messages.txt")
    set num_messages=GetPlayerTechMaxAllowed(p, 'nalb')
    if num_messages > NUM_FILE_LINES then
        set num_messages=NUM_FILE_LINES
    endif
    loop
        exitwhen i >= num_messages
        call DisplayTextToForce(GetPlayersAll(), io_lines[i])
        set i=i + 1
    endloop
    set last_message_packet=GetPlayerTechMaxAllowed(p, 'nech')
endfunction

function status_load_items takes nothing returns nothing
    local integer num_items= - 1
    local integer i= 0
    local integer item_id= 0
    local player p= Player(0)
    local unit target_unit= null
    call SetPlayerTechMaxAllowed(p, 'nech', - 1)
    call SetPlayerTechMaxAllowed(p, 'nalb', 0)
    call SetPlayerTechMaxAllowed(p, 'ndog', 0)
    call SetPlayerTechMaxAllowed(Player(0), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(4), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(5), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(6), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(7), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(8), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(9), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(10), 'ncrb', 0)
    call SetPlayerTechMaxAllowed(Player(11), 'ncrb', 0)

    call io_read_file_simple("items.txt")
    set last_item_packet=GetPlayerTechMaxAllowed(p, 'nech')
    set num_items=GetPlayerTechMaxAllowed(p, 'nalb')
    if num_items < 0 then
        set num_items=0
    elseif num_items > MAX_ITEMS_PER_PACKET then
        set num_items=MAX_ITEMS_PER_PACKET
    endif

    if GetPlayerTechMaxAllowed(p, 'ndog') == 0 then
        set target_unit=item_channel_1_target
        set num_channel_1_items_received=num_channel_1_items_received + num_items
    else
        set target_unit=item_channel_2_target
        set num_channel_2_items_received=num_channel_2_items_received + num_items
    endif

    loop
        exitwhen i >= num_items
        set item_id=GetPlayerTechMaxAllowed(Player(i), 'ncrb')
        if item_id != 0 then
            call UnitAddItemById(target_unit, item_id)
        endif
        set i=i + 1
    endloop
endfunction

function status_init_item_channels takes integer local_channel_id returns nothing
    if local_channel_id == 1 then
        call SetPlayerTechMaxAllowed(Player(0), 'nalb', item_channel_1)
    else
        call SetPlayerTechMaxAllowed(Player(0), 'nalb', item_channel_2)
    endif
    call SetPlayerTechMaxAllowed(Player(0), 'nech', - 1)
    call SetPlayerTechMaxAllowed(Player(0), 'nske', 0)
    call SetPlayerTechMaxAllowed(Player(0), 'npng', - 1)
    call io_read_file_simple("item_channels.txt")
    set last_item_channel_packet=GetPlayerTechMaxAllowed(Player(0), 'nech')
    if GetPlayerTechMaxAllowed(Player(0), 'nech') == 0 then
        return
    endif
    if local_channel_id == 1 then
        set num_channel_1_items_received=GetPlayerTechMaxAllowed(Player(0), 'npng')
    else
        set num_channel_2_items_received=GetPlayerTechMaxAllowed(Player(0), 'npng')
    endif
endfunction

function status_check_ping takes nothing returns nothing
    local integer bitmask= 0
    local boolean should_send= false
    local player p= Player(0)
    call SetPlayerTechMaxAllowed(p, 'nske', - 1)
    call SetPlayerTechMaxAllowed(p, 'nwgt', - 1)
    call SetPlayerTechMaxAllowed(p, 'nvlk', - 1)
    call SetPlayerTechMaxAllowed(p, 'nvk2', - 1)
    call io_read_file_simple("ping.txt")
    if GetPlayerTechMaxAllowed(p, 'nske') != update_index or GetPlayerTechMaxAllowed(p, 'nvlk') != MISSION_ID then
        if checks_before_timeout > 0 then
            set checks_before_timeout=checks_before_timeout - 1
        elseif checks_before_timeout == 0 then
            set checks_before_timeout=- 1
            set error_state=1
            call DisplayTextToForce(GetPlayersAll(), "|cffff2222Error: Client communication timeout|r")
            call DisplayTextToForce(GetPlayersAll(), "|cffff2222Check the client is started correctly. Locations will not send until communication is established|r")
        endif
        return
    elseif world_id >= 0 and GetPlayerTechMaxAllowed(p, 'nwgt') != world_id then
        if error_state != 2 then
            set error_state=2
            call DisplayTextToForce(GetPlayersAll(), "|cffff2222Error: Client is connected to a different world seed|r")
            call DisplayTextToForce(GetPlayersAll(), "|cffff2222Restart the level or connect the client to a different room|r")
        endif
        return
    elseif error_state > 0 and world_id >= 0 then
        set error_state=0
        call DisplayTextToForce(GetPlayersAll(), "|cff2266ffClient communications re-established.|r")
    endif
    set world_id=GetPlayerTechMaxAllowed(p, 'nwgt')
    set checks_before_timeout=2
    set bitmask=GetPlayerTechMaxAllowed(p, 'nvk2')
    if bitmask > 0 then
        set should_send=true
    endif
    if bitmask >= 256 then
        // bitmask & 255
        set bitmask=bitmask - ( ( bitmask / 256 ) * 256 )
    endif
    if bitmask >= 128 then
        set bitmask=bitmask - 128
        // unused
    endif
    if bitmask >= 64 then
        set bitmask=bitmask - 64
        call TriggerExecute(t_hero_set_all_max_level)
    endif
    if bitmask >= 32 then
        set bitmask=bitmask - 32
        call status_init_item_channels(0)
        if item_channel_2 > 0 then
            call status_init_item_channels(1)
        endif
    endif
    if bitmask >= 16 then
        set bitmask=bitmask - 16
        call status_load_items()
    endif
    if bitmask >= 8 then
        set bitmask=bitmask - 8
        call TriggerExecute(t_hero_configure_all)
    endif
    if bitmask >= 4 then
        set bitmask=bitmask - 4
        call status_load_messages()
    endif
    if bitmask >= 2 then
        set bitmask=bitmask - 2
        call status_load_locations()
    endif
    if bitmask >= 1 then
        set bitmask=bitmask - 1
        call status_load_unlocks()
    endif
    if should_send then
        call status_send()
    endif
endfunction

function InitTrig_status takes nothing returns nothing
    local integer i= 0
    loop
        exitwhen i >= MAX_LOCATIONS
        set locations_checked[i]=false
        set i=i + 1
    endloop
    set i=0
    loop
        exitwhen GetPlayerController(Player(i)) == MAP_CONTROL_USER
        exitwhen i > 10
        set i=i + 1
    endloop
    set status_ack_ping_timer=CreateTimer()
    call status_send()
    call TimerStart(status_ack_ping_timer, 1, true, function status_check_ping)
    // Captains
    call captains_init()
endfunction
//===========================================================================
// Trigger: heroes
//===========================================================================
// Functions to control and configure heroes
// depends: fileio, map_config, status

function hero_apply_max_level takes unit hero,integer level returns nothing
    if GetHeroLevel(hero) >= level then
        call SetHeroLevelBJ(hero, level, false)
        call SuspendHeroXP(hero, true)
    else
        call SuspendHeroXP(hero, false)
    endif
endfunction

function hero_set_max_level takes integer slot,integer level returns nothing
    local unit hero= hero_get_unit_from_index(slot)
    set HERO_MAX_LEVEL[slot]=level
    call hero_apply_max_level(hero , level)
endfunction

function hero_load takes integer hero_slot returns boolean
    local player p= Player(0)
    call SetPlayerTechMaxAllowed(p, 'nech', - 1)
    call SetPlayerTechMaxAllowed(p, 'nske', - 1)
    call SetPlayerTechMaxAllowed(p, 'npng', - 1)
    call SetPlayerTechMaxAllowed(p, 'ndog', 0)
    call SetPlayerTechMaxAllowed(p, 'nskk', 0)
    call SetPlayerTechMaxAllowed(p, 'npig', 0)
    call SetPlayerTechMaxAllowed(p, 'nsea', 0)
    call SetPlayerTechMaxAllowed(p, 'ncrb', 0)
    call SetPlayerTechMaxAllowed(p, 'nder', 0)
    // nfro = abil IDs
    call SetPlayerTechMaxAllowed(Player(0), 'nfro', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'nfro', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'nfro', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'nfro', 0)
    // nrac = abil skillpoints
    call SetPlayerTechMaxAllowed(Player(0), 'nrac', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'nrac', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'nrac', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'nrac', 0)
    // nvul = items
    call SetPlayerTechMaxAllowed(Player(0), 'nvul', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'nvul', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'nvul', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'nvul', 0)
    call SetPlayerTechMaxAllowed(Player(4), 'nvul', 0)
    call SetPlayerTechMaxAllowed(Player(5), 'nvul', 0)

    call SetPlayerTechMaxAllowed(p, 'nalb', hero_global_slots[hero_slot])
    call io_read_file("heroes.txt")

    if GetPlayerTechMaxAllowed(p, 'nske') == 1 then
        set HERO_MAX_LEVEL[hero_slot]=GetPlayerTechMaxAllowed(p, 'nder')
        set hero_abil_1[hero_slot]=GetPlayerTechMaxAllowed(Player(0), 'nfro')
        set hero_abil_2[hero_slot]=GetPlayerTechMaxAllowed(Player(1), 'nfro')
        set hero_abil_3[hero_slot]=GetPlayerTechMaxAllowed(Player(2), 'nfro')
        set hero_abil_4[hero_slot]=GetPlayerTechMaxAllowed(Player(3), 'nfro')
        set last_hero_packet=GetPlayerTechMaxAllowed(p, 'nech')
    endif

    return GetPlayerTechMaxAllowed(p, 'nske') == 1
endfunction

// should be called after hero_load()
function hero_configure takes unit hero,integer slot returns nothing
    local player p= Player(0)
    local integer val
    local integer i= 0
    local item i_item
    call SetHeroXP(hero, GetPlayerTechMaxAllowed(p, 'ncrb'), false)
    set val=GetPlayerTechMaxAllowed(p, 'ndog')
    if val > 0 then
        call SetHeroAgi(hero, val, true)
    endif
    set val=GetPlayerTechMaxAllowed(p, 'nskk')
    if val > 0 then
        call SetHeroStr(hero, val, true)
    endif
    set val=GetPlayerTechMaxAllowed(p, 'npig')
    if val > 0 then
        call SetHeroInt(hero, val, true)
    endif
    set val=GetPlayerTechMaxAllowed(p, 'nsea')
    if val > 0 then
        call SetUnitState(hero, UNIT_STATE_MAX_LIFE, I2R(val))
        call SetUnitState(hero, UNIT_STATE_LIFE, I2R(val))
    endif
    call BlzSetHeroProperName(hero, io_lines[0])
    // abilities
    loop
        exitwhen i > 3
        set val=GetPlayerTechMaxAllowed(Player(i), 'nrac')
        loop
            exitwhen val <= 0
            set val=val - 1
            call SelectHeroSkill(hero, GetPlayerTechMaxAllowed(Player(i), 'nfro'))
        endloop
        set i=i + 1
    endloop
    // items
    set i=0
    loop
        exitwhen i > 5
        set val=GetPlayerTechMaxAllowed(Player(i), 'nvul')
        if val > 0 then
            set i_item=UnitAddItemById(hero, val)
        else
            // pad out empty slots with a dummy item so later items go to the correct slots
            set i_item=UnitAddItemById(hero, 'wtlg')
        endif
        set val=GetPlayerTechMaxAllowed(Player(i), 'nsno')
        if val > 0 and GetItemCharges(i_item) > 0 then
            call SetItemCharges(i_item, val)
        endif
        set i=i + 1
    endloop
    set i=0
    loop
        exitwhen i > 5
        if GetItemTypeId(UnitItemInSlot(hero, i)) == 'wtlg' then
            set i_item=UnitRemoveItemFromSlot(hero, i)
            call RemoveItem(i_item)
        endif
        set i=i + 1
    endloop
    // max level
    set val=GetPlayerTechMaxAllowed(p, 'nder')
    if val > 0 then
        set HERO_MAX_LEVEL[slot]=val
        call hero_apply_max_level(hero , val)
    endif
endfunction

function hero_configure_all takes nothing returns nothing
    local integer slot= 0
    local unit hero
    loop
        exitwhen slot >= NUM_HEROES
        call hero_load(slot)
        set hero=hero_get_unit_from_index(slot)
        // todo: handle hero unit type mismatch
        call hero_configure(hero , slot)
        set slot=slot + 1
    endloop
endfunction

function hero_set_all_max_level takes nothing returns nothing
    local integer slot= 0
    local unit hero
    loop
        exitwhen slot >= NUM_HEROES
        call hero_load(slot)
        call hero_set_max_level(slot , GetPlayerTechMaxAllowed(Player(0), 'nder'))
        set slot=slot + 1
    endloop
endfunction

function hero_create takes integer hero_slot,player for_player,real x,real y,real facing returns unit
    local unit hero= null
    if not hero_load(hero_slot) then
        return null
    endif
    set hero=CreateUnit(for_player, GetPlayerTechMaxAllowed(Player(0), 'npng'), x, y, facing)
    return hero
endfunction

function hero_hide_replace takes integer slot,unit replace returns unit
    local unit old_hero= hero_get_unit_from_index(slot)
    local unit hero
    call ShowUnit(old_hero, false)
    set hero=hero_create(slot , GetOwningPlayer(old_hero) , GetUnitX(old_hero) , GetUnitY(old_hero) , GetUnitFacing(old_hero))
    if hero == null then
        call ShowUnit(old_hero, true)
        return old_hero
    endif
    call hero_configure(hero , slot)
    call hero_update_variable(slot , hero)
    call RemoveUnit(hero)
    return hero
endfunction

function hero_hash_state takes unit hero,integer slot returns integer
    local integer result= 0
    set result=result + GetHeroLevel(hero)
    set result=result * 3 + GetHeroAgi(hero, false)
    set result=result * 3 + GetHeroStr(hero, false)
    set result=result * 3 + GetHeroInt(hero, false)
    set result=result * 3 + R2I(GetUnitState(hero, UNIT_STATE_MAX_LIFE))
    set result=result * 3 + GetUnitAbilityLevel(hero, hero_abil_1[slot])
    set result=result * 3 + GetUnitAbilityLevel(hero, hero_abil_2[slot])
    set result=result * 3 + GetUnitAbilityLevel(hero, hero_abil_3[slot])
    set result=result * 3 + GetUnitAbilityLevel(hero, hero_abil_4[slot])
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 0))
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 1))
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 2))
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 3))
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 4))
    set result=result * 3 + GetItemTypeId(UnitItemInSlot(hero, 5))
    return result
endfunction

function hero_publish_status takes integer slot returns nothing
    local unit hero= hero_get_unit_from_index(slot)
    local integer this_hash= hero_hash_state(hero , slot)
    local integer i= 0
    local item i_item
    if this_hash == hero_hashes[slot] then
        return
    endif
    set hero_hashes[slot]=this_hash
    call io_open_write("hero_" + I2S(hero_global_slots[slot]) + ".txt")
    call io_write(I2S(hero_global_slots[slot]))
    call io_write(GetHeroProperName(hero))
    call io_write(I2S(GetHeroXP(hero)))
    call io_write(I2S(GetHeroAgi(hero, false)))
    call io_write(I2S(GetHeroStr(hero, false)))
    call io_write(I2S(GetHeroInt(hero, false)))
    call io_write(I2S(R2I(GetUnitState(hero, UNIT_STATE_MAX_LIFE))))
    if GetUnitTypeId(hero) == 'Ntin' then
        // special handling for Goblin Tinker
        if GetUnitAbilityLevel(hero, 'ANeg') == 0 then
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANsy')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANcs')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANeg')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANrg')))
        elseif GetUnitAbilityLevel(hero, 'ANeg') == 1 then
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANs1')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANc1')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANeg')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANg1')))
        elseif GetUnitAbilityLevel(hero, 'ANeg') == 2 then
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANs2')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANc2')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANeg')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANg2')))
        else
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANs3')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANc3')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANeg')))
            call io_write(I2S(GetUnitAbilityLevel(hero, 'ANg3')))
        endif
    else
        call io_write(I2S(GetUnitAbilityLevel(hero, hero_abil_1[slot])))
        call io_write(I2S(GetUnitAbilityLevel(hero, hero_abil_2[slot])))
        call io_write(I2S(GetUnitAbilityLevel(hero, hero_abil_3[slot])))
        call io_write(I2S(GetUnitAbilityLevel(hero, hero_abil_4[slot])))
    endif
    loop
        exitwhen i >= 6
        set i_item=UnitItemInSlot(hero, i)
        call io_write(I2S(GetItemTypeId(i_item)))
        if i_item == null then
            call io_write("0")
        else
            call io_write(I2S(GetItemCharges(i_item)))
        endif
        set i=i + 1
    endloop
    call io_close_write()

    set hero_status_index=hero_status_index + 1
    if hero_status_index >= MAX_UPDATE_ID then
        set hero_status_index=0
    endif
endfunction

function hero_publish_all_statuses takes nothing returns nothing
    local integer i= 0
    local integer starting_hero_status_index= hero_status_index
    loop
        exitwhen i >= NUM_HEROES
        call hero_publish_status(i)
        set i=i + 1
    endloop
    if hero_status_index != starting_hero_status_index then
        call status_send()
    endif
endfunction

function hero_on_level takes unit hero returns nothing
    local integer hero_index= hero_get_index_from_unit(hero)
    if hero_index >= NUM_HEROES then
        return
    endif
    call hero_apply_max_level(hero , HERO_MAX_LEVEL[hero_index])
endfunction

function hero_on_level_triggerfunction takes nothing returns nothing
    call hero_on_level(GetTriggerUnit())
endfunction

function hero_on_item_pickup takes nothing returns nothing
    local integer hero_index= hero_get_index_from_unit(GetTriggerUnit())
    if not IsHeroUnitId(GetUnitTypeId(GetTriggerUnit())) then
        return
    endif
    if hero_index == item_channel_2_hero_slot then
        return
    endif
    set item_channel_1_target=GetTriggerUnit()
endfunction

function InitTrig_heroes takes nothing returns nothing
    set t_hero_update=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(t_hero_update, USER_PLAYER, EVENT_PLAYER_HERO_LEVEL)
    call TriggerAddAction(t_hero_update, function hero_on_level_triggerfunction)
    set t_hero_pickup_item=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(t_hero_pickup_item, USER_PLAYER, EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerAddAction(t_hero_pickup_item, function hero_on_item_pickup)
    set t_hero_configure_all=CreateTrigger()
    call TriggerAddAction(t_hero_configure_all, function hero_configure_all)
    set t_hero_set_all_max_level=CreateTrigger()
    call TriggerAddAction(t_hero_set_all_max_level, function hero_set_all_max_level)
    set hero_update_status_timer=CreateTimer()
    call TimerStart(hero_update_status_timer, 1, true, function hero_publish_all_statuses)
    set item_channel_1_target=hero_get_unit_from_index(0)
    set item_channel_2_target=hero_get_unit_from_index(item_channel_2_hero_slot)
    set hero_hashes[0]=0
    set hero_hashes[1]=0
    set hero_hashes[2]=0
    set hero_hashes[3]=0
endfunction
//===========================================================================
// Trigger: item_locations
//===========================================================================
// triggers for sending locations when picking up location-linked items
// depends: status

function trigger_function_item_locations takes nothing returns nothing
    local integer item_id= GetItemTypeId(GetManipulatedItem())
    if ( item_id == 'I010' ) then
        call status_check_location(0)
    elseif ( item_id == 'I011' ) then
        call status_check_location(1)
    elseif ( item_id == 'I012' ) then
        call status_check_location(2)
    elseif ( item_id == 'I013' ) then
        call status_check_location(3)
    elseif ( item_id == 'I014' ) then
        call status_check_location(4)
    elseif ( item_id == 'I015' ) then
        call status_check_location(5)
    elseif ( item_id == 'I016' ) then
        call status_check_location(6)
    elseif ( item_id == 'I017' ) then
        call status_check_location(7)
    elseif ( item_id == 'I018' ) then
        call status_check_location(8)
    elseif ( item_id == 'I019' ) then
        call status_check_location(9)
    elseif ( item_id == 'I01A' ) then
        call status_check_location(10)
    elseif ( item_id == 'I01B' ) then
        call status_check_location(11)
    elseif ( item_id == 'I01C' ) then
        call status_check_location(12)
    elseif ( item_id == 'I01D' ) then
        call status_check_location(13)
    elseif ( item_id == 'I01E' ) then
        call status_check_location(14)
    elseif ( item_id == 'I01F' ) then
        call status_check_location(15)
    elseif ( item_id == 'I020' ) then
        call status_check_location(16)
    elseif ( item_id == 'I021' ) then
        call status_check_location(17)
    elseif ( item_id == 'I022' ) then
        call status_check_location(18)
    elseif ( item_id == 'I023' ) then
        call status_check_location(19)
    elseif ( item_id == 'I024' ) then
        call status_check_location(20)
    elseif ( item_id == 'I025' ) then
        call status_check_location(21)
    elseif ( item_id == 'I026' ) then
        call status_check_location(22)
    elseif ( item_id == 'I027' ) then
        call status_check_location(23)
    elseif ( item_id == 'I028' ) then
        call status_check_location(24)
    elseif ( item_id == 'I029' ) then
        call status_check_location(25)
    elseif ( item_id == 'I02A' ) then
        call status_check_location(26)
    elseif ( item_id == 'I02B' ) then
        call status_check_location(27)
    elseif ( item_id == 'I02C' ) then
        call status_check_location(28)
    elseif ( item_id == 'I02D' ) then
        call status_check_location(29)
    elseif ( item_id == 'I02E' ) then
        call status_check_location(30)
    elseif ( item_id == 'I02F' ) then
        call status_check_location(31)
    endif
endfunction

function InitTrig_item_locations takes nothing returns nothing
    set t_location_found=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(t_location_found, USER_PLAYER, EVENT_PLAYER_UNIT_PICKUP_ITEM)
    call TriggerAddAction(t_location_found, function trigger_function_item_locations)
endfunction
//===========================================================================
// Trigger: debug
//===========================================================================
// debug commands

function debug_print_help takes nothing returns nothing
    call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, "Commands: '-print', '-xp', '-xp2', '-health', '-dragon', '-speed'")
endfunction

function debug_xp_tome takes nothing returns nothing
    // call CreateItem('texp', GetStartLocationX(GetPlayerId(USER_PLAYER)), GetStartLocationY(GetPlayerId(USER_PLAYER)))
    call CreateItem('texp', GetUnitX(item_channel_1_target), GetUnitX(item_channel_1_target))
endfunction

function debug_xp2_tome takes nothing returns nothing
    call CreateItem('tkno', GetUnitX(item_channel_1_target), GetUnitX(item_channel_1_target))
endfunction

function debug_health_tome takes nothing returns nothing
    call CreateItem('manh', GetUnitX(item_channel_1_target), GetUnitX(item_channel_1_target))
endfunction

function debug_dragon_egg takes nothing returns nothing
    call CreateItem('fgrd', GetUnitX(item_channel_1_target), GetUnitX(item_channel_1_target))
endfunction

function debug_speed takes nothing returns nothing
    call CreateItem('rspd', GetUnitX(item_channel_1_target), GetUnitX(item_channel_1_target))
endfunction

function debug_print takes nothing returns nothing
    local string s_locations_checked= ""
    local integer index= 0
    call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, "world_id: " + I2S(world_id))
    loop
        exitwhen index >= MAX_LOCATIONS
        if locations_checked[index] then
            set s_locations_checked=s_locations_checked + "," + I2S(index)
        endif
        set index=index + 1
    endloop
    call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, "checked: " + s_locations_checked)
    set index=0
    loop
        exitwhen index >= NUM_HEROES
        call DisplayTextToPlayer(GetLocalPlayer(), 0, 0, "Hero " + I2S(index) + " max level: " + I2S(HERO_MAX_LEVEL[index]))
        set index=index + 1
    endloop
endfunction

function InitTrig_debug takes nothing returns nothing
    set t_help=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_help, USER_PLAYER, "-help", false)
    call TriggerAddAction(t_help, function debug_print_help)
    set t_xp=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_xp, USER_PLAYER, "-xp", false)
    call TriggerAddAction(t_xp, function debug_xp_tome)
    set t_xp2=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_xp2, USER_PLAYER, "-xp2", false)
    call TriggerAddAction(t_xp2, function debug_xp2_tome)
    set t_health=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_health, USER_PLAYER, "-health", false)
    call TriggerAddAction(t_health, function debug_health_tome)
    set t_dragon=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_dragon, USER_PLAYER, "-dragon", false)
    call TriggerAddAction(t_dragon, function debug_dragon_egg)
    set t_speed=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_speed, USER_PLAYER, "-speed", false)
    call TriggerAddAction(t_speed, function debug_speed)
    set t_print=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_print, USER_PLAYER, "-print", false)
    call TriggerAddAction(t_print, function debug_print)
endfunction
//===========================================================================
// Trigger: zoom
//===========================================================================

function Trig_zoom_Actions takes nothing returns nothing
    call SetCameraFieldForPlayer(GetTriggerPlayer(), CAMERA_FIELD_TARGET_DISTANCE, S2R(SubStringBJ(GetEventPlayerChatString(), 7, 10)), 0)
endfunction

//===========================================================================
function InitTrig_zoom takes nothing returns nothing
    set t_zoom=CreateTrigger()
    call TriggerRegisterPlayerChatEvent(t_zoom, USER_PLAYER, "-zoom ", false)
    call TriggerAddAction(t_zoom, function Trig_zoom_Actions)
endfunction
//===========================================================================
// Trigger: irregulars
//===========================================================================

function irregular_transform takes unit u,integer abil_id returns effect
    local effect e= AddSpecialEffect("Abilities\\Spells\\Human\\Polymorph\\PolyMorphDoneGround.mdl", GetUnitX(u), GetUnitY(u))
    call UnitAddAbility(u, abil_id)
    call IssueImmediateOrder(u, "ravenform")
    return e
endfunction

function irregulars_on_cast takes nothing returns nothing
    local integer a= GetSpellAbilityId()
    local effect e= null
    if a == 'AP00' then
        // captain
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0a')
    elseif a == 'AP01' then
        // footman
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0b')
    elseif a == 'AP02' then
        // rifleman
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0c')
    elseif a == 'AP03' then
        // archer
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0d')
    elseif a == 'AP04' then
        // knight
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0e')
    elseif a == 'AP05' then
        // priest
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0f')
    elseif a == 'AP06' then
        // sorceress
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0g')
    elseif a == 'AP07' then
        // spell breaker
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0h')
    elseif a == 'AP08' then
        // mortar team
        set e=irregular_transform(GetSpellAbilityUnit() , 'AP0i')
    endif
    if e != null then
        call TriggerSleepAction(2.0)
        call DestroyEffect(e)
    endif
endfunction

//===========================================================================
function InitTrig_irregulars takes nothing returns nothing
    set t_irregulars_on_cast=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(t_irregulars_on_cast, USER_PLAYER, EVENT_PLAYER_UNIT_SPELL_CAST)
    call TriggerAddAction(t_irregulars_on_cast, function irregulars_on_cast)
    call Preload("Abilities\\Spells\\Human\\Polymorph\\PolyMorphDoneGround.mdl")
endfunction
//===========================================================================
// Trigger: AP Load Arthas
//===========================================================================
function Trig_AP_Load_Arthas_Func003001 takes nothing returns boolean
    return ( udg_Arthas != null )
endfunction

function Trig_AP_Load_Arthas_Actions takes nothing returns nothing
    // Load the hero data
    set udg_Arthas=hero_create(0 , USER_PLAYER , GetRectCenterX(gg_rct_ArthasStart) , GetRectCenterY(gg_rct_ArthasStart) , 90.0)
    if ( Trig_AP_Load_Arthas_Func003001() ) then
        return
    else
        call DoNothing()
    endif
    // If the hero data wasn't found, create a default hero
    set udg_Arthas=CreateUnit(USER_PLAYER, 'Hart', GetRectCenterX(gg_rct_ArthasStart), GetRectCenterY(gg_rct_ArthasStart), 270.0)
    set hero_abil_1[0]='AHhb'
    set hero_abil_2[0]='AHds'
    set hero_abil_3[0]='AHad'
    set hero_abil_4[0]='AHre'
endfunction

//===========================================================================
function InitTrig_AP_Load_Arthas takes nothing returns nothing
    set gg_trg_AP_Load_Arthas=CreateTrigger()
    call TriggerAddAction(gg_trg_AP_Load_Arthas, function Trig_AP_Load_Arthas_Actions)
endfunction

//===========================================================================
// Trigger: AP Load Jaina
//===========================================================================
function Trig_AP_Load_Jaina_Func003001 takes nothing returns boolean
    return ( udg_Jaina != null )
endfunction

function Trig_AP_Load_Jaina_Actions takes nothing returns nothing
    // Load the hero data
    set udg_Jaina=hero_create(1 , Player(3) , 5927.87646484375 , - 3474.820556640625 , 3.270430326461792)
    if ( Trig_AP_Load_Jaina_Func003001() ) then
        return
    else
        call DoNothing()
    endif
    // If the hero data wasn't found, create a default hero
    set udg_Jaina=CreateUnit(Player(3), 'Hjai', 5927.87646484375, - 3474.820556640625, 3.270430326461792)
    set hero_abil_1[0]='AHbz'
    set hero_abil_2[0]='AHwe'
    set hero_abil_3[0]='AHab'
    set hero_abil_4[0]='AHmt'
endfunction

//===========================================================================
function InitTrig_AP_Load_Jaina takes nothing returns nothing
    set gg_trg_AP_Load_Jaina=CreateTrigger()
    call TriggerAddAction(gg_trg_AP_Load_Jaina, function Trig_AP_Load_Jaina_Actions)
endfunction

//===========================================================================
// Trigger: MapInitialization
//
// Default melee game initialization for all players
//===========================================================================
function Trig_MapInitialization_Func044002 takes nothing returns nothing
    call GroupAddUnitSimple(GetEnumUnit(), udg_DefendersGroup)
endfunction

function Trig_MapInitialization_Actions takes nothing returns nothing
    call SetCampaignMenuRaceBJ(bj_CAMPAIGN_INDEX_H)
    // ************
    call SetTimeOfDay(6.01)
    call SetSkyModel("Environment\\Sky\\LordaeronSummerSky\\LordaeronSummerSky.mdl")
    // ************
    call ConditionalTriggerExecute(gg_trg_Bubble)
    call ConditionalTriggerExecute(gg_trg_Opening01)
    call TriggerExecute(gg_trg_SetupOpeningAllies)
    call TriggerExecute(gg_trg_SetupScoreScreen)
    call TriggerExecute(gg_trg_SetupHeroes)
    // Difficulty
    call ConditionalTriggerExecute(gg_trg_Difficulty_Easy)
    call ConditionalTriggerExecute(gg_trg_Difficulty_Normal)
    call ConditionalTriggerExecute(gg_trg_Difficulty_Hard)
    // Setup Characters
    call TriggerExecute(gg_trg_SetupCaptain)
    call TriggerExecute(gg_trg_SetupKelThuzad)
    call TriggerExecute(gg_trg_SetupHeroGroup)
    // Setup Creeps and Undead
    call TriggerExecute(gg_trg_SetupCreeps)
    call TriggerExecute(gg_trg_SetupBanditVillageGroup)
    call TriggerExecute(gg_trg_SetupAbomination)
    call TriggerExecute(gg_trg_SetupBanditCampGroup)
    call TriggerExecute(gg_trg_SetupAcolyteGroup)
    call TriggerExecute(gg_trg_SetupSkeletonGroup01)
    call TriggerExecute(gg_trg_SetupSkeletonGroup02)
    call TriggerExecute(gg_trg_SetupSkeletonArcherGroup)
    call TriggerExecute(gg_trg_SetupSkeletonBeforeMortars)
    call TriggerExecute(gg_trg_SetupSkeletonShipGroup)
    call TriggerExecute(gg_trg_SetupSkeletonFinalGroup)
    call TriggerExecute(gg_trg_SetupSkeletonsMortarFodder)
    call TriggerExecute(gg_trg_SetupVillagerVision)
    // Grainary Invulnerable For Grain Cinematic
    call SetUnitInvulnerable(gg_unit_ngni_0080, true)
    // Villagers and rescuable
    call TriggerExecute(gg_trg_SetupStartingPartyGroup)
    call TriggerExecute(gg_trg_SetupPeasantPatrolGroup)
    call TriggerExecute(gg_trg_SetupFootmenDefendingGroup)
    call TriggerExecute(gg_trg_SetupPriestGroup)
    // Alliance and Spell Settings
    call SetPlayerAllianceBJ(Player(1), ALLIANCE_SHARED_SPELLS, true, Player(9))
    call SetPlayerAllianceBJ(Player(9), ALLIANCE_SHARED_SPELLS, true, Player(1))
    // Defenders Group
    call ForGroupBJ(GetUnitsInRectOfPlayer(gg_rct_FootmenDefendingArea, Player(9)), function Trig_MapInitialization_Func044002)
    // *****************
endfunction

//===========================================================================
function InitTrig_MapInitialization takes nothing returns nothing
    set gg_trg_MapInitialization=CreateTrigger()
    call TriggerAddAction(gg_trg_MapInitialization, function Trig_MapInitialization_Actions)
endfunction

//===========================================================================
// Trigger: Difficulty Easy
//===========================================================================
function Trig_Difficulty_Easy_Conditions takes nothing returns boolean
    if ( not ( GetGameDifficulty() == MAP_DIFFICULTY_EASY ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Easy_Actions takes nothing returns nothing
    // Handicap
    call SetPlayerHandicapBJ(Player(6), bj_HANDICAP_EASY)
    call SetPlayerHandicapBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_HANDICAP_EASY)
    // From Normal
    call RemoveUnit(gg_unit_nska_0027)
    call RemoveUnit(gg_unit_nska_0137)
    call RemoveUnit(gg_unit_unec_0139)
    call RemoveUnit(gg_unit_nban_0140)
    call RemoveUnit(gg_unit_nban_0141)
    call RemoveUnit(gg_unit_nmrl_0142)
    call RemoveUnit(gg_unit_nrog_0143)
    call RemoveUnit(gg_unit_nska_0145)
    call RemoveUnit(gg_unit_nska_0144)
    call RemoveUnit(gg_unit_nska_0146)
    call RemoveUnit(gg_unit_uske_0148)
    call RemoveUnit(gg_unit_uske_0147)
    call RemoveUnit(gg_unit_nska_0149)
    call RemoveUnit(gg_unit_nska_0150)
    call RemoveUnit(gg_unit_nska_0151)
    call RemoveUnit(gg_unit_nska_0152)
    call RemoveUnit(gg_unit_nska_0153)
endfunction

//===========================================================================
function InitTrig_Difficulty_Easy takes nothing returns nothing
    set gg_trg_Difficulty_Easy=CreateTrigger()
    call TriggerAddCondition(gg_trg_Difficulty_Easy, Condition(function Trig_Difficulty_Easy_Conditions))
    call TriggerAddAction(gg_trg_Difficulty_Easy, function Trig_Difficulty_Easy_Actions)
endfunction

//===========================================================================
// Trigger: Difficulty Normal
//===========================================================================
function Trig_Difficulty_Normal_Conditions takes nothing returns boolean
    if ( not ( GetGameDifficulty() == MAP_DIFFICULTY_NORMAL ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Normal_Actions takes nothing returns nothing
    call RemoveUnit(gg_unit_nska_0027)
    call RemoveUnit(gg_unit_nska_0137)
    call RemoveUnit(gg_unit_unec_0139)
    call RemoveUnit(gg_unit_nban_0140)
    call RemoveUnit(gg_unit_nban_0141)
    call RemoveUnit(gg_unit_nmrl_0142)
    call RemoveUnit(gg_unit_nrog_0143)
    call RemoveUnit(gg_unit_nska_0145)
    call RemoveUnit(gg_unit_nska_0144)
    call RemoveUnit(gg_unit_nska_0146)
    call RemoveUnit(gg_unit_uske_0148)
    call RemoveUnit(gg_unit_uske_0147)
    call RemoveUnit(gg_unit_nska_0149)
    call RemoveUnit(gg_unit_nska_0150)
    call RemoveUnit(gg_unit_nska_0151)
    call RemoveUnit(gg_unit_nska_0152)
    call RemoveUnit(gg_unit_nska_0153)
endfunction

//===========================================================================
function InitTrig_Difficulty_Normal takes nothing returns nothing
    set gg_trg_Difficulty_Normal=CreateTrigger()
    call TriggerAddCondition(gg_trg_Difficulty_Normal, Condition(function Trig_Difficulty_Normal_Conditions))
    call TriggerAddAction(gg_trg_Difficulty_Normal, function Trig_Difficulty_Normal_Actions)
endfunction

//===========================================================================
// Trigger: Difficulty Hard
//===========================================================================
function Trig_Difficulty_Hard_Conditions takes nothing returns boolean
    if ( not ( GetGameDifficulty() == MAP_DIFFICULTY_HARD ) ) then
        return false
    endif
    return true
endfunction

function Trig_Difficulty_Hard_Actions takes nothing returns nothing
endfunction

//===========================================================================
function InitTrig_Difficulty_Hard takes nothing returns nothing
    set gg_trg_Difficulty_Hard=CreateTrigger()
    call TriggerAddCondition(gg_trg_Difficulty_Hard, Condition(function Trig_Difficulty_Hard_Conditions))
    call TriggerAddAction(gg_trg_Difficulty_Hard, function Trig_Difficulty_Hard_Actions)
endfunction

//===========================================================================
// Trigger: SetupOpeningAllies
//===========================================================================
function Trig_SetupOpeningAllies_Actions takes nothing returns nothing
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(1), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(3), bj_ALLIANCE_ALLIED)
    // ***********************
    call SetPlayerAllianceStateBJ(Player(1), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(3), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED)
    // ***********************
    call SetPlayerAllianceStateBJ(Player(1), Player(3), bj_ALLIANCE_ALLIED_VISION)
    call SetPlayerAllianceStateBJ(Player(3), Player(1), bj_ALLIANCE_ALLIED_VISION)
    // ***********************
    call SetPlayerAllianceStateBJ(Player(1), Player(7), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(7), Player(1), bj_ALLIANCE_ALLIED)
    // ***********************
    call SetPlayerAllianceStateBJ(Player(6), Player(9), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED)
    // ***********************
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(2), bj_ALLIANCE_ALLIED)
endfunction

//===========================================================================
function InitTrig_SetupOpeningAllies takes nothing returns nothing
    set gg_trg_SetupOpeningAllies=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupOpeningAllies, function Trig_SetupOpeningAllies_Actions)
endfunction

//===========================================================================
// Trigger: SetupHeroes
//===========================================================================
function Trig_SetupHeroes_Actions takes nothing returns nothing
    call TriggerExecute(gg_trg_AP_Load_Arthas)
    call TriggerExecute(gg_trg_AP_Load_Jaina)
    // Experience
    call SetPlayerHandicapXPBJ(Player(1), 70.00)
endfunction

//===========================================================================
function InitTrig_SetupHeroes takes nothing returns nothing
    set gg_trg_SetupHeroes=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupHeroes, function Trig_SetupHeroes_Actions)
endfunction

//===========================================================================
// Trigger: SetupHeroGroup
//===========================================================================
function Trig_SetupHeroGroup_Actions takes nothing returns nothing
    call GroupAddUnitSimple(udg_Arthas, udg_Heroes)
    call GroupAddUnitSimple(udg_Jaina, udg_Heroes)
endfunction

//===========================================================================
function InitTrig_SetupHeroGroup takes nothing returns nothing
    set gg_trg_SetupHeroGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupHeroGroup, function Trig_SetupHeroGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupCaptain
//===========================================================================
function Trig_SetupCaptain_Actions takes nothing returns nothing
    set udg_Captain=gg_unit_hcth_0062
endfunction

//===========================================================================
function InitTrig_SetupCaptain takes nothing returns nothing
    set gg_trg_SetupCaptain=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupCaptain, function Trig_SetupCaptain_Actions)
endfunction

//===========================================================================
// Trigger: SetupKelThuzad
//===========================================================================
function Trig_SetupKelThuzad_Actions takes nothing returns nothing
    set udg_KelThuzad=gg_unit_uktn_0109
    call SetUnitInvulnerable(udg_KelThuzad, true)
endfunction

//===========================================================================
function InitTrig_SetupKelThuzad takes nothing returns nothing
    set gg_trg_SetupKelThuzad=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupKelThuzad, function Trig_SetupKelThuzad_Actions)
endfunction

//===========================================================================
// Trigger: SetupAbomination
//===========================================================================
function Trig_SetupAbomination_Actions takes nothing returns nothing
    set udg_Abomination=gg_unit_uabo_0110
endfunction

//===========================================================================
function InitTrig_SetupAbomination takes nothing returns nothing
    set gg_trg_SetupAbomination=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupAbomination, function Trig_SetupAbomination_Actions)
endfunction

//===========================================================================
// Trigger: SetupFootmenDefendingGroup
//===========================================================================
function Trig_SetupFootmenDefendingGroup_Func001002 takes nothing returns nothing
    call GroupAddUnitSimple(GetEnumUnit(), udg_FootmenDefending)
endfunction

function Trig_SetupFootmenDefendingGroup_Actions takes nothing returns nothing
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_FootmenDefendingArea), function Trig_SetupFootmenDefendingGroup_Func001002)
    call SetPlayerAllianceStateBJ(Player(9), Player(6), bj_ALLIANCE_UNALLIED)
endfunction

//===========================================================================
function InitTrig_SetupFootmenDefendingGroup takes nothing returns nothing
    set gg_trg_SetupFootmenDefendingGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupFootmenDefendingGroup, function Trig_SetupFootmenDefendingGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupBanditVillageGroup
//===========================================================================
function Trig_SetupBanditVillageGroup_Func001002 takes nothing returns nothing
    call GroupAddUnitSimple(GetEnumUnit(), udg_BanditsVillage)
endfunction

function Trig_SetupBanditVillageGroup_Func002002 takes nothing returns nothing
    call GroupAddUnitSimple(GetEnumUnit(), udg_BanditsVillage)
endfunction

function Trig_SetupBanditVillageGroup_Actions takes nothing returns nothing
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_BanditsVillageArea01), function Trig_SetupBanditVillageGroup_Func001002)
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_BanditsVillageArea02), function Trig_SetupBanditVillageGroup_Func002002)
endfunction

//===========================================================================
function InitTrig_SetupBanditVillageGroup takes nothing returns nothing
    set gg_trg_SetupBanditVillageGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupBanditVillageGroup, function Trig_SetupBanditVillageGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupBanditCampGroup
//===========================================================================
function Trig_SetupBanditCampGroup_Actions takes nothing returns nothing
    call GroupAddUnitSimple(gg_unit_nrog_0127, udg_BanditsCamp)
    call GroupAddUnitSimple(gg_unit_nenf_0102, udg_BanditsCamp)
    call GroupAddUnitSimple(gg_unit_nban_0088, udg_BanditsCamp)
endfunction

//===========================================================================
function InitTrig_SetupBanditCampGroup takes nothing returns nothing
    set gg_trg_SetupBanditCampGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupBanditCampGroup, function Trig_SetupBanditCampGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupAcolyteGroup
//===========================================================================
function Trig_SetupAcolyteGroup_Actions takes nothing returns nothing
    call GroupAddUnitSimple(gg_unit_uaco_0100, udg_AcolyteGroup)
    call GroupAddUnitSimple(gg_unit_uaco_0038, udg_AcolyteGroup)
    call GroupAddUnitSimple(gg_unit_uaco_0095, udg_AcolyteGroup)
    call GroupAddUnitSimple(gg_unit_uaco_0040, udg_AcolyteGroup)
endfunction

//===========================================================================
function InitTrig_SetupAcolyteGroup takes nothing returns nothing
    set gg_trg_SetupAcolyteGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupAcolyteGroup, function Trig_SetupAcolyteGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupStartingPartyGroup
//===========================================================================
function Trig_SetupStartingPartyGroup_Actions takes nothing returns nothing
    call GroupAddUnitSimple(udg_Arthas, udg_StartingParty)
    call GroupAddUnitSimple(udg_Jaina, udg_StartingParty)
    call GroupAddUnitSimple(udg_Captain, udg_StartingParty)
    call GroupAddUnitSimple(gg_unit_hfoo_0004, udg_StartingParty)
    call GroupAddUnitSimple(gg_unit_hfoo_0003, udg_StartingParty)
endfunction

//===========================================================================
function InitTrig_SetupStartingPartyGroup takes nothing returns nothing
    set gg_trg_SetupStartingPartyGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupStartingPartyGroup, function Trig_SetupStartingPartyGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonArcherGroup
//===========================================================================
function Trig_SetupSkeletonArcherGroup_Actions takes nothing returns nothing
    set udg_SkeletonsArcher=GetUnitsInRectAll(gg_rct_SkeletonArchers)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonArcherGroup takes nothing returns nothing
    set gg_trg_SetupSkeletonArcherGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonArcherGroup, function Trig_SetupSkeletonArcherGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonGroup01
//===========================================================================
function Trig_SetupSkeletonGroup01_Actions takes nothing returns nothing
    set udg_SkeletonsAmbush=GetUnitsInRectAll(gg_rct_AmbushSkeletons)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonGroup01 takes nothing returns nothing
    set gg_trg_SetupSkeletonGroup01=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonGroup01, function Trig_SetupSkeletonGroup01_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonGroup02
//===========================================================================
function Trig_SetupSkeletonGroup02_Func002002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GetEnumUnit(), "patrol", GetRectCenter(gg_rct_Patrol01End))
endfunction

function Trig_SetupSkeletonGroup02_Actions takes nothing returns nothing
    set udg_SkeletonsPatrol01=GetUnitsInRectAll(gg_rct_Patrol01Start)
    call ForGroupBJ(udg_SkeletonsPatrol01, function Trig_SetupSkeletonGroup02_Func002002)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonGroup02 takes nothing returns nothing
    set gg_trg_SetupSkeletonGroup02=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonGroup02, function Trig_SetupSkeletonGroup02_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonShipGroup
//===========================================================================
function Trig_SetupSkeletonShipGroup_Actions takes nothing returns nothing
    set udg_SkeletonShipGroup=GetUnitsInRectAll(gg_rct_SkeletonShip)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonShipGroup takes nothing returns nothing
    set gg_trg_SetupSkeletonShipGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonShipGroup, function Trig_SetupSkeletonShipGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupPeasantPatrolGroup
//===========================================================================
function Trig_SetupPeasantPatrolGroup_Actions takes nothing returns nothing
    set udg_PeasantPatrolGroup01=GetUnitsInRectAll(gg_rct_PeasantPatrolArea)
    set udg_PeasantPatrolGroup02=GetUnitsInRectAll(gg_rct_PatrollSmallArea)
endfunction

//===========================================================================
function InitTrig_SetupPeasantPatrolGroup takes nothing returns nothing
    set gg_trg_SetupPeasantPatrolGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupPeasantPatrolGroup, function Trig_SetupPeasantPatrolGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonBeforeMortars
//===========================================================================
function Trig_SetupSkeletonBeforeMortars_Actions takes nothing returns nothing
    set udg_SkeletonBeforeMortarsGroup=GetUnitsInRectAll(gg_rct_SkeletonBeforeMortars)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonBeforeMortars takes nothing returns nothing
    set gg_trg_SetupSkeletonBeforeMortars=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonBeforeMortars, function Trig_SetupSkeletonBeforeMortars_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonFinalGroup
//===========================================================================
function Trig_SetupSkeletonFinalGroup_Actions takes nothing returns nothing
    set udg_SkeletonFinalGroup=GetUnitsInRectAll(gg_rct_SkeletonFinalGroup)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonFinalGroup takes nothing returns nothing
    set gg_trg_SetupSkeletonFinalGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonFinalGroup, function Trig_SetupSkeletonFinalGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupSkeletonsMortarFodder
//===========================================================================
function Trig_SetupSkeletonsMortarFodder_Actions takes nothing returns nothing
    set udg_SkeletonsMortarFodder=GetUnitsInRectAll(gg_rct_SkeletonsMortarFodderStart)
endfunction

//===========================================================================
function InitTrig_SetupSkeletonsMortarFodder takes nothing returns nothing
    set gg_trg_SetupSkeletonsMortarFodder=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupSkeletonsMortarFodder, function Trig_SetupSkeletonsMortarFodder_Actions)
endfunction

//===========================================================================
// Trigger: SetupPriestGroup
//===========================================================================
function Trig_SetupPriestGroup_Actions takes nothing returns nothing
    set udg_Priests=GetUnitsInRectAll(gg_rct_Priests)
endfunction

//===========================================================================
function InitTrig_SetupPriestGroup takes nothing returns nothing
    set gg_trg_SetupPriestGroup=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupPriestGroup, function Trig_SetupPriestGroup_Actions)
endfunction

//===========================================================================
// Trigger: SetupVillagerKidsJumping
//===========================================================================
function Trig_SetupVillagerKidsJumping_Actions takes nothing returns nothing
    call SetUnitAnimationWithRarity(gg_unit_nvlk_0026, "stand 2", RARITY_FREQUENT)
    call SetUnitAnimationWithRarity(gg_unit_nvlk_0025, "stand 2", RARITY_RARE)
endfunction

//===========================================================================
function InitTrig_SetupVillagerKidsJumping takes nothing returns nothing
    set gg_trg_SetupVillagerKidsJumping=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupVillagerKidsJumping, function Trig_SetupVillagerKidsJumping_Actions)
endfunction

//===========================================================================
// Trigger: SetupCreeps
//===========================================================================
function Trig_SetupCreeps_Func001002 takes nothing returns nothing
    call UnitSetCanSleepBJ(GetEnumUnit(), false)
endfunction

function Trig_SetupCreeps_Actions takes nothing returns nothing
    call ForGroupBJ(GetUnitsInRectOfPlayer(GetPlayableMapRect(), Player(PLAYER_NEUTRAL_AGGRESSIVE)), function Trig_SetupCreeps_Func001002)
endfunction

//===========================================================================
function InitTrig_SetupCreeps takes nothing returns nothing
    set gg_trg_SetupCreeps=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupCreeps, function Trig_SetupCreeps_Actions)
endfunction

//===========================================================================
// Trigger: SetupVillagerVision
//===========================================================================
function Trig_SetupVillagerVision_Actions takes nothing returns nothing
    call SetPlayerAllianceBJ(Player(1), ALLIANCE_SHARED_VISION, true, Player(2))
endfunction

//===========================================================================
function InitTrig_SetupVillagerVision takes nothing returns nothing
    set gg_trg_SetupVillagerVision=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupVillagerVision, function Trig_SetupVillagerVision_Actions)
endfunction

//===========================================================================
// Trigger: SetupScoreScreen
//===========================================================================
function Trig_SetupScoreScreen_Actions takes nothing returns nothing
    call SetPlayerOnScoreScreenBJ(false, Player(2))
    call SetPlayerOnScoreScreenBJ(false, Player(3))
    call SetPlayerOnScoreScreenBJ(false, Player(9))
endfunction

//===========================================================================
function InitTrig_SetupScoreScreen takes nothing returns nothing
    set gg_trg_SetupScoreScreen=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupScoreScreen, function Trig_SetupScoreScreen_Actions)
endfunction

//===========================================================================
// Trigger: Bubble
//===========================================================================
function Trig_Bubble_Actions takes nothing returns nothing
    // Stacie
    call AddSpecialEffectTargetUnitBJ("overhead", gg_unit_nC00_0093, "Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl")
    set udg_StacieBang=GetLastCreatedEffectBJ()
    // Achilles Bridge out
    call AddSpecialEffectTargetUnitBJ("overhead", gg_unit_nC02_0039, "Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl")
    set udg_AchillesBang=GetLastCreatedEffectBJ()
    // Alric Fountain
    call AddSpecialEffectTargetUnitBJ("overhead", gg_unit_nC03_0092, "Abilities\\Spells\\Other\\TalkToMe\\TalkToMe.mdl")
    set udg_AlricBang=GetLastCreatedEffectBJ()
endfunction

//===========================================================================
function InitTrig_Bubble takes nothing returns nothing
    set gg_trg_Bubble=CreateTrigger()
    call TriggerAddAction(gg_trg_Bubble, function Trig_Bubble_Actions)
endfunction

//===========================================================================
// Trigger: VillagerConcernedDead
//===========================================================================
function Trig_VillagerConcernedDead_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_VillagerConcernedMessage)
    call DestroyEffectBJ(udg_StacieBang)
endfunction

//===========================================================================
function InitTrig_VillagerConcernedDead takes nothing returns nothing
    set gg_trg_VillagerConcernedDead=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_VillagerConcernedDead, gg_unit_nC00_0093, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_VillagerConcernedDead, function Trig_VillagerConcernedDead_Actions)
endfunction

//===========================================================================
// Trigger: VillagerBridgeOutDead
//===========================================================================
function Trig_VillagerBridgeOutDead_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_VillagerBridgeOutMessage)
    call DestroyEffectBJ(udg_AchillesBang)
endfunction

//===========================================================================
function InitTrig_VillagerBridgeOutDead takes nothing returns nothing
    set gg_trg_VillagerBridgeOutDead=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_VillagerBridgeOutDead, gg_unit_nC02_0039, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_VillagerBridgeOutDead, function Trig_VillagerBridgeOutDead_Actions)
endfunction

//===========================================================================
// Trigger: VillagerFountainQuest
//===========================================================================
function Trig_VillagerFountainQuest_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_VillagerFountainQuest)
    call DestroyEffectBJ(udg_AlricBang)
endfunction

//===========================================================================
function InitTrig_VillagerFountainQuest takes nothing returns nothing
    set gg_trg_VillagerFountainQuest=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_VillagerFountainQuest, gg_unit_nC03_0092, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_VillagerFountainQuest, function Trig_VillagerFountainQuest_Actions)
endfunction

//===========================================================================
// Trigger: SetupQuests
//===========================================================================
function Trig_SetupQuests_Actions takes nothing returns nothing
    // Main Investigate Villages Quest
    call CreateQuestBJ(bj_QUESTTYPE_REQ_UNDISCOVERED, "TRIGSTR_018", "TRIGSTR_019", "ReplaceableTextures\\CommandButtons\\BTNfarm.tga")
    set udg_QuestInvestigateVillages=GetLastCreatedQuestBJ()
    call CreateQuestItemBJ(udg_QuestInvestigateVillages, "TRIGSTR_081")
    set udg_QuestInvestigateReq=GetLastCreatedQuestItemBJ()
    call CreateQuestItemBJ(udg_QuestInvestigateVillages, "TRIGSTR_537")
    call CreateQuestItemBJ(udg_QuestInvestigateVillages, "TRIGSTR_538")
    // Main Granary Quest
    call CreateQuestBJ(bj_QUESTTYPE_REQ_UNDISCOVERED, "TRIGSTR_013", "TRIGSTR_014", "ReplaceableTextures\\CommandButtons\\BTNfarm.tga")
    set udg_QuestDestroyGranary=GetLastCreatedQuestBJ()
    call CreateQuestItemBJ(udg_QuestDestroyGranary, "TRIGSTR_109")
    set udg_GranaryReq=GetLastCreatedQuestItemBJ()
    // Side Fountain of Health Quest
    call CreateQuestBJ(bj_QUESTTYPE_OPT_UNDISCOVERED, "TRIGSTR_016", "TRIGSTR_017", "ReplaceableTextures\\CommandButtons\\BTNFountainoflife.tga")
    set udg_QuestFountain=GetLastCreatedQuestBJ()
    call CreateQuestItemBJ(udg_QuestFountain, "TRIGSTR_063")
    set udg_QuestFountainReq=GetLastCreatedQuestItemBJ()
endfunction

//===========================================================================
function InitTrig_SetupQuests takes nothing returns nothing
    set gg_trg_SetupQuests=CreateTrigger()
    call TriggerAddAction(gg_trg_SetupQuests, function Trig_SetupQuests_Actions)
endfunction

//===========================================================================
// Trigger: Next Level Run
//===========================================================================
function Trig_Next_Level_Run_Actions takes nothing returns nothing
    // Run next level
    call SetNextLevelBJ("Maps\\AP_Campaign\\Human04.w3x")
    call CustomVictoryBJ(Player(1), true, true)
endfunction

//===========================================================================
function InitTrig_Next_Level_Run takes nothing returns nothing
    set gg_trg_Next_Level_Run=CreateTrigger()
    call TriggerAddAction(gg_trg_Next_Level_Run, function Trig_Next_Level_Run_Actions)
endfunction

//===========================================================================
// Trigger: Victory Cheat
//===========================================================================
function Trig_Victory_Cheat_Actions takes nothing returns nothing
    call ConditionalTriggerExecute(gg_trg_Next_Level_Run)
endfunction

//===========================================================================
function InitTrig_Victory_Cheat takes nothing returns nothing
    set gg_trg_Victory_Cheat=CreateTrigger()
    call TriggerRegisterPlayerEventVictory(gg_trg_Victory_Cheat, Player(1))
    call TriggerAddAction(gg_trg_Victory_Cheat, function Trig_Victory_Cheat_Actions)
endfunction

//===========================================================================
// Trigger: DefeatCheat
//===========================================================================
function Trig_DefeatCheat_Actions takes nothing returns nothing
    call CustomDefeatBJ(Player(1), "TRIGSTR_012")
endfunction

//===========================================================================
function InitTrig_DefeatCheat takes nothing returns nothing
    set gg_trg_DefeatCheat=CreateTrigger()
    call TriggerRegisterPlayerEventDefeat(gg_trg_DefeatCheat, Player(1))
    call TriggerAddAction(gg_trg_DefeatCheat, function Trig_DefeatCheat_Actions)
endfunction

//===========================================================================
// Trigger: OpeningCancelled
//
// Activated from 'MapInitialization'
//===========================================================================
function Trig_OpeningCancelled_Func012002 takes nothing returns nothing
    call SetUnitFacingToFaceLocTimed(GetEnumUnit(), GetRectCenter(gg_rct_FacingPoint), 0.00)
endfunction

function Trig_OpeningCancelled_Func020002 takes nothing returns nothing
    call KillUnit(GetEnumUnit())
endfunction

function Trig_OpeningCancelled_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_OpeningCancelled=true
    // ******************
    call StopSoundBJ(GetLastPlayedSound(), false)
    call PauseUnitBJ(false, udg_Jaina)
    call PauseUnitBJ(false, gg_unit_nogr_0009)
    call SetUnitPositionLoc(udg_Jaina, GetRectCenter(gg_rct_JainaMove02))
    call SetUnitPositionLoc(udg_Arthas, GetRectCenter(gg_rct_ArthasMove02))
    call SetUnitPositionLoc(udg_Captain, GetRectCenter(gg_rct_Captain1b))
    call SetUnitPositionLoc(gg_unit_hfoo_0003, GetRectCenter(gg_rct_Footman1b))
    call SetUnitPositionLoc(gg_unit_hfoo_0004, GetRectCenter(gg_rct_Footman2b))
    call ForGroupBJ(udg_StartingParty, function Trig_OpeningCancelled_Func012002)
    call SetUnitInvulnerable(udg_Jaina, false)
    call SetUnitLifePercentBJ(udg_Jaina, 100.00)
    call SetUnitManaPercentBJ(udg_Jaina, 100)
    call RemoveUnit(gg_unit_nogr_0008)
    call SetUnitInvulnerable(gg_unit_nogr_0009, false)
    call SetUnitPositionLoc(gg_unit_nogr_0009, GetRectCenter(gg_rct_OgreHide))
    call SetUnitLifePercentBJ(gg_unit_nogr_0009, 10.00)
    call ForGroupBJ(GetUnitsOfTypeIdAll('hwat'), function Trig_OpeningCancelled_Func020002)
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(1), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_UNALLIED)
    call SetUnitOwner(udg_Jaina, Player(1), true)
    call SuspendHeroXPBJ(true, udg_Jaina)
    call ResetUnitLookAt(udg_Arthas)
    call CinematicModeBJ(false, GetPlayersAll())
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 0.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call UseTimeOfDayBJ(true)
    call TriggerSleepAction(0.20)
    call KillUnit(udg_WaterElemental)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 2.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call SelectUnitSingle(udg_Arthas)
    call ResetToGameCameraForPlayer(Player(1), 0.00)
    call PanCameraToTimedLocForPlayer(Player(1), GetRectCenter(gg_rct_ResetCam), 0)
    call SetSkyModel(null)
    call ResetTerrainFogBJ()
    // ******************
    call ConditionalTriggerExecute(gg_trg_SetupQuests)
    call TriggerSleepAction(2.00)
    call QuestSetDiscoveredBJ(udg_QuestInvestigateVillages, true)
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_DISCOVERED, "TRIGSTR_078")
    call TriggerSleepAction(10.00)
    call ConditionalTriggerExecute(gg_trg_Ogre01)
    call QueuedTriggerAddBJ(gg_trg_Water_Elemental_Hint_Queued, true)
endfunction

//===========================================================================
function InitTrig_OpeningCancelled takes nothing returns nothing
    set gg_trg_OpeningCancelled=CreateTrigger()
    call DisableTrigger(gg_trg_OpeningCancelled)
    call TriggerRegisterPlayerEventEndCinematic(gg_trg_OpeningCancelled, Player(1))
    call TriggerAddAction(gg_trg_OpeningCancelled, function Trig_OpeningCancelled_Actions)
endfunction

//===========================================================================
// Trigger: Opening01
//
// Default melee game initialization for all players
//===========================================================================
function Trig_Opening01_Func029001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func034001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func038001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func041001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func044001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func046001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func049001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func054001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func059001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func064001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func067001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func073001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func077001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func081001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func083001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func088001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Func091001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening01_Actions takes nothing returns nothing
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 0.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call SetStackedSoundBJ(true, gg_snd_WaterStreamLoop1, gg_rct_StreamLoop01)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop01)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop02)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop03)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop04)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop05)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop06)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop07)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop08)
    call SetStackedSoundBJ(true, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop09)
    call SetTerrainFogExBJ(0, 1000, 8000, 0, 20.00, 90.00, 20.00)
    call PauseUnitBJ(true, udg_Jaina)
    call PauseUnitBJ(true, gg_unit_nogr_0008)
    call PauseUnitBJ(true, gg_unit_nogr_0009)
    call SetPlayerAllianceBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), ALLIANCE_PASSIVE, true, Player(3))
    call SetPlayerAllianceBJ(Player(3), ALLIANCE_PASSIVE, true, Player(PLAYER_NEUTRAL_AGGRESSIVE))
    call UseTimeOfDayBJ(false)
    call CinematicModeBJ(true, GetPlayersAll())
    // Music
    call ClearMapMusicBJ()
    call TriggerSleepAction(0.01)
    call PlayThematicMusicBJ("Sound\\Music\\mp3Music\\Comradeship.mp3")
    call SetMapMusicIndexedBJ("music", 2)
    // ***********************
    // NOW SKIPPABLE
    call EnableTrigger(gg_trg_OpeningCancelled)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening01_Func029001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Camera_001, Player(1), 0.00)
    call CameraSetupApplyForPlayer(true, gg_cam_Camera_002, Player(1), 13.00)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 2, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening01_Func034001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Captain, "move", GetRectCenter(gg_rct_CaptainMoveStart))
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, udg_Captain, 0.50)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening01_Func038001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Captain, "TRIGSTR_074", gg_snd_H03Captain01, "TRIGSTR_075", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening01_Func041001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitLookAt(udg_Arthas, "bone_head", udg_Captain, 0, 0, 80.00)
    call TriggerSleepAction(4.40)
    if ( Trig_Opening01_Func044001() ) then
        return
    else
        call DoNothing()
    endif
    call WaitForSoundBJ(gg_snd_H03Captain01, 0)
    if ( Trig_Opening01_Func046001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_072", gg_snd_H03Arthas02, "TRIGSTR_073", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Arthas02, 0)
    if ( Trig_Opening01_Func049001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetSmoothingFactorBJ(0.00)
    call VolumeGroupResetBJ()
    call CameraSetupApplyForPlayer(true, gg_cam_Camera_003, Player(1), 0.00)
    call TriggerSleepAction(0.10)
    if ( Trig_Opening01_Func054001() ) then
        return
    else
        call DoNothing()
    endif
    call PauseUnitBJ(false, udg_Jaina)
    call PauseUnitBJ(false, gg_unit_nogr_0008)
    call PauseUnitBJ(false, gg_unit_nogr_0009)
    call TriggerSleepAction(0.10)
    if ( Trig_Opening01_Func059001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Jaina, "move", GetRectCenter(gg_rct_StartJaina))
    call IssuePointOrderLocBJ(gg_unit_nogr_0008, "attack", GetRectCenter(gg_rct_Ogre_Attack_Move))
    call IssuePointOrderLocBJ(gg_unit_nogr_0009, "attack", GetRectCenter(gg_rct_Ogre_Attack_Move))
    call TriggerSleepAction(1.80)
    if ( Trig_Opening01_Func064001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitLookAt(udg_Arthas, "bone_head", udg_Jaina, 0, 0, 80.00)
    call TriggerSleepAction(0.50)
    if ( Trig_Opening01_Func067001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, udg_Jaina, 0.15)
    call SetUnitFacingToFaceUnitTimed(udg_Captain, udg_Jaina, 0.15)
    call SetUnitAnimation(gg_unit_hfoo_0004, "stand")
    call SetUnitAnimation(gg_unit_hfoo_0003, "stand")
    call TriggerSleepAction(0.50)
    if ( Trig_Opening01_Func073001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Captain, "move", GetRectCenter(gg_rct_StartCaptain))
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Captain, "TRIGSTR_066", gg_snd_H03Captain03, "TRIGSTR_067", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Captain03, 0)
    if ( Trig_Opening01_Func077001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitAnimation(udg_Arthas, "stand")
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_057", gg_snd_H03Arthas04, "TRIGSTR_065", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening01_Func081001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(0.18)
    if ( Trig_Opening01_Func083001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetSmoothingFactorBJ(0.00)
    call CameraSetupApplyForPlayer(true, gg_cam_OgreBattle01, Player(1), 0.00)
    call SetUnitAnimation(udg_Captain, "stand")
    call TriggerSleepAction(0.50)
    if ( Trig_Opening01_Func088001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(2.00)
    call WaitForSoundBJ(gg_snd_H03Arthas04, 0)
    if ( Trig_Opening01_Func091001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Arthas, "move", GetRectCenter(gg_rct_StartArthas))
    // ***********************
    call TriggerExecute(gg_trg_Opening02)
endfunction

//===========================================================================
function InitTrig_Opening01 takes nothing returns nothing
    set gg_trg_Opening01=CreateTrigger()
    call TriggerAddAction(gg_trg_Opening01, function Trig_Opening01_Actions)
endfunction

//===========================================================================
// Trigger: Opening02
//===========================================================================
function Trig_Opening02_Conditions takes nothing returns boolean
    if ( not ( udg_OpeningCancelled == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Opening02_Func004001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening02_Actions takes nothing returns nothing
    call SetUnitLifeBJ(gg_unit_nogr_0008, 1.00)
    call TriggerSleepAction(2.00)
    if ( Trig_Opening02_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(gg_unit_hfoo_0003, "move", GetRectCenter(gg_rct_Footman02))
    call IssuePointOrderLocBJ(gg_unit_hfoo_0004, "move", GetRectCenter(gg_rct_Footman01))
    // ***********************
    call TriggerExecute(gg_trg_Opening03)
endfunction

//===========================================================================
function InitTrig_Opening02 takes nothing returns nothing
    set gg_trg_Opening02=CreateTrigger()
    call TriggerAddCondition(gg_trg_Opening02, Condition(function Trig_Opening02_Conditions))
    call TriggerAddAction(gg_trg_Opening02, function Trig_Opening02_Actions)
endfunction

//===========================================================================
// Trigger: Opening03
//===========================================================================
function Trig_Opening03_Conditions takes nothing returns boolean
    if ( not ( udg_OpeningCancelled == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Opening03_Func002001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func007001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func013001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func018001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func021001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func023001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func028001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func032001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func036001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func040001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func043001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func049001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Func052001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening03_Actions takes nothing returns nothing
    call TriggerSleepAction(1.00)
    if ( Trig_Opening03_Func002001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetSmoothingFactorBJ(0.00)
    call CameraSetupApplyForPlayer(true, gg_cam_Camera_005, Player(1), 0.00)
    call TriggerSleepAction(2.00)
    if ( Trig_Opening03_Func007001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Arthas, "move", GetRectCenter(gg_rct_ArthasPost))
    call IssuePointOrderLocBJ(udg_Captain, "move", GetRectCenter(gg_rct_CaptainPost))
    call SetUnitManaBJ(udg_Jaina, GetUnitStateSwap(UNIT_STATE_MAX_MANA, udg_Jaina))
    call SetUnitLifePercentBJ(udg_Jaina, 100.00)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening03_Func013001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, udg_Jaina, 0.10)
    call IssuePointOrderLocBJ(udg_Jaina, "move", GetRectCenter(gg_rct_JainaPost))
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_084", gg_snd_H03Arthas05, "TRIGSTR_087", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening03_Func018001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_WaterElemental, "move", GetRectCenter(gg_rct_WaterElementalPost))
    call TriggerSleepAction(2.00)
    if ( Trig_Opening03_Func021001() ) then
        return
    else
        call DoNothing()
    endif
    call WaitForSoundBJ(gg_snd_H03Arthas05, 0.00)
    if ( Trig_Opening03_Func023001() ) then
        return
    else
        call DoNothing()
    endif
    call ResetUnitLookAt(udg_Arthas)
    call CameraSetupApplyForPlayer(true, gg_cam_Arthas, Player(1), 0.00)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_090", gg_snd_H03Arthas06, "TRIGSTR_091", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Arthas06, 0)
    if ( Trig_Opening03_Func028001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Jaina, Player(1), 0.00)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_092", gg_snd_H03Jaina07, "TRIGSTR_093", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Jaina07, 0)
    if ( Trig_Opening03_Func032001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Arthas, Player(1), 0.00)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_094", gg_snd_H03Arthas08, "TRIGSTR_095", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Arthas08, 0)
    if ( Trig_Opening03_Func036001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Jaina, Player(1), 0.00)
    call CameraSetupApplyForPlayer(true, gg_cam_GroupShot, Player(1), 6.00)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening03_Func040001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(udg_Jaina, udg_WaterElemental, 0.00)
    call TriggerSleepAction(0.50)
    if ( Trig_Opening03_Func043001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitAnimation(udg_Jaina, "spell")
    call AttachSoundToUnitBJ(gg_snd_DivineShield, udg_Jaina)
    call SetSoundVolumeBJ(gg_snd_DivineShield, 40.00)
    call PlaySoundBJ(gg_snd_DivineShield)
    call TriggerSleepAction(2.00)
    if ( Trig_Opening03_Func049001() ) then
        return
    else
        call DoNothing()
    endif
    call KillUnit(udg_WaterElemental)
    call TriggerSleepAction(1.00)
    if ( Trig_Opening03_Func052001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    // ***********************
    call TriggerExecute(gg_trg_Opening04)
endfunction

//===========================================================================
function InitTrig_Opening03 takes nothing returns nothing
    set gg_trg_Opening03=CreateTrigger()
    call TriggerAddCondition(gg_trg_Opening03, Condition(function Trig_Opening03_Conditions))
    call TriggerAddAction(gg_trg_Opening03, function Trig_Opening03_Actions)
endfunction

//===========================================================================
// Trigger: Opening04
//===========================================================================
function Trig_Opening04_Conditions takes nothing returns boolean
    if ( not ( udg_OpeningCancelled == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Opening04_Func005001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func008001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func013001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func015001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func018001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func020001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func022001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Func030001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_Opening04_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(udg_Jaina, "move", GetRectCenter(gg_rct_JainaMove01))
    call IssuePointOrderLocBJ(udg_Arthas, "move", GetRectCenter(gg_rct_ArthasMove01))
    call TriggerSleepAction(1.50)
    if ( Trig_Opening04_Func005001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Formation, Player(1), 0.00)
    call TriggerSleepAction(0.50)
    if ( Trig_Opening04_Func008001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Captain, "move", GetRectCenter(gg_rct_Captain1a))
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_096", gg_snd_H03Jaina09, "TRIGSTR_097", bj_TIMETYPE_ADD, 0.00, false)
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, udg_Jaina, 0.15)
    call TriggerSleepAction(1.50)
    if ( Trig_Opening04_Func013001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(1.00)
    if ( Trig_Opening04_Func015001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(udg_Captain, udg_Jaina, 0.15)
    call TriggerSleepAction(2.00)
    if ( Trig_Opening04_Func018001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(0.50)
    if ( Trig_Opening04_Func020001() ) then
        return
    else
        call DoNothing()
    endif
    call WaitForSoundBJ(gg_snd_H03Jaina09, 0)
    if ( Trig_Opening04_Func022001() ) then
        return
    else
        call DoNothing()
    endif
    call PanCameraToTimedLocForPlayer(Player(1), GetRectCenter(gg_rct_ArthasMove02), 6.00)
    call IssuePointOrderLocBJ(udg_Jaina, "move", GetRectCenter(gg_rct_JainaMove02))
    call IssuePointOrderLocBJ(udg_Arthas, "move", GetRectCenter(gg_rct_ArthasMove02))
    call IssuePointOrderLocBJ(udg_Captain, "move", GetRectCenter(gg_rct_Captain1b))
    call IssuePointOrderLocBJ(gg_unit_hfoo_0004, "move", GetRectCenter(gg_rct_Footman1b))
    call IssuePointOrderLocBJ(gg_unit_hfoo_0003, "move", GetRectCenter(gg_rct_Footman2b))
    call TriggerSleepAction(3.00)
    if ( Trig_Opening04_Func030001() ) then
        return
    else
        call DoNothing()
    endif
    // NO LONGER SKIPPABLE
    call DisableTrigger(gg_trg_OpeningCancelled)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 1.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(1.05)
    call ResetToGameCameraForPlayer(Player(1), 0.00)
    call TriggerSleepAction(0.10)
    call SetUnitOwner(udg_Jaina, Player(1), true)
    call CinematicModeBJ(false, GetPlayersAll())
    call SetUnitInvulnerable(udg_Jaina, false)
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(1), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_UNALLIED)
    call SetUserControlForceOn(GetPlayersAll())
    call SuspendHeroXPBJ(true, udg_Jaina)
    call SetSkyModel(null)
    call ResetTerrainFogBJ()
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 1.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call UseTimeOfDayBJ(true)
    // ***********************
    call SelectUnitSingle(udg_Arthas)
    set udg_OpeningCancelled=true
    call ConditionalTriggerExecute(gg_trg_SetupQuests)
    call TriggerSleepAction(2.00)
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_DISCOVERED, "TRIGSTR_076")
    call QuestSetDiscoveredBJ(udg_QuestInvestigateVillages, true)
    call TriggerSleepAction(10.00)
    call ConditionalTriggerExecute(gg_trg_Ogre01)
    call QueuedTriggerAddBJ(gg_trg_Water_Elemental_Hint_Queued, true)
endfunction

//===========================================================================
function InitTrig_Opening04 takes nothing returns nothing
    set gg_trg_Opening04=CreateTrigger()
    call TriggerAddCondition(gg_trg_Opening04, Condition(function Trig_Opening04_Conditions))
    call TriggerAddAction(gg_trg_Opening04, function Trig_Opening04_Actions)
endfunction

//===========================================================================
// Trigger: OgreRun
//
// Disabled the .01 second wait because it was preventing the ogre from running away via the Unit order 'Move To' trigger.
//===========================================================================
function Trig_OgreRun_Actions takes nothing returns nothing
    call SetPlayerAllianceBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), ALLIANCE_PASSIVE, true, Player(3))
    call SetPlayerAllianceBJ(Player(3), ALLIANCE_PASSIVE, true, Player(PLAYER_NEUTRAL_AGGRESSIVE))
    call TriggerSleepAction(0.50)
    call IssuePointOrderLocBJ(gg_unit_nogr_0009, "move", GetRectCenter(gg_rct_OgreHide))
    call SetUnitInvulnerable(gg_unit_nogr_0009, true)
    call TriggerSleepAction(5.00)
    call SetUnitInvulnerable(gg_unit_nogr_0009, false)
    call TriggerSleepAction(0.10)
    call SetUnitLifePercentBJ(gg_unit_nogr_0009, 10.00)
    call TriggerSleepAction(0.10)
    call SetUnitPositionLoc(gg_unit_nogr_0009, GetRectCenter(gg_rct_OgreHide))
    call TriggerSleepAction(0.10)
    call SetUnitFacingToFaceLocTimed(gg_unit_nogr_0009, GetRectCenter(gg_rct_OgreFace), 0)
endfunction

//===========================================================================
function InitTrig_OgreRun takes nothing returns nothing
    set gg_trg_OgreRun=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_OgreRun, gg_unit_nogr_0008, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_OgreRun, function Trig_OgreRun_Actions)
endfunction

//===========================================================================
// Trigger: JainaKillOgre
//===========================================================================
function Trig_JainaKillOgre_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Jaina ) ) then
        return false
    endif
    return true
endfunction

function Trig_JainaKillOgre_Func004001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_JainaKillOgre_Func008001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_JainaKillOgre_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(udg_Jaina, "stop")
    call TriggerSleepAction(0.05)
    if ( Trig_JainaKillOgre_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitInvulnerable(udg_Jaina, true)
    call SetUnitFacingToFaceUnitTimed(udg_Jaina, gg_unit_nogr_0008, 0.15)
    call TriggerSleepAction(0.25)
    if ( Trig_JainaKillOgre_Func008001() ) then
        return
    else
        call DoNothing()
    endif
    set udg_WaterElemental=CreateUnit(Player(3), 'hwt2', GetUnitX(udg_Jaina) + 180.0, GetUnitY(udg_Jaina) - 60.0, 45.0)
    call SetUnitAnimation(udg_WaterElemental, "birth")
    call SetPlayerAllianceBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), ALLIANCE_PASSIVE, false, Player(3))
    call SetPlayerAllianceBJ(Player(3), ALLIANCE_PASSIVE, false, Player(PLAYER_NEUTRAL_AGGRESSIVE))
    call IssueTargetOrderBJ(udg_WaterElemental, "attack", gg_unit_nogr_0008)
    call IssueTargetOrderBJ(udg_Jaina, "attack", gg_unit_nogr_0008)
endfunction

//===========================================================================
function InitTrig_JainaKillOgre takes nothing returns nothing
    set gg_trg_JainaKillOgre=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_JainaKillOgre, gg_rct_StartJaina)
    call TriggerAddCondition(gg_trg_JainaKillOgre, Condition(function Trig_JainaKillOgre_Conditions))
    call TriggerAddAction(gg_trg_JainaKillOgre, function Trig_JainaKillOgre_Actions)
endfunction

//===========================================================================
// Trigger: JainaPost
//===========================================================================
function Trig_JainaPost_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Jaina ) ) then
        return false
    endif
    return true
endfunction

function Trig_JainaPost_Func004001 takes nothing returns boolean
    return ( udg_OpeningCancelled == true )
endfunction

function Trig_JainaPost_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(udg_Jaina, "stop")
    call TriggerSleepAction(0.05)
    if ( Trig_JainaPost_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(udg_Jaina, udg_Arthas, 0.10)
endfunction

//===========================================================================
function InitTrig_JainaPost takes nothing returns nothing
    set gg_trg_JainaPost=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_JainaPost, gg_rct_JainaPost)
    call TriggerAddCondition(gg_trg_JainaPost, Condition(function Trig_JainaPost_Conditions))
    call TriggerAddAction(gg_trg_JainaPost, function Trig_JainaPost_Actions)
endfunction

//===========================================================================
// Trigger: Water Elemental Hint Queued
//===========================================================================
function Trig_Water_Elemental_Hint_Queued_Actions takes nothing returns nothing
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_HINT, "TRIGSTR_675")
    call TriggerSleepAction(bj_QUEUE_DELAY_HINT)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Water_Elemental_Hint_Queued takes nothing returns nothing
    set gg_trg_Water_Elemental_Hint_Queued=CreateTrigger()
    call TriggerAddAction(gg_trg_Water_Elemental_Hint_Queued, function Trig_Water_Elemental_Hint_Queued_Actions)
endfunction

//===========================================================================
// Trigger: GrainCinematicCancelled
//===========================================================================
function Trig_GrainCinematicCancelled_Func021002 takes nothing returns nothing
    call ShowUnitShow(GetEnumUnit())
endfunction

function Trig_GrainCinematicCancelled_Func022002 takes nothing returns nothing
    call ShowUnitShow(GetEnumUnit())
endfunction

function Trig_GrainCinematicCancelled_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call DisableTrigger(gg_trg_JainaFaceGrainery)
    call DisableTrigger(gg_trg_ArthasFaceGrainery)
    call DisableTrigger(GetTriggeringTrigger())
    set udg_Grain01Cancelled=true
    call StopSoundBJ(GetLastPlayedSound(), true)
    call StopSoundBJ(gg_snd_LordaeronSummerFliesLoop1, true)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 0.50, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(0.50)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_UNALLIED)
    call SetUnitInvulnerable(gg_unit_ngni_0080, false)
    call DestroyFogModifier(udg_GrainCinVis)
    call UseTimeOfDayBJ(true)
    call CinematicModeBJ(false, GetPlayersAll())
    call ResetToGameCameraForPlayer(Player(1), 0.00)
    call PanCameraToTimedLocForPlayer(Player(1), udg_PositionCamera, 0)
    call SetUnitPositionLoc(udg_Arthas, udg_PositionArthas)
    call SetUnitPositionLoc(udg_Jaina, udg_PositionJaina)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(6)), function Trig_GrainCinematicCancelled_Func021002)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(1)), function Trig_GrainCinematicCancelled_Func022002)
    call PauseAllUnitsBJ(false)
    call SelectGroupBJ(udg_SelectionGroup)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 1.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call QueuedTriggerRemoveBJ(gg_trg_Grain01_Queue)
endfunction

//===========================================================================
function InitTrig_GrainCinematicCancelled takes nothing returns nothing
    set gg_trg_GrainCinematicCancelled=CreateTrigger()
    call DisableTrigger(gg_trg_GrainCinematicCancelled)
    call TriggerRegisterPlayerEventEndCinematic(gg_trg_GrainCinematicCancelled, Player(1))
    call TriggerAddAction(gg_trg_GrainCinematicCancelled, function Trig_GrainCinematicCancelled_Actions)
endfunction

//===========================================================================
// Trigger: Grain01
//===========================================================================
function Trig_Grain01_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( IsUnitType(GetEnteringUnit(), UNIT_TYPE_HERO) == true ) ) then
        return false
    endif
    if ( not ( udg_Grain01Cancelled == false ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Grain01_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerAddBJ(gg_trg_Grain01_Queue, true)
endfunction

//===========================================================================
function InitTrig_Grain01 takes nothing returns nothing
    set gg_trg_Grain01=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Grain01, gg_rct_GrainArea)
    call TriggerAddCondition(gg_trg_Grain01, Condition(function Trig_Grain01_Conditions))
    call TriggerAddAction(gg_trg_Grain01, function Trig_Grain01_Actions)
endfunction

//===========================================================================
// Trigger: Grain01 Queue
//===========================================================================
function Trig_Grain01_Queue_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Grain01_Queue_Func011002 takes nothing returns nothing
    call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_ALL, GetEnumUnit())
endfunction

function Trig_Grain01_Queue_Func025001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func026002 takes nothing returns nothing
    call ShowUnitHide(GetEnumUnit())
endfunction

function Trig_Grain01_Queue_Func027002 takes nothing returns nothing
    call ShowUnitHide(GetEnumUnit())
endfunction

function Trig_Grain01_Queue_Func041001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func045001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func049001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func051001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func053001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func056001 takes nothing returns boolean
    return ( udg_Grain01Cancelled == true )
endfunction

function Trig_Grain01_Queue_Func074002 takes nothing returns nothing
    call ShowUnitShow(GetEnumUnit())
endfunction

function Trig_Grain01_Queue_Func075002 takes nothing returns nothing
    call ShowUnitShow(GetEnumUnit())
endfunction

function Trig_Grain01_Queue_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_PositionArthas=GetUnitLoc(udg_Arthas)
    set udg_PositionJaina=GetUnitLoc(udg_Jaina)
    set udg_PositionCamera=CameraSetupGetDestPositionLoc(GetCurrentCameraSetup())
    set udg_SelectionGroup=GetUnitsSelectedAll(Player(1))
    call ClearSelection()
    // Music
    call PlayThematicMusicBJ("Sound\\Music\\mp3Music\\DarkAgents.mp3")
    // ***********************
    call ForGroupBJ(GetUnitsInRectAll(GetPlayableMapRect()), function Trig_Grain01_Queue_Func011002)
    call PauseAllUnitsBJ(true)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(3), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_ALLIED)
    call UseTimeOfDayBJ(false)
    call CinematicModeBJ(true, GetPlayersAll())
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_GrainArea), 1024.00)
    set udg_GrainCinVis=GetLastCreatedFogModifier()
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 0.50, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    // NOW SKIPPABLE
    call EnableTrigger(gg_trg_GrainCinematicCancelled)
    call TriggerSleepAction(1.00)
    if ( Trig_Grain01_Queue_Func025001() ) then
        return
    else
        call DoNothing()
    endif
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(6)), function Trig_Grain01_Queue_Func026002)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(1)), function Trig_Grain01_Queue_Func027002)
    call ShowUnitShow(udg_Arthas)
    call ShowUnitShow(udg_Jaina)
    call PauseUnitBJ(false, udg_Arthas)
    call PauseUnitBJ(false, udg_Jaina)
    call SetUnitPositionLoc(udg_Arthas, GetRectCenter(gg_rct_ArthasGranaryTeleport))
    call SetUnitPositionLoc(udg_Jaina, GetRectCenter(gg_rct_JainaGranaryTeleport))
    call CameraSetupApplyForPlayer(true, gg_cam_Granary02, Player(1), 0.00)
    call CameraSetupApplyForPlayer(true, gg_cam_Granary01, Player(1), ( GetSoundDurationBJ(gg_snd_H03Jaina18) + ( GetSoundDurationBJ(gg_snd_H03Arthas19) + GetSoundDurationBJ(gg_snd_H03Jaina20) ) ))
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 0.50, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call SetSoundPositionLocBJ(gg_snd_LordaeronSummerFliesLoop1, GetRectCenter(gg_rct_FlySound), 0)
    call SetSoundVolumeBJ(gg_snd_LordaeronSummerFliesLoop1, 80.00)
    call PlaySoundBJ(gg_snd_LordaeronSummerFliesLoop1)
    call TriggerSleepAction(0.10)
    if ( Trig_Grain01_Queue_Func041001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Arthas, "move", GetRectCenter(gg_rct_ArthasGranaryPost))
    call IssuePointOrderLocBJ(udg_Jaina, "move", GetRectCenter(gg_rct_JainaGranaryPost))
    call TriggerSleepAction(2.00)
    if ( Trig_Grain01_Queue_Func045001() ) then
        return
    else
        call DoNothing()
    endif
    // ***********************
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_302", gg_snd_H03Jaina18, "TRIGSTR_303", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(0.50)
    if ( Trig_Grain01_Queue_Func049001() ) then
        return
    else
        call DoNothing()
    endif
    call WaitForSoundBJ(gg_snd_H03Jaina18, 0)
    if ( Trig_Grain01_Queue_Func051001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_304", gg_snd_H03Arthas19, "TRIGSTR_305", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_Grain01_Queue_Func053001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_306", gg_snd_H03Jaina20, "TRIGSTR_307", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Jaina20, 0)
    if ( Trig_Grain01_Queue_Func056001() ) then
        return
    else
        call DoNothing()
    endif
    // NO LONGER SKIPPABLE
    call DisableTrigger(gg_trg_GrainCinematicCancelled)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 1.00, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call StopSoundBJ(gg_snd_LordaeronSummerFliesLoop1, true)
    call TriggerSleepAction(1.00)
    call ResetToGameCameraForPlayer(Player(1), 0.00)
    call PanCameraToTimedLocForPlayer(Player(1), udg_PositionCamera, 0)
    call CinematicModeBJ(false, GetPlayersAll())
    call PauseAllUnitsBJ(false)
    call UseTimeOfDayBJ(true)
    call DestroyFogModifier(udg_GrainCinVis)
    // ***********************
    call SetUnitPositionLoc(udg_Arthas, udg_PositionArthas)
    call SetUnitPositionLoc(udg_Jaina, udg_PositionJaina)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(PLAYER_NEUTRAL_PASSIVE), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_UNALLIED)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(6)), function Trig_Grain01_Queue_Func074002)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(1)), function Trig_Grain01_Queue_Func075002)
    call SelectGroupBJ(udg_SelectionGroup)
    call SetUnitInvulnerable(gg_unit_ngni_0080, false)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 1.00, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    set udg_Grain01Cancelled=true
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Grain01_Queue takes nothing returns nothing
    set gg_trg_Grain01_Queue=CreateTrigger()
    call TriggerAddCondition(gg_trg_Grain01_Queue, Condition(function Trig_Grain01_Queue_Conditions))
    call TriggerAddAction(gg_trg_Grain01_Queue, function Trig_Grain01_Queue_Actions)
endfunction

//===========================================================================
// Trigger: JainaFaceGrainery
//===========================================================================
function Trig_JainaFaceGrainery_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Jaina ) ) then
        return false
    endif
    return true
endfunction

function Trig_JainaFaceGrainery_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(0.10)
    call IssueImmediateOrderBJ(udg_Jaina, "stop")
    call TriggerSleepAction(0.05)
    call SetUnitFacingToFaceUnitTimed(udg_Jaina, gg_unit_ngni_0080, 0.15)
endfunction

//===========================================================================
function InitTrig_JainaFaceGrainery takes nothing returns nothing
    set gg_trg_JainaFaceGrainery=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_JainaFaceGrainery, gg_rct_JainaGranaryPost)
    call TriggerAddCondition(gg_trg_JainaFaceGrainery, Condition(function Trig_JainaFaceGrainery_Conditions))
    call TriggerAddAction(gg_trg_JainaFaceGrainery, function Trig_JainaFaceGrainery_Actions)
endfunction

//===========================================================================
// Trigger: ArthasFaceGrainery
//===========================================================================
function Trig_ArthasFaceGrainery_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    return true
endfunction

function Trig_ArthasFaceGrainery_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(0.10)
    call IssueImmediateOrderBJ(udg_Arthas, "stop")
    call TriggerSleepAction(0.05)
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, gg_unit_ngni_0080, 0.15)
endfunction

//===========================================================================
function InitTrig_ArthasFaceGrainery takes nothing returns nothing
    set gg_trg_ArthasFaceGrainery=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_ArthasFaceGrainery, gg_rct_ArthasGranaryPost)
    call TriggerAddCondition(gg_trg_ArthasFaceGrainery, Condition(function Trig_ArthasFaceGrainery_Conditions))
    call TriggerAddAction(gg_trg_ArthasFaceGrainery, function Trig_ArthasFaceGrainery_Actions)
endfunction

//===========================================================================
// Trigger: Priests
//===========================================================================
function Trig_Priests_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Priests_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerAddBJ(gg_trg_Priest_Queue, true)
endfunction

//===========================================================================
function InitTrig_Priests takes nothing returns nothing
    set gg_trg_Priests=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Priests, gg_rct_PriestsStartArea)
    call TriggerAddCondition(gg_trg_Priests, Condition(function Trig_Priests_Conditions))
    call TriggerAddAction(gg_trg_Priests, function Trig_Priests_Actions)
endfunction

//===========================================================================
// Trigger: Priest Queue
//===========================================================================
function Trig_Priest_Queue_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Priest_Queue_Func013001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func021001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func022001 takes nothing returns boolean
    return ( RectContainsUnit(gg_rct_Priest_ArthasJaina_Here, udg_Arthas) == true )
endfunction

function Trig_Priest_Queue_Func023001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func025001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func026001 takes nothing returns boolean
    return ( RectContainsUnit(gg_rct_Priest_ArthasJaina_Here, udg_Arthas) == true )
endfunction

function Trig_Priest_Queue_Func028001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func032001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Func038001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Priest_Queue_Actions takes nothing returns nothing
    // ****************************************
    call IssuePointOrderLocBJ(gg_unit_hmpr_0073, "move", GetRectCenter(gg_rct_Priest01GranaryPost))
    call RescueUnitBJ(gg_unit_hmpr_0073, Player(1), true)
    call status_check_location(22)
    call TriggerSleepAction(0.20)
    call IssuePointOrderLocBJ(gg_unit_hmpr_0072, "move", GetRectCenter(gg_rct_Priest02GranaryPost))
    call RescueUnitBJ(gg_unit_hmpr_0072, Player(1), true)
    call PanCameraToTimedLocForPlayer(Player(1), GetRectCenter(gg_rct_Priest02GranaryPost), 1.00)
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_Priests), 1024.00)
    set udg_PriestsVis=GetLastCreatedFogModifier()
    call TriggerSleepAction(1.00)
    if ( Trig_Priest_Queue_Func013001() ) then
        return
    else
        call DoNothing()
    endif
    call CreateNUnitsAtLoc(1, 'hmtm', Player(9), GetRectCenter(gg_rct_MortarTeamCreate01), 45.00)
    set udg_MortarTeam01=GetLastCreatedUnit()
    call SetPlayerAllianceStateBJ(Player(9), Player(6), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(9), Player(PLAYER_NEUTRAL_AGGRESSIVE), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(9), bj_ALLIANCE_ALLIED)
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_hmpr_0072, "TRIGSTR_608", gg_snd_H03Priest21, "TRIGSTR_609", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_Priest_Queue_Func021001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_Priest_Queue_Func022001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_639", gg_snd_H03Jaina22, "TRIGSTR_640", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_Priest_Queue_Func023001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_hmpr_0072, "TRIGSTR_614", gg_snd_H03Priest23, "TRIGSTR_615", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_Priest_Queue_Func025001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_Priest_Queue_Func026001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_629", gg_snd_H03Arthas24, "TRIGSTR_630", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    call VolumeGroupResetBJ()
    if ( Trig_Priest_Queue_Func028001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_HINT, "TRIGSTR_620")
    call TriggerSleepAction(bj_QUEUE_DELAY_HINT)
    // ***********************
    if ( Trig_Priest_Queue_Func032001() ) then
        return
    else
        call DoNothing()
    endif
    call DestroyFogModifier(udg_PriestsVis)
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_COMPLETED, "TRIGSTR_621")
    call QuestSetCompletedBJ(udg_QuestInvestigateVillages, true)
    call QuestItemSetCompletedBJ(udg_QuestInvestigateReq, true)
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    if ( Trig_Priest_Queue_Func038001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_DISCOVERED, "TRIGSTR_622")
    call QuestSetDiscoveredBJ(udg_QuestDestroyGranary, true)
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_Granary_Warehouse_Ping), 1024.00)
    call DestroyFogModifier(GetLastCreatedFogModifier())
    call PingMinimapLocForForce(GetPlayersAll(), GetRectCenter(gg_rct_Granary_Warehouse_Ping), 6.00)
    call SetCameraQuickPositionLocForPlayer(Player(1), GetRectCenter(gg_rct_Granary_Warehouse_Ping))
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Priest_Queue takes nothing returns nothing
    set gg_trg_Priest_Queue=CreateTrigger()
    call TriggerAddCondition(gg_trg_Priest_Queue, Condition(function Trig_Priest_Queue_Conditions))
    call TriggerAddAction(gg_trg_Priest_Queue, function Trig_Priest_Queue_Actions)
endfunction

//===========================================================================
// Trigger: EndingCancelled
//===========================================================================
function Trig_EndingCancelled_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_EndingCancelled=true
    call ConditionalTriggerExecute(gg_trg_Victory)
endfunction

//===========================================================================
function InitTrig_EndingCancelled takes nothing returns nothing
    set gg_trg_EndingCancelled=CreateTrigger()
    call DisableTrigger(gg_trg_EndingCancelled)
    call TriggerRegisterPlayerEventEndCinematic(gg_trg_EndingCancelled, Player(1))
    call TriggerAddAction(gg_trg_EndingCancelled, function Trig_EndingCancelled_Actions)
endfunction

//===========================================================================
// Trigger: Ending01
//===========================================================================
function Trig_Ending01_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Ending01_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerClearBJ()
    call SetUnitTimeScalePercent(gg_unit_ngwr_0074, 50.00)
    set udg_GameOver=true
    call DisableTrigger(gg_trg_DefeatArthasDeath)
    call DisableTrigger(gg_trg_DefeatJainaDeath)
    call DisableTrigger(gg_trg_AbominationDies)
    call SetUnitInvulnerable(udg_Arthas, true)
    call SetUnitInvulnerable(udg_Jaina, true)
    call QueuedTriggerAddBJ(gg_trg_Ending01_Queue, true)
endfunction

//===========================================================================
function InitTrig_Ending01 takes nothing returns nothing
    set gg_trg_Ending01=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Ending01, gg_unit_ngwr_0074, EVENT_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_Ending01, Condition(function Trig_Ending01_Conditions))
    call TriggerAddAction(gg_trg_Ending01, function Trig_Ending01_Actions)
endfunction

//===========================================================================
// Trigger: Ending01 Queue
//===========================================================================
function Trig_Ending01_Queue_Func005002 takes nothing returns nothing
    call SetUnitLifePercentBJ(GetEnumUnit(), 100)
endfunction

function Trig_Ending01_Queue_Func017002 takes nothing returns nothing
    call ShowUnitHide(GetEnumUnit())
endfunction

function Trig_Ending01_Queue_Func018002 takes nothing returns nothing
    call ShowUnitHide(GetEnumUnit())
endfunction

function Trig_Ending01_Queue_Func028001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_Abomination) == true )
endfunction

function Trig_Ending01_Queue_Func034001 takes nothing returns boolean
    return ( udg_EndingCancelled == true )
endfunction

function Trig_Ending01_Queue_Func039001 takes nothing returns boolean
    return ( udg_EndingCancelled == true )
endfunction

function Trig_Ending01_Queue_Func043001 takes nothing returns boolean
    return ( udg_EndingCancelled == true )
endfunction

function Trig_Ending01_Queue_Func046001 takes nothing returns boolean
    return ( udg_EndingCancelled == true )
endfunction

function Trig_Ending01_Queue_Func049001 takes nothing returns boolean
    return ( udg_EndingCancelled == true )
endfunction

function Trig_Ending01_Queue_Actions takes nothing returns nothing
    // **************
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_COMPLETED, "TRIGSTR_593")
    call QuestSetCompletedBJ(udg_QuestDestroyGranary, true)
    call QuestItemSetCompletedBJ(udg_GranaryReq, true)
    call ForGroupBJ(GetUnitsOfPlayerAll(Player(1)), function Trig_Ending01_Queue_Func005002)
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    call UseTimeOfDayBJ(false)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 1.00, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call PauseAllUnitsBJ(true)
    call TriggerSleepAction(1.00)
    call CinematicModeBJ(true, GetPlayersAll())
    call PlayThematicMusicBJ("Sound\\Music\\mp3Music\\HumanDefeat.mp3")
    call SetSkyModel("Environment\\Sky\\LordaeronSummerSky\\LordaeronSummerSky.mdl")
    call ClearSelection()
    call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_ALL, udg_Arthas)
    call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_ALL, udg_Jaina)
    call ForGroupBJ(GetUnitsInRectOfPlayer(GetPlayableMapRect(), Player(1)), function Trig_Ending01_Queue_Func017002)
    call ForGroupBJ(GetUnitsInRectOfPlayer(GetPlayableMapRect(), Player(6)), function Trig_Ending01_Queue_Func018002)
    call ShowUnitShow(udg_Abomination)
    call ShowUnitShow(udg_Arthas)
    call ShowUnitShow(udg_Jaina)
    call PauseUnitBJ(false, udg_Arthas)
    call PauseUnitBJ(false, udg_Jaina)
    call PauseUnitBJ(false, udg_Abomination)
    call CameraSetupApplyForPlayer(true, gg_cam_FinalCin1, Player(1), 0)
    call SetUnitPositionLoc(udg_Arthas, GetRectCenter(gg_rct_FinalCin_Arthas))
    call SetUnitPositionLocFacingLocBJ(udg_Jaina, GetRectCenter(gg_rct_FinalCin_Jaina), GetUnitLoc(udg_Arthas))
    if ( Trig_Ending01_Queue_Func028001() ) then
        call SetUnitPositionLoc(udg_Abomination, GetRectCenter(gg_rct_FinalCin_Abomination))
    else
        call DoNothing()
    endif
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 1.00, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(0.50)
    // NOW SKIPPABLE
    call EnableTrigger(gg_trg_EndingCancelled)
    call TriggerSleepAction(1.50)
    if ( Trig_Ending01_Queue_Func034001() ) then
        return
    else
        call DoNothing()
    endif
    call KillUnit(udg_Abomination)
    call SetUnitFacingToFaceUnitTimed(udg_Arthas, udg_Jaina, 0.30)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_ALLIED)
    if ( Trig_Ending01_Queue_Func039001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_594", gg_snd_H03Arthas36, "TRIGSTR_595", bj_TIMETYPE_ADD, 0.00, false)
    call CameraSetupApplyForPlayer(true, gg_cam_FinalCin2, Player(0), 10.00)
    call WaitForSoundBJ(gg_snd_H03Arthas36, 0)
    if ( Trig_Ending01_Queue_Func043001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_596", gg_snd_H03Jaina37, "TRIGSTR_597", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Jaina37, 0)
    if ( Trig_Ending01_Queue_Func046001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_598", gg_snd_H03Arthas38, "TRIGSTR_599", bj_TIMETYPE_ADD, 0.00, false)
    call WaitForSoundBJ(gg_snd_H03Arthas38, 0)
    if ( Trig_Ending01_Queue_Func049001() ) then
        return
    else
        call DoNothing()
    endif
    call DisableTrigger(gg_trg_EndingCancelled)
    call ConditionalTriggerExecute(gg_trg_Victory)
    // ***********************
endfunction

//===========================================================================
function InitTrig_Ending01_Queue takes nothing returns nothing
    set gg_trg_Ending01_Queue=CreateTrigger()
    call TriggerAddAction(gg_trg_Ending01_Queue, function Trig_Ending01_Queue_Actions)
endfunction

//===========================================================================
// Trigger: EncounterCancelled
//===========================================================================
function Trig_EncounterCancelled_Func030001 takes nothing returns boolean
    return ( udg_Skeleton01 == null )
endfunction

function Trig_EncounterCancelled_Func031001 takes nothing returns boolean
    return ( udg_Skeleton01 == null )
endfunction

function Trig_EncounterCancelled_Func032001 takes nothing returns boolean
    return ( udg_Skeleton02 == null )
endfunction

function Trig_EncounterCancelled_Func033001 takes nothing returns boolean
    return ( udg_Skeleton02 == null )
endfunction

function Trig_EncounterCancelled_Func034001 takes nothing returns boolean
    return ( udg_Skeleton03 == null )
endfunction

function Trig_EncounterCancelled_Func035001 takes nothing returns boolean
    return ( udg_Skeleton03 == null )
endfunction

function Trig_EncounterCancelled_Func036001 takes nothing returns boolean
    return ( udg_Skeleton04 == null )
endfunction

function Trig_EncounterCancelled_Func037001 takes nothing returns boolean
    return ( udg_Skeleton04 == null )
endfunction

function Trig_EncounterCancelled_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_EncounterCancelled=true
    call EndThematicMusicBJ()
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 0.50, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(0.50)
    call RemoveUnit(udg_Skeleton01)
    set udg_Skeleton01=null
    call RemoveUnit(udg_Skeleton02)
    set udg_Skeleton02=null
    call RemoveUnit(udg_Skeleton03)
    set udg_Skeleton03=null
    call RemoveUnit(udg_Skeleton04)
    set udg_Skeleton04=null
    call UseTimeOfDayBJ(true)
    call StopSoundBJ(GetLastPlayedSound(), false)
    call ResetToGameCameraForPlayer(Player(1), 1.00)
    call SmartCameraPanBJ(Player(1), udg_PositionCamera, 1.00)
    call DisableTrigger(gg_trg_AcolytesBusy)
    call RemoveUnit(gg_unit_uaco_0038)
    call RemoveUnit(gg_unit_uaco_0040)
    call RemoveUnit(gg_unit_uaco_0095)
    call RemoveUnit(gg_unit_uaco_0100)
    call RemoveUnit(udg_KelThuzad)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_UNALLIED)
    call KillDestructable(gg_dest_LTba_2334)
    call KillDestructable(gg_dest_LTcr_2310)
    call KillDestructable(gg_dest_LTcr_2312)
    call KillDestructable(gg_dest_LTcr_2313)
    if ( Trig_EncounterCancelled_Func030001() ) then
        call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate01), 270.00)
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func031001() ) then
        set udg_Skeleton01=GetLastCreatedUnit()
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func032001() ) then
        call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate02), 270.00)
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func033001() ) then
        set udg_Skeleton02=GetLastCreatedUnit()
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func034001() ) then
        call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate03), 270.00)
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func035001() ) then
        set udg_Skeleton03=GetLastCreatedUnit()
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func036001() ) then
        call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate04), 270.00)
    else
        call DoNothing()
    endif
    if ( Trig_EncounterCancelled_Func037001() ) then
        set udg_Skeleton04=GetLastCreatedUnit()
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_Abomination, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton01, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton02, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton03, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton04, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call SetUnitInvulnerable(udg_Arthas, false)
    call SetUnitInvulnerable(udg_Jaina, false)
    call CinematicModeBJ(false, GetPlayersAll())
    call SelectGroupBJ(udg_SelectionGroup)
    call PauseAllUnitsBJ(false)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEIN, 2.00, "ReplaceableTextures\\CameraMasks\\Black_mask.blp", 0, 0, 0, 0)
endfunction

//===========================================================================
function InitTrig_EncounterCancelled takes nothing returns nothing
    set gg_trg_EncounterCancelled=CreateTrigger()
    call DisableTrigger(gg_trg_EncounterCancelled)
    call TriggerRegisterPlayerEventEndCinematic(gg_trg_EncounterCancelled, Player(1))
    call TriggerAddAction(gg_trg_EncounterCancelled, function Trig_EncounterCancelled_Actions)
endfunction

//===========================================================================
// Trigger: Encounter
//===========================================================================
function Trig_Encounter_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_Encounter_Func020002 takes nothing returns nothing
    call PauseUnitBJ(false, GetEnumUnit())
endfunction

function Trig_Encounter_Func023002 takes nothing returns nothing
    call UnitRemoveBuffsBJ(bj_REMOVEBUFFS_ALL, GetEnumUnit())
endfunction

function Trig_Encounter_Func031001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func034001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func035002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GetEnumUnit(), "move", GetRectCenter(gg_rct_Exit))
endfunction

function Trig_Encounter_Func038001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func041001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func044001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func047001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func058001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func069001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func080001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func092001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func094001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func098001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func104001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func106001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func113001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Func123001 takes nothing returns boolean
    return ( udg_EncounterCancelled == true )
endfunction

function Trig_Encounter_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    set udg_PositionCamera=CameraSetupGetDestPositionLoc(GetCurrentCameraSetup())
    call StopSoundBJ(GetLastPlayedSound(), true)
    call SetUnitInvulnerable(udg_Arthas, true)
    call SetUnitInvulnerable(udg_Jaina, true)
    call QueuedTriggerClearBJ()
    call ConditionalTriggerExecute(gg_trg_MortarTeamDialogue_DESTRUCTION)
    // Music
    call PlayThematicMusicBJ("Sound\\Music\\mp3Music\\DarkAgents.mp3")
    // **********
    call CinematicModeBJ(true, GetPlayersAll())
    set udg_SelectionGroup=GetUnitsSelectedAll(Player(1))
    call ClearSelection()
    call PauseAllUnitsBJ(true)
    call PauseUnitBJ(false, udg_Abomination)
    call PauseUnitBJ(false, udg_KelThuzad)
    call ForGroupBJ(udg_AcolyteGroup, function Trig_Encounter_Func020002)
    call TriggerSleepAction(0.80)
    call UseTimeOfDayBJ(false)
    call ForGroupBJ(GetUnitsInRectAll(GetPlayableMapRect()), function Trig_Encounter_Func023002)
    call CameraSetupApplyForPlayer(true, gg_cam_Ending01, Player(1), 2.50)
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_ALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_ALLIED)
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_AbominationAttack_2), 0.20)
    // NOW SKIPPABLE
    call EnableTrigger(gg_trg_EncounterCancelled)
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func031001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_KelThuzad, "TRIGSTR_077", gg_snd_H03KelThuzad32, "TRIGSTR_080", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func034001() ) then
        return
    else
        call DoNothing()
    endif
    call ForGroupBJ(udg_AcolyteGroup, function Trig_Encounter_Func035002)
    call DisableTrigger(gg_trg_AcolytesBusy)
    call TriggerSleepAction(0.50)
    if ( Trig_Encounter_Func038001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(udg_KelThuzad, "move", GetRectCenter(gg_rct_KelThuzadPost))
    call TriggerSleepAction(3.00)
    if ( Trig_Encounter_Func041001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_AbominationAttack_2), 0.25)
    call WaitForSoundBJ(gg_snd_H03KelThuzad32, 0)
    if ( Trig_Encounter_Func044001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_KelThuzad, "TRIGSTR_085", gg_snd_H03KelThuzad33, "TRIGSTR_086", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(1.50)
    if ( Trig_Encounter_Func047001() ) then
        return
    else
        call DoNothing()
    endif
    // Skeleton01
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_EndCrate01), 0)
    call SetUnitAnimation(udg_KelThuzad, "stand channel")
    call KillDestructable(gg_dest_LTcr_2313)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate01), 300.00)
    set udg_Skeleton01=GetLastCreatedUnit()
    call SetUnitAnimation(GetLastCreatedUnit(), "birth")
    call SetSoundVolumeBJ(gg_snd_RaiseSkeleton, 70.00)
    call PlaySoundBJ(gg_snd_RaiseSkeleton)
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func058001() ) then
        return
    else
        call DoNothing()
    endif
    // Skeleton02
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_EndCrate02), 0)
    call SetUnitAnimation(udg_KelThuzad, "stand channel")
    call KillDestructable(gg_dest_LTcr_2312)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate02), 120.00)
    set udg_Skeleton02=GetLastCreatedUnit()
    call SetUnitAnimation(GetLastCreatedUnit(), "birth")
    call SetSoundVolumeBJ(gg_snd_RaiseSkeleton01, 70.00)
    call PlaySoundBJ(gg_snd_RaiseSkeleton01)
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func069001() ) then
        return
    else
        call DoNothing()
    endif
    // Skeleton03
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_EndCrate03), 0)
    call SetUnitAnimation(udg_KelThuzad, "stand channel")
    call KillDestructable(gg_dest_LTcr_2310)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate03), 256.00)
    set udg_Skeleton03=GetLastCreatedUnit()
    call SetUnitAnimation(GetLastCreatedUnit(), "birth")
    call SetSoundVolumeBJ(gg_snd_RaiseSkeleton02, 80.00)
    call PlaySoundBJ(gg_snd_RaiseSkeleton02)
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func080001() ) then
        return
    else
        call DoNothing()
    endif
    // Skeleton04
    call SetUnitFacingToFaceLocTimed(udg_KelThuzad, GetRectCenter(gg_rct_EndCrate04), 0)
    call SetUnitAnimation(udg_KelThuzad, "stand channel")
    call KillDestructable(gg_dest_LTba_2334)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_EndCrate04), 0.00)
    set udg_Skeleton04=GetLastCreatedUnit()
    call SetUnitAnimation(GetLastCreatedUnit(), "birth")
    call SetSoundVolumeBJ(gg_snd_RaiseSkeleton03, 70.00)
    call PlaySoundBJ(gg_snd_RaiseSkeleton03)
    // ***********
    call TriggerSleepAction(0.50)
    if ( Trig_Encounter_Func092001() ) then
        return
    else
        call DoNothing()
    endif
    call WaitForSoundBJ(gg_snd_H03KelThuzad33, 0)
    if ( Trig_Encounter_Func094001() ) then
        return
    else
        call DoNothing()
    endif
    call RemoveGuardPosition(udg_KelThuzad)
    call IssuePointOrderLocBJ(udg_KelThuzad, "move", GetRectCenter(gg_rct_Exit))
    call TriggerSleepAction(1.00)
    if ( Trig_Encounter_Func098001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Ending02, Player(1), 0)
    call AttachSoundToUnitBJ(gg_snd_AbominationYesAttack2, udg_Abomination)
    call SetSoundVolumeBJ(gg_snd_AbominationYesAttack2, 70.00)
    call PlaySoundBJ(gg_snd_AbominationYesAttack2)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Jaina, "TRIGSTR_088", gg_snd_H03Jaina34, "TRIGSTR_089", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_Encounter_Func104001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(0.50)
    if ( Trig_Encounter_Func106001() ) then
        return
    else
        call DoNothing()
    endif
    call CameraSetupApplyForPlayer(true, gg_cam_Ending03, Player(1), 3.50)
    call IssuePointOrderLocBJ(udg_Abomination, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call AttachSoundToUnitBJ(gg_snd_AbominationPissed5, udg_Abomination)
    call SetSoundVolumeBJ(gg_snd_AbominationPissed5, 50.00)
    call PlaySoundBJ(gg_snd_AbominationPissed5)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_098", gg_snd_H03Arthas35, "TRIGSTR_099", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_Encounter_Func113001() ) then
        return
    else
        call DoNothing()
    endif
    call ResetToGameCameraForPlayer(Player(1), 2.00)
    call SmartCameraPanBJ(Player(1), udg_PositionCamera, 1.00)
    call RemoveUnit(udg_KelThuzad)
    call RemoveUnit(gg_unit_uaco_0038)
    call RemoveUnit(gg_unit_uaco_0040)
    call RemoveUnit(gg_unit_uaco_0095)
    call RemoveUnit(gg_unit_uaco_0100)
    call EndThematicMusicBJ()
    call TriggerSleepAction(2.00)
    if ( Trig_Encounter_Func123001() ) then
        return
    else
        call DoNothing()
    endif
    // NO LONGER SKIPPABLE
    call DisableTrigger(gg_trg_EncounterCancelled)
    call IssuePointOrderLocBJ(udg_Abomination, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton01, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton02, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton03, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call IssuePointOrderLocBJ(udg_Skeleton04, "attack", GetRectCenter(gg_rct_AbominationAttack_2))
    call SetPlayerAllianceStateBJ(Player(1), Player(6), bj_ALLIANCE_UNALLIED)
    call SetPlayerAllianceStateBJ(Player(6), Player(1), bj_ALLIANCE_UNALLIED)
    call SetStackedSoundBJ(false, gg_snd_WaterStreamLoop1, gg_rct_StreamLoop01)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop01)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop02)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop03)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop04)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop05)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop06)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop07)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop08)
    call SetStackedSoundBJ(false, gg_snd_WaterLakeLoop1, gg_rct_LakeLoop09)
    call UseTimeOfDayBJ(true)
    call CinematicModeBJ(false, GetPlayersAll())
    call SelectGroupBJ(udg_SelectionGroup)
    call PauseAllUnitsBJ(false)
    call SetUnitInvulnerable(udg_Arthas, false)
    call SetUnitInvulnerable(udg_Jaina, false)
endfunction

//===========================================================================
function InitTrig_Encounter takes nothing returns nothing
    set gg_trg_Encounter=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Encounter, gg_rct_Granary03Area)
    call TriggerAddCondition(gg_trg_Encounter, Condition(function Trig_Encounter_Conditions))
    call TriggerAddAction(gg_trg_Encounter, function Trig_Encounter_Actions)
endfunction

//===========================================================================
// Trigger: MortarTeamDialogue DESTRUCTION
//===========================================================================
function Trig_MortarTeamDialogue_DESTRUCTION_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_MortarTeamDialogue)
    call StopSoundBJ(gg_snd_H03Arthas25, true)
    call StopSoundBJ(gg_snd_H03Arthas27, true)
    call StopSoundBJ(gg_snd_H03Dwarf26, true)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_MortarTeamDialogue_DESTRUCTION takes nothing returns nothing
    set gg_trg_MortarTeamDialogue_DESTRUCTION=CreateTrigger()
    call TriggerAddAction(gg_trg_MortarTeamDialogue_DESTRUCTION, function Trig_MortarTeamDialogue_DESTRUCTION_Actions)
endfunction

//===========================================================================
// Trigger: AcolytesBusy
//===========================================================================
function Trig_AcolytesBusy_Func001002 takes nothing returns nothing
    call SetUnitAnimation(GroupPickRandomUnit(udg_AcolyteGroup), "attack")
endfunction

function Trig_AcolytesBusy_Actions takes nothing returns nothing
    call ForGroupBJ(udg_AcolyteGroup, function Trig_AcolytesBusy_Func001002)
endfunction

//===========================================================================
function InitTrig_AcolytesBusy takes nothing returns nothing
    set gg_trg_AcolytesBusy=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_AcolytesBusy, 0.50)
    call TriggerAddAction(gg_trg_AcolytesBusy, function Trig_AcolytesBusy_Actions)
endfunction

//===========================================================================
// Trigger: AbominationDies
//===========================================================================
function Trig_AbominationDies_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerClearBJ()
    call TriggerSleepAction(2.00)
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_562", gg_snd_H03Arthas31, "TRIGSTR_563", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_AbominationDies takes nothing returns nothing
    set gg_trg_AbominationDies=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_AbominationDies, gg_unit_uabo_0110, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_AbominationDies, function Trig_AbominationDies_Actions)
endfunction

//===========================================================================
// Trigger: Spawn Ghouls
//===========================================================================
function Trig_Spawn_Ghouls_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call CreateNUnitsAtLoc(1, 'ugho', Player(6), GetRectCenter(gg_rct_Ghoul02), 180.00)
    call IssuePointOrderLocBJ(GetLastCreatedUnit(), "attack", GetRectCenter(gg_rct_KelThuzadAppear))
    call TriggerSleepAction(0.50)
    call CreateNUnitsAtLoc(1, 'ugho', Player(6), GetRectCenter(gg_rct_Ghoul01), 180.00)
    call IssuePointOrderLocBJ(GetLastCreatedUnit(), "attack", GetRectCenter(gg_rct_KelThuzadAppear))
    call TriggerSleepAction(0.50)
    call CreateNUnitsAtLoc(1, 'ugho', Player(6), GetRectCenter(gg_rct_Ghoul02), 180.00)
    call IssuePointOrderLocBJ(GetLastCreatedUnit(), "attack", GetRectCenter(gg_rct_KelThuzadAppear))
    call TriggerSleepAction(0.50)
    call CreateNUnitsAtLoc(1, 'ugho', Player(6), GetRectCenter(gg_rct_Ghoul01), 180.00)
    call IssuePointOrderLocBJ(GetLastCreatedUnit(), "attack", GetRectCenter(gg_rct_KelThuzadAppear))
endfunction

//===========================================================================
function InitTrig_Spawn_Ghouls takes nothing returns nothing
    set gg_trg_Spawn_Ghouls=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Spawn_Ghouls, gg_unit_ngwr_0074, EVENT_UNIT_DAMAGED)
    call TriggerAddAction(gg_trg_Spawn_Ghouls, function Trig_Spawn_Ghouls_Actions)
endfunction

//===========================================================================
// Trigger: SheepOgreArea
//===========================================================================
function Trig_SheepOgreArea_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLeavingUnit()) == 'nshe' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SheepOgreArea_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(gg_unit_nshe_0081, "move", GetRectCenter(gg_rct_SheepArea))
endfunction

//===========================================================================
function InitTrig_SheepOgreArea takes nothing returns nothing
    set gg_trg_SheepOgreArea=CreateTrigger()
    call TriggerRegisterLeaveRectSimple(gg_trg_SheepOgreArea, gg_rct_SheepArea)
    call TriggerAddCondition(gg_trg_SheepOgreArea, Condition(function Trig_SheepOgreArea_Conditions))
    call TriggerAddAction(gg_trg_SheepOgreArea, function Trig_SheepOgreArea_Actions)
endfunction

//===========================================================================
// Trigger: SheepBanditArea
//===========================================================================
function Trig_SheepBanditArea_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetLeavingUnit()) == 'nshe' ) ) then
        return false
    endif
    return true
endfunction

function Trig_SheepBanditArea_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GetTriggerUnit(), "move", GetRectCenter(gg_rct_SheepBanditArea))
endfunction

//===========================================================================
function InitTrig_SheepBanditArea takes nothing returns nothing
    set gg_trg_SheepBanditArea=CreateTrigger()
    call TriggerRegisterLeaveRectSimple(gg_trg_SheepBanditArea, gg_rct_SheepBanditArea)
    call TriggerAddCondition(gg_trg_SheepBanditArea, Condition(function Trig_SheepBanditArea_Conditions))
    call TriggerAddAction(gg_trg_SheepBanditArea, function Trig_SheepBanditArea_Actions)
endfunction

//===========================================================================
// Trigger: SkeletonShip
//===========================================================================
function Trig_SkeletonShip_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_SkeletonShipGroup), "attack", GetRandomLocInRect(gg_rct_SkeletonShip))
endfunction

//===========================================================================
function InitTrig_SkeletonShip takes nothing returns nothing
    set gg_trg_SkeletonShip=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_SkeletonShip, 1.00)
    call TriggerAddAction(gg_trg_SkeletonShip, function Trig_SkeletonShip_Actions)
endfunction

//===========================================================================
// Trigger: SkeletonFinal
//===========================================================================
function Trig_SkeletonFinal_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_SkeletonFinalGroup), "attack", GetRandomLocInRect(gg_rct_SkeletonFinalGroup))
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_SkeletonFinalGroup), "attack", GetRandomLocInRect(gg_rct_SkeletonFinalGroup))
endfunction

//===========================================================================
function InitTrig_SkeletonFinal takes nothing returns nothing
    set gg_trg_SkeletonFinal=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_SkeletonFinal, 1.00)
    call TriggerAddAction(gg_trg_SkeletonFinal, function Trig_SkeletonFinal_Actions)
endfunction

//===========================================================================
// Trigger: SkeletonBeforeMortars
//===========================================================================
function Trig_SkeletonBeforeMortars_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_SkeletonBeforeMortarsGroup), "attack", GetRandomLocInRect(gg_rct_SkeletonBeforeMortars))
endfunction

//===========================================================================
function InitTrig_SkeletonBeforeMortars takes nothing returns nothing
    set gg_trg_SkeletonBeforeMortars=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_SkeletonBeforeMortars, 1.00)
    call TriggerAddAction(gg_trg_SkeletonBeforeMortars, function Trig_SkeletonBeforeMortars_Actions)
endfunction

//===========================================================================
// Trigger: PeasantPatrolSmall
//
// Activated from 'BanditsAllDie'
// Turns off when 'BanditsAttack' starts
//===========================================================================
function Trig_PeasantPatrolSmall_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_PeasantPatrolGroup02), "move", GetRandomLocInRect(gg_rct_PatrollSmallArea))
endfunction

//===========================================================================
function InitTrig_PeasantPatrolSmall takes nothing returns nothing
    set gg_trg_PeasantPatrolSmall=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_PeasantPatrolSmall, 4.00)
    call TriggerAddAction(gg_trg_PeasantPatrolSmall, function Trig_PeasantPatrolSmall_Actions)
endfunction

//===========================================================================
// Trigger: PeasantPatrolHello01
//
// Turns off when 'BanditsAttack' starts
//===========================================================================
function Trig_PeasantPatrolHello01_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(gg_unit_nvil_0010, "move", GetRandomLocInRect(gg_rct_PatrolHello01area))
endfunction

//===========================================================================
function InitTrig_PeasantPatrolHello01 takes nothing returns nothing
    set gg_trg_PeasantPatrolHello01=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_PeasantPatrolHello01, 4.00)
    call TriggerAddAction(gg_trg_PeasantPatrolHello01, function Trig_PeasantPatrolHello01_Actions)
endfunction

//===========================================================================
// Trigger: PeasantPatrol
//
// Turned on from 'BanditsAllDie'
//===========================================================================
function Trig_PeasantPatrol_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_PeasantPatrolGroup01), "move", GetRandomLocInRect(gg_rct_PeasantPatrolArea))
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_PeasantPatrolGroup01), "move", GetRandomLocInRect(gg_rct_PeasantPatrolArea))
endfunction

//===========================================================================
function InitTrig_PeasantPatrol takes nothing returns nothing
    set gg_trg_PeasantPatrol=CreateTrigger()
    call DisableTrigger(gg_trg_PeasantPatrol)
    call TriggerRegisterTimerEventPeriodic(gg_trg_PeasantPatrol, 4.00)
    call TriggerAddAction(gg_trg_PeasantPatrol, function Trig_PeasantPatrol_Actions)
endfunction

//===========================================================================
// Trigger: StartKidsRunning
//===========================================================================
function Trig_StartKidsRunning_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssuePointOrderLocBJ(gg_unit_nvlk_0026, "move", GetRectCenter(gg_rct_VillagerKidsRunning03))
    call IssuePointOrderLocBJ(gg_unit_nvlk_0025, "move", GetRectCenter(gg_rct_VillagerKidsRunning02))
    call EnableTrigger(gg_trg_KidsRunningDest01)
    call EnableTrigger(gg_trg_KidsRunningDest02)
    call EnableTrigger(gg_trg_KidsRunningDest03)
endfunction

//===========================================================================
function InitTrig_StartKidsRunning takes nothing returns nothing
    set gg_trg_StartKidsRunning=CreateTrigger()
    call TriggerRegisterTimerEventSingle(gg_trg_StartKidsRunning, 5.00)
    call TriggerAddAction(gg_trg_StartKidsRunning, function Trig_StartKidsRunning_Actions)
endfunction

//===========================================================================
// Trigger: KidsRunningArea
//===========================================================================
function Trig_KidsRunningArea_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nvlk_0025) == true ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nvlk_0026) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_KidsRunningArea_Actions takes nothing returns nothing
    call IssueImmediateOrderBJ(gg_unit_nvlk_0026, "stop")
    call SetUnitFacingToFaceUnitTimed(gg_unit_nvlk_0026, udg_Arthas, 0.00)
    call TriggerSleepAction(0.20)
    call IssueImmediateOrderBJ(gg_unit_nvlk_0025, "stop")
    call SetUnitFacingToFaceUnitTimed(gg_unit_nvlk_0025, udg_Arthas, 0.00)
    call DisableTrigger(gg_trg_KidsRunningDest01)
    call DisableTrigger(gg_trg_KidsRunningDest02)
    call DisableTrigger(gg_trg_KidsRunningDest03)
endfunction

//===========================================================================
function InitTrig_KidsRunningArea takes nothing returns nothing
    set gg_trg_KidsRunningArea=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_KidsRunningArea, gg_rct_KidsRunningArea)
    call TriggerAddCondition(gg_trg_KidsRunningArea, Condition(function Trig_KidsRunningArea_Conditions))
    call TriggerAddAction(gg_trg_KidsRunningArea, function Trig_KidsRunningArea_Actions)
endfunction

//===========================================================================
// Trigger: KidsLaughing
//===========================================================================
function Trig_KidsLaughing_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nvlk_0025) == true ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nvlk_0026) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_KidsLaughing_Func010001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nvlk_0025) == true )
endfunction

function Trig_KidsLaughing_Func011001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nvlk_0026) == true )
endfunction

function Trig_KidsLaughing_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call SetSoundPositionLocBJ(gg_snd_H01VillagerC38, GetUnitLoc(gg_unit_nvlk_0025), 0)
    call PlaySoundBJ(gg_snd_H01VillagerC38)
    call SetSoundPositionLocBJ(gg_snd_H01VillagerC37, GetUnitLoc(gg_unit_nvlk_0026), 0)
    call PlaySoundBJ(gg_snd_H01VillagerC37)
    call TriggerSleepAction(0.50)
    if ( Trig_KidsLaughing_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_KidsLaughing_Func011001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSoundPositionLocBJ(gg_snd_H01VillagerC38, GetUnitLoc(gg_unit_nvlk_0025), 0)
    call PlaySoundBJ(gg_snd_H01VillagerC38)
endfunction

//===========================================================================
function InitTrig_KidsLaughing takes nothing returns nothing
    set gg_trg_KidsLaughing=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_KidsLaughing, gg_rct_KidsLaughing)
    call TriggerAddCondition(gg_trg_KidsLaughing, Condition(function Trig_KidsLaughing_Conditions))
    call TriggerAddAction(gg_trg_KidsLaughing, function Trig_KidsLaughing_Actions)
endfunction

//===========================================================================
// Trigger: KidsRunningDest01
//===========================================================================
function Trig_KidsRunningDest01_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnteringUnit()) == 'nvlk' ) ) then
        return false
    endif
    return true
endfunction

function Trig_KidsRunningDest01_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GetTriggerUnit(), "move", GetRectCenter(gg_rct_VillagerKidsRunning02))
endfunction

//===========================================================================
function InitTrig_KidsRunningDest01 takes nothing returns nothing
    set gg_trg_KidsRunningDest01=CreateTrigger()
    call DisableTrigger(gg_trg_KidsRunningDest01)
    call TriggerRegisterEnterRectSimple(gg_trg_KidsRunningDest01, gg_rct_VillagerKidsRunning01)
    call TriggerAddCondition(gg_trg_KidsRunningDest01, Condition(function Trig_KidsRunningDest01_Conditions))
    call TriggerAddAction(gg_trg_KidsRunningDest01, function Trig_KidsRunningDest01_Actions)
endfunction

//===========================================================================
// Trigger: KidsRunningDest02
//===========================================================================
function Trig_KidsRunningDest02_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnteringUnit()) == 'nvlk' ) ) then
        return false
    endif
    return true
endfunction

function Trig_KidsRunningDest02_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GetTriggerUnit(), "move", GetRectCenter(gg_rct_VillagerKidsRunning03))
endfunction

//===========================================================================
function InitTrig_KidsRunningDest02 takes nothing returns nothing
    set gg_trg_KidsRunningDest02=CreateTrigger()
    call DisableTrigger(gg_trg_KidsRunningDest02)
    call TriggerRegisterEnterRectSimple(gg_trg_KidsRunningDest02, gg_rct_VillagerKidsRunning02)
    call TriggerAddCondition(gg_trg_KidsRunningDest02, Condition(function Trig_KidsRunningDest02_Conditions))
    call TriggerAddAction(gg_trg_KidsRunningDest02, function Trig_KidsRunningDest02_Actions)
endfunction

//===========================================================================
// Trigger: KidsRunningDest03
//===========================================================================
function Trig_KidsRunningDest03_Conditions takes nothing returns boolean
    if ( not ( GetUnitTypeId(GetEnteringUnit()) == 'nvlk' ) ) then
        return false
    endif
    return true
endfunction

function Trig_KidsRunningDest03_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GetTriggerUnit(), "move", GetRectCenter(gg_rct_VillagerKidsRunning01))
endfunction

//===========================================================================
function InitTrig_KidsRunningDest03 takes nothing returns nothing
    set gg_trg_KidsRunningDest03=CreateTrigger()
    call DisableTrigger(gg_trg_KidsRunningDest03)
    call TriggerRegisterEnterRectSimple(gg_trg_KidsRunningDest03, gg_rct_VillagerKidsRunning03)
    call TriggerAddCondition(gg_trg_KidsRunningDest03, Condition(function Trig_KidsRunningDest03_Conditions))
    call TriggerAddAction(gg_trg_KidsRunningDest03, function Trig_KidsRunningDest03_Actions)
endfunction

//===========================================================================
// Trigger: Ogre01
//
// Run by cinematic ending
//===========================================================================
function Trig_Ogre01_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(gg_unit_nogr_0012, "patrol", GetRectCenter(gg_rct_OgrePatroler))
endfunction

//===========================================================================
function InitTrig_Ogre01 takes nothing returns nothing
    set gg_trg_Ogre01=CreateTrigger()
    call TriggerAddAction(gg_trg_Ogre01, function Trig_Ogre01_Actions)
endfunction

//===========================================================================
// Trigger: BanditBusy
//===========================================================================
function Trig_BanditBusy_Func002002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(udg_BanditsCamp), "attack", GetRandomLocInRect(gg_rct_BanditRoamCamp))
endfunction

function Trig_BanditBusy_Actions takes nothing returns nothing
    call ForGroupBJ(udg_BanditsCamp, function Trig_BanditBusy_Func002002)
endfunction

//===========================================================================
function InitTrig_BanditBusy takes nothing returns nothing
    set gg_trg_BanditBusy=CreateTrigger()
    call TriggerRegisterTimerEventPeriodic(gg_trg_BanditBusy, 3.50)
    call TriggerAddAction(gg_trg_BanditBusy, function Trig_BanditBusy_Actions)
endfunction

//===========================================================================
// Trigger: VillagerConcernedMessage
//===========================================================================
function Trig_VillagerConcernedMessage_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nC00_0093) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerConcernedMessage_Func005001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC00_0093) == true )
endfunction

function Trig_VillagerConcernedMessage_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssuePointOrderLocBJ(gg_unit_nC00_0093, "move", GetRectCenter(gg_rct_VillagerConcernedDestination))
    call TriggerSleepAction(1.00)
    if ( Trig_VillagerConcernedMessage_Func005001() ) then
        return
    else
        call DoNothing()
    endif
    call QueuedTriggerAddBJ(gg_trg_VillagerConcernedMessage_Queued, true)
endfunction

//===========================================================================
function InitTrig_VillagerConcernedMessage takes nothing returns nothing
    set gg_trg_VillagerConcernedMessage=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_VillagerConcernedMessage, gg_rct_VillagerConcernedArea)
    call TriggerAddCondition(gg_trg_VillagerConcernedMessage, Condition(function Trig_VillagerConcernedMessage_Conditions))
    call TriggerAddAction(gg_trg_VillagerConcernedMessage, function Trig_VillagerConcernedMessage_Actions)
endfunction

//===========================================================================
// Trigger: VillagerConcernedMessage Queued
//===========================================================================
function Trig_VillagerConcernedMessage_Queued_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerConcernedMessage_Queued_Func007001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC00_0093) == true )
endfunction

function Trig_VillagerConcernedMessage_Queued_Func008001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC00_0093) == true )
endfunction

function Trig_VillagerConcernedMessage_Queued_Func015001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC00_0093) == true )
endfunction

function Trig_VillagerConcernedMessage_Queued_Actions takes nothing returns nothing
    call DestroyEffectBJ(udg_StacieBang)
    call PingMinimapLocForForce(GetPlayersAll(), GetRectCenter(gg_rct_BridgeOut), 5.00)
    call SetCameraQuickPositionLocForPlayer(Player(1), GetRectCenter(gg_rct_BridgeOut))
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_BridgeOut), 900.00)
    set udg_BridgeVis=GetLastCreatedFogModifier()
    if ( Trig_VillagerConcernedMessage_Queued_Func007001() ) then
        call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    else
        call DoNothing()
    endif
    if ( Trig_VillagerConcernedMessage_Queued_Func008001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC00_0093, "TRIGSTR_676", gg_snd_H03VillagerF39, "TRIGSTR_677", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
    call TriggerSleepAction(3.00)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    call TriggerSleepAction(2.00)
    if ( Trig_VillagerConcernedMessage_Queued_Func015001() ) then
        return
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_VillagerConcernedMessage_Queued takes nothing returns nothing
    set gg_trg_VillagerConcernedMessage_Queued=CreateTrigger()
    call TriggerAddCondition(gg_trg_VillagerConcernedMessage_Queued, Condition(function Trig_VillagerConcernedMessage_Queued_Conditions))
    call TriggerAddAction(gg_trg_VillagerConcernedMessage_Queued, function Trig_VillagerConcernedMessage_Queued_Actions)
endfunction

//===========================================================================
// Trigger: Stacie Killed
//===========================================================================
function Trig_Stacie_Killed_Actions takes nothing returns nothing
    call StopSoundBJ(gg_snd_H03VillagerF39, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_Stacie_Killed takes nothing returns nothing
    set gg_trg_Stacie_Killed=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Stacie_Killed, gg_unit_nC00_0093, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_Stacie_Killed, function Trig_Stacie_Killed_Actions)
endfunction

//===========================================================================
// Trigger: VillagerHello
//===========================================================================
function Trig_VillagerHello_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nC04_0118) == true ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerHello_Func007001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC08_0155) == true )
endfunction

function Trig_VillagerHello_Func010001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC09_0001) == true )
endfunction

function Trig_VillagerHello_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call SetUnitFacingToFaceUnitTimed(gg_unit_nC04_0118, udg_Arthas, 0.20)
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC04_0118, "TRIGSTR_125", gg_snd_H03VillagerF53, "TRIGSTR_126", bj_TIMETYPE_SUB, 0.00, false)
    call VolumeGroupResetBJ()
    call TriggerSleepAction(0.30)
    if ( Trig_VillagerHello_Func007001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(gg_unit_nC08_0155, udg_Arthas, 0.20)
    call TriggerSleepAction(0.10)
    if ( Trig_VillagerHello_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitFacingToFaceUnitTimed(gg_unit_nC09_0001, udg_Arthas, 0.20)
endfunction

//===========================================================================
function InitTrig_VillagerHello takes nothing returns nothing
    set gg_trg_VillagerHello=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_VillagerHello, gg_rct_VillagerHello02)
    call TriggerAddCondition(gg_trg_VillagerHello, Condition(function Trig_VillagerHello_Conditions))
    call TriggerAddAction(gg_trg_VillagerHello, function Trig_VillagerHello_Actions)
endfunction

//===========================================================================
// Trigger: Marie Killed
//===========================================================================
function Trig_Marie_Killed_Actions takes nothing returns nothing
    call StopSoundBJ(gg_snd_H03VillagerF53, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_Marie_Killed takes nothing returns nothing
    set gg_trg_Marie_Killed=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Marie_Killed, gg_unit_nC04_0118, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_Marie_Killed, function Trig_Marie_Killed_Actions)
endfunction

//===========================================================================
// Trigger: VillagerHello01
//===========================================================================
function Trig_VillagerHello01_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nvil_0010) == true ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerHello01_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssueImmediateOrderBJ(gg_unit_nvil_0010, "stop")
    call SetUnitFacingToFaceUnitTimed(gg_unit_nvil_0010, udg_Arthas, 0.20)
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nvil_0010, "TRIGSTR_175", gg_snd_H03VillagerM41, "TRIGSTR_176", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_VillagerHello01 takes nothing returns nothing
    set gg_trg_VillagerHello01=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_VillagerHello01, gg_rct_VillagerHello01)
    call TriggerAddCondition(gg_trg_VillagerHello01, Condition(function Trig_VillagerHello01_Conditions))
    call TriggerAddAction(gg_trg_VillagerHello01, function Trig_VillagerHello01_Actions)
endfunction

//===========================================================================
// Trigger: Farmer Killed
//===========================================================================
function Trig_Farmer_Killed_Actions takes nothing returns nothing
    call StopSoundBJ(gg_snd_H03VillagerM41, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_Farmer_Killed takes nothing returns nothing
    set gg_trg_Farmer_Killed=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Farmer_Killed, gg_unit_nvil_0010, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_Farmer_Killed, function Trig_Farmer_Killed_Actions)
endfunction

//===========================================================================
// Trigger: VillagerTaxesMessage
//===========================================================================
function Trig_VillagerTaxesMessage_Func004001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_VillagerTaxesMessage_Func005001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC01_0002) == true )
endfunction

function Trig_VillagerTaxesMessage_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call SetUnitFacingToFaceUnitTimed(gg_unit_nC01_0002, udg_Arthas, 0.20)
    call TriggerSleepAction(0.20)
    if ( Trig_VillagerTaxesMessage_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_VillagerTaxesMessage_Func005001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC01_0002, "TRIGSTR_056", gg_snd_H03VillagerM45, "TRIGSTR_058", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_VillagerTaxesMessage takes nothing returns nothing
    set gg_trg_VillagerTaxesMessage=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_VillagerTaxesMessage, gg_unit_nC01_0002, EVENT_UNIT_SELECTED)
    call TriggerAddAction(gg_trg_VillagerTaxesMessage, function Trig_VillagerTaxesMessage_Actions)
endfunction

//===========================================================================
// Trigger: TaxEvader Killed
//===========================================================================
function Trig_TaxEvader_Killed_Actions takes nothing returns nothing
    call StopSoundBJ(gg_snd_H03VillagerM45, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_TaxEvader_Killed takes nothing returns nothing
    set gg_trg_TaxEvader_Killed=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_TaxEvader_Killed, gg_unit_nC01_0002, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_TaxEvader_Killed, function Trig_TaxEvader_Killed_Actions)
endfunction

//===========================================================================
// Trigger: ClicksMetGold
//===========================================================================
function Trig_ClicksMetGold_Conditions takes nothing returns boolean
    if ( not ( udg_Tax >= 50 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClicksMetGold_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call ConditionalTriggerExecute(gg_trg_PayoutGold)
endfunction

//===========================================================================
function InitTrig_ClicksMetGold takes nothing returns nothing
    set gg_trg_ClicksMetGold=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_ClicksMetGold, gg_unit_nC01_0002, EVENT_UNIT_SELECTED)
    call TriggerAddCondition(gg_trg_ClicksMetGold, Condition(function Trig_ClicksMetGold_Conditions))
    call TriggerAddAction(gg_trg_ClicksMetGold, function Trig_ClicksMetGold_Actions)
endfunction

//===========================================================================
// Trigger: ClicksMetItem
//===========================================================================
function Trig_ClicksMetItem_Conditions takes nothing returns boolean
    if ( not ( udg_Tax >= 100 ) ) then
        return false
    endif
    return true
endfunction

function Trig_ClicksMetItem_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call ConditionalTriggerExecute(gg_trg_PayoutItem)
endfunction

//===========================================================================
function InitTrig_ClicksMetItem takes nothing returns nothing
    set gg_trg_ClicksMetItem=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_ClicksMetItem, gg_unit_nC01_0002, EVENT_UNIT_SELECTED)
    call TriggerAddCondition(gg_trg_ClicksMetItem, Condition(function Trig_ClicksMetItem_Conditions))
    call TriggerAddAction(gg_trg_ClicksMetItem, function Trig_ClicksMetItem_Actions)
endfunction

//===========================================================================
// Trigger: PayoutGold
//===========================================================================
function Trig_PayoutGold_Actions takes nothing returns nothing
    call status_check_location(24)
    call AdjustPlayerStateBJ(( 21 * GetRandomInt(1, 10) ), Player(1), PLAYER_STATE_RESOURCE_GOLD)
endfunction

//===========================================================================
function InitTrig_PayoutGold takes nothing returns nothing
    set gg_trg_PayoutGold=CreateTrigger()
    call TriggerAddAction(gg_trg_PayoutGold, function Trig_PayoutGold_Actions)
endfunction

//===========================================================================
// Trigger: PayoutItem
//===========================================================================
function Trig_PayoutItem_Actions takes nothing returns nothing
    call CreateItemLoc('phea', GetRectCenter(gg_rct_VillagerTaxes))
    call SetUnitFacingToFaceLocTimed(gg_unit_nC01_0002, GetRectCenter(gg_rct_TaxVillagerFace), 0.20)
endfunction

//===========================================================================
function InitTrig_PayoutItem takes nothing returns nothing
    set gg_trg_PayoutItem=CreateTrigger()
    call TriggerAddAction(gg_trg_PayoutItem, function Trig_PayoutItem_Actions)
endfunction

//===========================================================================
// Trigger: Clicks
//===========================================================================
function Trig_Clicks_Actions takes nothing returns nothing
    set udg_Tax=( udg_Tax + 1 )
endfunction

//===========================================================================
function InitTrig_Clicks takes nothing returns nothing
    set gg_trg_Clicks=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Clicks, gg_unit_nC01_0002, EVENT_UNIT_SELECTED)
    call TriggerAddAction(gg_trg_Clicks, function Trig_Clicks_Actions)
endfunction

//===========================================================================
// Trigger: VillagerBridgeOutMessage
//===========================================================================
function Trig_VillagerBridgeOutMessage_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nC02_0039) == true ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerBridgeOutMessage_Func004001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC02_0039) == true )
endfunction

function Trig_VillagerBridgeOutMessage_Func006001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0123) == true )
endfunction

function Trig_VillagerBridgeOutMessage_Func010001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC02_0039) == true )
endfunction

function Trig_VillagerBridgeOutMessage_Func011001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0120) == true )
endfunction

function Trig_VillagerBridgeOutMessage_Func012001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0124) == true )
endfunction

function Trig_VillagerBridgeOutMessage_Func013001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_VillagerBridgeOutMessage_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_VillagerBridgeOutMessage)
    call SetUnitFacingToFaceUnitTimed(gg_unit_nC02_0039, udg_Arthas, 0.25)
    call TriggerSleepAction(0.50)
    if ( Trig_VillagerBridgeOutMessage_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call IssuePointOrderLocBJ(gg_unit_nC02_0039, "move", GetRectCenter(gg_rct_BridgeOutVillagerDestination))
    if ( Trig_VillagerBridgeOutMessage_Func006001() ) then
        call SetUnitFacingToFaceUnitTimed(gg_unit_nvil_0123, udg_Arthas, 0.20)
    else
        call DoNothing()
    endif
    call DestroyEffectBJ(udg_AchillesBang)
    call TriggerSleepAction(1.00)
    call SetUnitFacingToFaceUnitTimed(gg_unit_nvil_0119, udg_Arthas, 0.20)
    if ( Trig_VillagerBridgeOutMessage_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_VillagerBridgeOutMessage_Func011001() ) then
        call SetUnitFacingToFaceUnitTimed(gg_unit_nvil_0123, udg_Arthas, 0.20)
    else
        call DoNothing()
    endif
    if ( Trig_VillagerBridgeOutMessage_Func012001() ) then
        call SetUnitFacingToFaceUnitTimed(gg_unit_nvil_0123, udg_Arthas, 0.20)
    else
        call DoNothing()
    endif
    if ( Trig_VillagerBridgeOutMessage_Func013001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC02_0039, "TRIGSTR_059", gg_snd_H03VillagerM40, "TRIGSTR_060", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
    call PingMinimapLocForForce(GetPlayersAll(), GetRectCenter(gg_rct_RiverRouteVisibility), 10.00)
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_RiverRouteVisibility), 1024.00)
    set udg_RiverRouteVis=GetLastCreatedFogModifier()
    call SetCameraQuickPositionLocForPlayer(Player(1), GetRectCenter(gg_rct_RiverRouteVisibility))
    call TriggerSleepAction(5.00)
    call DestroyFogModifier(udg_RiverRouteVis)
    call DestroyFogModifier(udg_BridgeVis)
endfunction

//===========================================================================
function InitTrig_VillagerBridgeOutMessage takes nothing returns nothing
    set gg_trg_VillagerBridgeOutMessage=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_VillagerBridgeOutMessage, gg_rct_BridgeOut)
    call TriggerAddCondition(gg_trg_VillagerBridgeOutMessage, Condition(function Trig_VillagerBridgeOutMessage_Conditions))
    call TriggerAddAction(gg_trg_VillagerBridgeOutMessage, function Trig_VillagerBridgeOutMessage_Actions)
endfunction

//===========================================================================
// Trigger: Achilles Dead
//===========================================================================
function Trig_Achilles_Dead_Actions takes nothing returns nothing
    call DestroyEffectBJ(udg_AchillesBang)
    call StopSoundBJ(gg_snd_H03VillagerM40, false)
    call VolumeGroupResetBJ()
    call DestroyFogModifier(udg_RiverRouteVis)
endfunction

//===========================================================================
function InitTrig_Achilles_Dead takes nothing returns nothing
    set gg_trg_Achilles_Dead=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Achilles_Dead, gg_unit_nC02_0039, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_Achilles_Dead, function Trig_Achilles_Dead_Actions)
endfunction

//===========================================================================
// Trigger: MurlocPatrol
//===========================================================================
function Trig_MurlocPatrol_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(gg_unit_nmrl_0014, "patrol", GetRectCenter(gg_rct_MurlocPatrolPoint02))
endfunction

//===========================================================================
function InitTrig_MurlocPatrol takes nothing returns nothing
    set gg_trg_MurlocPatrol=CreateTrigger()
    call TriggerRegisterTimerEventSingle(gg_trg_MurlocPatrol, 5)
    call TriggerAddAction(gg_trg_MurlocPatrol, function Trig_MurlocPatrol_Actions)
endfunction

//===========================================================================
// Trigger: MurlocObserver
//===========================================================================
function Trig_MurlocObserver_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_MurlocObserver_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call IssuePointOrderLocBJ(gg_unit_nmrl_0023, "move", GetRectCenter(gg_rct_MurlocObserverDestination))
endfunction

//===========================================================================
function InitTrig_MurlocObserver takes nothing returns nothing
    set gg_trg_MurlocObserver=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_MurlocObserver, gg_rct_MurlocArea)
    call TriggerAddCondition(gg_trg_MurlocObserver, Condition(function Trig_MurlocObserver_Conditions))
    call TriggerAddAction(gg_trg_MurlocObserver, function Trig_MurlocObserver_Actions)
endfunction

//===========================================================================
// Trigger: VillagerSplendora
//
// Run from 'BanditsAllDie'
//===========================================================================
function Trig_VillagerSplendora_Conditions takes nothing returns boolean
    if ( not ( IsUnitAliveBJ(gg_unit_nC10_0121) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerSplendora_Actions takes nothing returns nothing
    call IssueTargetOrderBJ(gg_unit_nC10_0121, "move", udg_Arthas)
    call EnableTrigger(gg_trg_VillagerInRange)
endfunction

//===========================================================================
function InitTrig_VillagerSplendora takes nothing returns nothing
    set gg_trg_VillagerSplendora=CreateTrigger()
    call TriggerAddCondition(gg_trg_VillagerSplendora, Condition(function Trig_VillagerSplendora_Conditions))
    call TriggerAddAction(gg_trg_VillagerSplendora, function Trig_VillagerSplendora_Actions)
endfunction

//===========================================================================
// Trigger: VillagerInRange
//===========================================================================
function Trig_VillagerInRange_Conditions takes nothing returns boolean
    if ( not ( DistanceBetweenPoints(GetUnitLoc(gg_unit_nC10_0121), GetUnitLoc(udg_Arthas)) <= 400.00 ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_VillagerInRange_Func004001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC10_0121) == true )
endfunction

function Trig_VillagerInRange_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call DisableTrigger(gg_trg_VillagerSplendora)
    call IssuePointOrderLocBJ(gg_unit_nC10_0121, "move", GetUnitLoc(udg_Arthas))
    if ( Trig_VillagerInRange_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call TriggerSleepAction(1.00)
    call IssueImmediateOrderBJ(gg_unit_nC10_0121, "stop")
    call GroupAddUnitSimple(gg_unit_nC10_0121, udg_PeasantPatrolGroup01)
    call QueuedTriggerAddBJ(gg_trg_Que_Splendora_Speech, true)
endfunction

//===========================================================================
function InitTrig_VillagerInRange takes nothing returns nothing
    set gg_trg_VillagerInRange=CreateTrigger()
    call DisableTrigger(gg_trg_VillagerInRange)
    call TriggerRegisterTimerEventPeriodic(gg_trg_VillagerInRange, 0.50)
    call TriggerAddCondition(gg_trg_VillagerInRange, Condition(function Trig_VillagerInRange_Conditions))
    call TriggerAddAction(gg_trg_VillagerInRange, function Trig_VillagerInRange_Actions)
endfunction

//===========================================================================
// Trigger: Que Splendora Speech
//===========================================================================
function Trig_Que_Splendora_Speech_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Que_Splendora_Speech_Func002001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC10_0121) == true )
endfunction

function Trig_Que_Splendora_Speech_Func003001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC10_0121) == true )
endfunction

function Trig_Que_Splendora_Speech_Func010001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Que_Splendora_Speech_Actions takes nothing returns nothing
    if ( Trig_Que_Splendora_Speech_Func002001() ) then
        call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    else
        call DoNothing()
    endif
    if ( Trig_Que_Splendora_Speech_Func003001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC10_0121, "TRIGSTR_671", gg_snd_H01VillagerF42, "TRIGSTR_672", bj_TIMETYPE_SUB, 0.00, true)
    call VolumeGroupResetBJ()
    call CreateItemLoc('pghe', GetUnitLoc(udg_Arthas))
    call UnitAddItemSwapped(GetLastCreatedItem(), udg_Arthas)
    call TriggerSleepAction(bj_QUEUE_DELAY_HINT)
    if ( Trig_Que_Splendora_Speech_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_ITEMACQUIRED, "TRIGSTR_673")
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Que_Splendora_Speech takes nothing returns nothing
    set gg_trg_Que_Splendora_Speech=CreateTrigger()
    call TriggerAddCondition(gg_trg_Que_Splendora_Speech, Condition(function Trig_Que_Splendora_Speech_Conditions))
    call TriggerAddAction(gg_trg_Que_Splendora_Speech, function Trig_Que_Splendora_Speech_Actions)
endfunction

//===========================================================================
// Trigger: VillagerDies
//===========================================================================
function Trig_VillagerDies_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_VillagerSplendora)
    call DisableTrigger(gg_trg_VillagerInRange)
    call StopSoundBJ(gg_snd_H01VillagerF42, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_VillagerDies takes nothing returns nothing
    set gg_trg_VillagerDies=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_VillagerDies, gg_unit_nC10_0121, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_VillagerDies, function Trig_VillagerDies_Actions)
endfunction

//===========================================================================
// Trigger: StartAttack
//===========================================================================
function Trig_StartAttack_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_StartAttack_Func013001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nban_0046) == true )
endfunction

function Trig_StartAttack_Func015001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_StartAttack_Func028001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0024) == true )
endfunction

function Trig_StartAttack_Func037001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_StartAttack_Func039001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nban_0046) == true )
endfunction

function Trig_StartAttack_Func040001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0024) == true )
endfunction

function Trig_StartAttack_Func045001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_StartAttack_Func046001002 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_StartAttack_Func046002 takes nothing returns nothing
    call SetUnitFacingToFaceLocTimed(GetEnumUnit(), GetRectCenter(gg_rct_VillageRunDest01), 0.20)
endfunction

function Trig_StartAttack_Func048001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nban_0126) == true )
endfunction

function Trig_StartAttack_Func049001 takes nothing returns boolean
    return ( IsUnitAliveBJ(gg_unit_nvil_0116) == true )
endfunction

function Trig_StartAttack_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call DisableTrigger(gg_trg_PeasantPatrolSmall)
    call SetPlayerAllianceStateBJ(Player(PLAYER_NEUTRAL_AGGRESSIVE), Player(2), bj_ALLIANCE_UNALLIED)
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_BANDIT_SIGHT), 1024.00)
    set udg_BanditSightVis1=GetLastCreatedFogModifier()
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_BANDIT_SIGHT_2), 1024.00)
    set udg_BanditSightVis2=GetLastCreatedFogModifier()
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_BANDIT_SIGHT_3), 1024.00)
    set udg_BanditSightVis3=GetLastCreatedFogModifier()
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_BANDIT_SIGHT_4), 1024.00)
    set udg_BanditSightVis4=GetLastCreatedFogModifier()
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_StartAttack_Func013001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nban_0046, "TRIGSTR_186", gg_snd_H03Bandit51, "TRIGSTR_187", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    call VolumeGroupResetBJ()
    if ( Trig_StartAttack_Func015001() ) then
        return
    else
        call DoNothing()
    endif
    call IssueTargetOrderBJ(gg_unit_nban_0046, "attack", gg_unit_nvil_0049)
    call SetUnitLifeBJ(gg_unit_nvil_0033, 2.00)
    call SetUnitLifeBJ(gg_unit_nvil_0049, 2.00)
    call IssueTargetOrderBJ(gg_unit_nban_0044, "attack", gg_unit_nvil_0033)
    call IssueTargetOrderBJ(gg_unit_nban_0045, "attack", gg_unit_nC10_0121)
    call IssuePointOrderLocBJ(gg_unit_nvil_0125, "move", GetRectCenter(gg_rct_VillageRunDest01))
    call IssuePointOrderLocBJ(gg_unit_nvil_0024, "move", GetRectCenter(gg_rct_VillageRunDest02))
    call IssuePointOrderLocBJ(gg_unit_nvil_0022, "move", GetRectCenter(gg_rct_VillageRunDest03))
    call IssuePointOrderLocBJ(gg_unit_nvil_0048, "move", GetRectCenter(gg_rct_VillageRunDest04))
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_StartAttack_Func028001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nvil_0024, "TRIGSTR_202", gg_snd_H03VillagerM49, "TRIGSTR_203", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    call VolumeGroupResetBJ()
    call TriggerSleepAction(1.00)
    call IssuePointOrderLocBJ(gg_unit_nvil_0024, "move", GetRectCenter(gg_rct_VillageRunDest04))
    call IssuePointOrderLocBJ(gg_unit_nvil_0049, "move", GetRectCenter(gg_rct_VillageRunDest05))
    call IssuePointOrderLocBJ(gg_unit_nvil_0033, "move", GetRectCenter(gg_rct_VillageRunDest05))
    call IssuePointOrderLocBJ(gg_unit_nvil_0047, "move", GetRectCenter(gg_rct_VillageRunDest06))
    call IssuePointOrderLocBJ(gg_unit_nvil_0034, "move", GetRectCenter(gg_rct_VillageRunDest07))
    call TriggerSleepAction(2.00)
    if ( Trig_StartAttack_Func037001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_StartAttack_Func039001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nban_0046, "TRIGSTR_254", gg_snd_H03Bandit52, "TRIGSTR_255", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_StartAttack_Func040001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nvil_0024, "TRIGSTR_491", gg_snd_H03VillagerM50, "TRIGSTR_492", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    call VolumeGroupResetBJ()
    call IssuePointOrderLocBJ(gg_unit_nC10_0121, "move", GetRectCenter(gg_rct_VillageRunDest08))
    call EnableTrigger(gg_trg_SuicideBandits)
    call TriggerSleepAction(6.00)
    if ( Trig_StartAttack_Func045001() ) then
        return
    else
        call DoNothing()
    endif
    call ForGroupBJ(GetUnitsInRectMatching(gg_rct_PeasantPatrolArea, Condition(function Trig_StartAttack_Func046001002)), function Trig_StartAttack_Func046002)
    call TriggerSleepAction(9.00)
    if ( Trig_StartAttack_Func048001() ) then
        call IssueTargetOrderBJ(gg_unit_nban_0126, "attack", gg_unit_nvil_0116)
    else
        call DoNothing()
    endif
    if ( Trig_StartAttack_Func049001() ) then
        call SetUnitLifeBJ(gg_unit_nvil_0116, 20.00)
    else
        call DoNothing()
    endif
    call DestroyFogModifier(udg_BanditSightVis1)
    call DestroyFogModifier(udg_BanditSightVis2)
    call DestroyFogModifier(udg_BanditSightVis3)
    call DestroyFogModifier(udg_BanditSightVis4)
endfunction

//===========================================================================
function InitTrig_StartAttack takes nothing returns nothing
    set gg_trg_StartAttack=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_StartAttack, gg_rct_Bandit)
    call TriggerAddCondition(gg_trg_StartAttack, Condition(function Trig_StartAttack_Conditions))
    call TriggerAddAction(gg_trg_StartAttack, function Trig_StartAttack_Actions)
endfunction

//===========================================================================
// Trigger: SuicideBandits
//===========================================================================
function Trig_SuicideBandits_Conditions takes nothing returns boolean
    if ( not ( IsUnitGroupDeadBJ(udg_BanditsVillage) == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_SuicideBandits_Func003001001002001 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_SuicideBandits_Func003001001002002 takes nothing returns boolean
    return ( IsUnitInGroup(GetFilterUnit(), udg_BanditsVillage) == true )
endfunction

function Trig_SuicideBandits_Func003001001002 takes nothing returns boolean
    return GetBooleanAnd(Trig_SuicideBandits_Func003001001002001(), Trig_SuicideBandits_Func003001001002002())
endfunction

function Trig_SuicideBandits_Func004001001002001 takes nothing returns boolean
    return ( IsUnitAliveBJ(GetFilterUnit()) == true )
endfunction

function Trig_SuicideBandits_Func004001001002002 takes nothing returns boolean
    return ( IsUnitInGroup(GetFilterUnit(), udg_BanditsVillage) == true )
endfunction

function Trig_SuicideBandits_Func004001001002 takes nothing returns boolean
    return GetBooleanAnd(Trig_SuicideBandits_Func004001001002001(), Trig_SuicideBandits_Func004001001002002())
endfunction

function Trig_SuicideBandits_Actions takes nothing returns nothing
    call IssuePointOrderLocBJ(GroupPickRandomUnit(GetUnitsOfPlayerMatching(Player(PLAYER_NEUTRAL_AGGRESSIVE), Condition(function Trig_SuicideBandits_Func003001001002))), "attack", GetRandomLocInRect(gg_rct_Bandit))
    call IssuePointOrderLocBJ(GroupPickRandomUnit(GetUnitsOfPlayerMatching(Player(PLAYER_NEUTRAL_AGGRESSIVE), Condition(function Trig_SuicideBandits_Func004001001002))), "attack", GetRandomLocInRect(gg_rct_Bandit))
endfunction

//===========================================================================
function InitTrig_SuicideBandits takes nothing returns nothing
    set gg_trg_SuicideBandits=CreateTrigger()
    call DisableTrigger(gg_trg_SuicideBandits)
    call TriggerRegisterTimerEventPeriodic(gg_trg_SuicideBandits, 4.00)
    call TriggerAddCondition(gg_trg_SuicideBandits, Condition(function Trig_SuicideBandits_Conditions))
    call TriggerAddAction(gg_trg_SuicideBandits, function Trig_SuicideBandits_Actions)
endfunction

//===========================================================================
// Trigger: BanditsAllDie
//===========================================================================
function Trig_BanditsAllDie_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetDyingUnit(), udg_BanditsVillage) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_BanditsAllDie_Func004001 takes nothing returns boolean
    return ( CountUnitsInGroup(udg_BanditsVillage) <= 0 )
endfunction

function Trig_BanditsAllDie_Func005001 takes nothing returns boolean
    return ( CountUnitsInGroup(udg_BanditsVillage) <= 0 )
endfunction

function Trig_BanditsAllDie_Func006001 takes nothing returns boolean
    return ( CountUnitsInGroup(udg_BanditsVillage) <= 0 )
endfunction

function Trig_BanditsAllDie_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetDyingUnit(), udg_BanditsVillage)
    call GroupRemoveUnitSimple(gg_unit_nC10_0121, udg_PeasantPatrolGroup01)
    if ( Trig_BanditsAllDie_Func004001() ) then
        call EnableTrigger(gg_trg_PeasantPatrol)
    else
        call DoNothing()
    endif
    if ( Trig_BanditsAllDie_Func005001() ) then
        call DisableTrigger(gg_trg_SuicideBandits)
    else
        call DoNothing()
    endif
    if ( Trig_BanditsAllDie_Func006001() ) then
        call ConditionalTriggerExecute(gg_trg_VillagerSplendora)
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_BanditsAllDie takes nothing returns nothing
    set gg_trg_BanditsAllDie=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_BanditsAllDie, Player(PLAYER_NEUTRAL_AGGRESSIVE), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_BanditsAllDie, Condition(function Trig_BanditsAllDie_Conditions))
    call TriggerAddAction(gg_trg_BanditsAllDie, function Trig_BanditsAllDie_Actions)
endfunction

//===========================================================================
// Trigger: Marie
//===========================================================================
function Trig_Marie_Actions takes nothing returns nothing
    call AttachSoundToUnitBJ(gg_snd_H01VillagerF39, gg_unit_nC04_0118)
    call PlaySoundBJ(gg_snd_H01VillagerF39)
    call UnitAddIndicatorBJ(gg_unit_nC04_0118, 100, 100, 100, 0)
endfunction

//===========================================================================
function InitTrig_Marie takes nothing returns nothing
    set gg_trg_Marie=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Marie, gg_unit_nC04_0118, EVENT_UNIT_SELECTED)
    call TriggerAddAction(gg_trg_Marie, function Trig_Marie_Actions)
endfunction

//===========================================================================
// Trigger: Linda
//===========================================================================
function Trig_Linda_Actions takes nothing returns nothing
    call AttachSoundToUnitBJ(gg_snd_H01VillagerF40, gg_unit_nC08_0155)
    call PlaySoundBJ(gg_snd_H01VillagerF40)
    call UnitAddIndicatorBJ(gg_unit_nC08_0155, 100, 100, 100, 0)
endfunction

//===========================================================================
function InitTrig_Linda takes nothing returns nothing
    set gg_trg_Linda=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Linda, gg_unit_nC08_0155, EVENT_UNIT_SELECTED)
    call TriggerAddAction(gg_trg_Linda, function Trig_Linda_Actions)
endfunction

//===========================================================================
// Trigger: Jillian
//===========================================================================
function Trig_Jillian_Actions takes nothing returns nothing
    call AttachSoundToUnitBJ(gg_snd_H01VillagerF41, gg_unit_nC09_0001)
    call PlaySoundBJ(gg_snd_H01VillagerF41)
    call UnitAddIndicatorBJ(gg_unit_nC09_0001, 100, 100, 100, 0)
endfunction

//===========================================================================
function InitTrig_Jillian takes nothing returns nothing
    set gg_trg_Jillian=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Jillian, gg_unit_nC09_0001, EVENT_UNIT_SELECTED)
    call TriggerAddAction(gg_trg_Jillian, function Trig_Jillian_Actions)
endfunction

//===========================================================================
// Trigger: FountainSideQuest
//===========================================================================
function Trig_FountainSideQuest_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(gg_unit_nC03_0092) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_FountainSideQuest_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerAddBJ(gg_trg_FountainSideQuest_Que, true)
endfunction

//===========================================================================
function InitTrig_FountainSideQuest takes nothing returns nothing
    set gg_trg_FountainSideQuest=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_FountainSideQuest, gg_rct_VillagerActivateFountainQuest)
    call TriggerAddCondition(gg_trg_FountainSideQuest, Condition(function Trig_FountainSideQuest_Conditions))
    call TriggerAddAction(gg_trg_FountainSideQuest, function Trig_FountainSideQuest_Actions)
endfunction

//===========================================================================
// Trigger: FountainSideQuest Que
//===========================================================================
function Trig_FountainSideQuest_Que_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_FountainSideQuest_Que_Func004001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC03_0092) == true )
endfunction

function Trig_FountainSideQuest_Que_Func005001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC03_0092) == true )
endfunction

function Trig_FountainSideQuest_Que_Func007001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_FountainSideQuest_Que_Func008001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC03_0092) == true )
endfunction

function Trig_FountainSideQuest_Que_Func009001 takes nothing returns boolean
    return ( IsUnitDeadBJ(gg_unit_nC03_0092) == true )
endfunction

function Trig_FountainSideQuest_Que_Func012001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_FountainSideQuest_Que_Func019001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_FountainSideQuest_Que_Actions takes nothing returns nothing
    call DestroyEffectBJ(udg_AlricBang)
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_FountainSideQuest_Que_Func004001() ) then
        call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    else
        call DoNothing()
    endif
    if ( Trig_FountainSideQuest_Que_Func005001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_nC03_0092, "TRIGSTR_682", gg_snd_H03VillagerM10, "TRIGSTR_683", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_FountainSideQuest_Que_Func007001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_FountainSideQuest_Que_Func008001() ) then
        call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    else
        call DoNothing()
    endif
    if ( Trig_FountainSideQuest_Que_Func009001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestSetDiscoveredBJ(udg_QuestFountain, true)
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_684", gg_snd_H03Arthas11, "TRIGSTR_685", bj_TIMETYPE_ADD, 0.00, true)
    if ( Trig_FountainSideQuest_Que_Func012001() ) then
        return
    else
        call DoNothing()
    endif
    call SetCameraQuickPositionLocForPlayer(Player(1), GetRectCenter(gg_rct_FountainOfLifeReveal))
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_FountainOfLifeReveal), 512.00)
    call DestroyFogModifier(GetLastCreatedFogModifier())
    call PingMinimapLocForForce(GetPlayersAll(), GetRectCenter(gg_rct_FountainOfLifeReveal), 5.00)
    call VolumeGroupResetBJ()
    call TriggerSleepAction(1.00)
    if ( Trig_FountainSideQuest_Que_Func019001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_DISCOVERED, "TRIGSTR_686")
    call TriggerSleepAction(2.00)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_FountainSkeleton01), 340.00)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_FountainSkeleton02), 0.00)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_FountainSideQuest_Que takes nothing returns nothing
    set gg_trg_FountainSideQuest_Que=CreateTrigger()
    call TriggerAddCondition(gg_trg_FountainSideQuest_Que, Condition(function Trig_FountainSideQuest_Que_Conditions))
    call TriggerAddAction(gg_trg_FountainSideQuest_Que, function Trig_FountainSideQuest_Que_Actions)
endfunction

//===========================================================================
// Trigger: Alric is Killed
//===========================================================================
function Trig_Alric_is_Killed_Actions takes nothing returns nothing
    call StopSoundBJ(gg_snd_H03VillagerM10, false)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_Alric_is_Killed takes nothing returns nothing
    set gg_trg_Alric_is_Killed=CreateTrigger()
    call TriggerRegisterUnitEvent(gg_trg_Alric_is_Killed, gg_unit_nC03_0092, EVENT_UNIT_DEATH)
    call TriggerAddAction(gg_trg_Alric_is_Killed, function Trig_Alric_is_Killed_Actions)
endfunction

//===========================================================================
// Trigger: Fountain Found
//===========================================================================
function Trig_Fountain_Found_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( IsQuestDiscovered(udg_QuestFountain) == true ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Fountain_Found_Func010001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Fountain_Found_Func016001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Fountain_Found_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_Fountain_Found)
    call status_check_location(21)
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_115", gg_snd_H03Arthas12, "TRIGSTR_116", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
    call TriggerSleepAction(1.00)
    if ( Trig_Fountain_Found_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_COMPLETED, "TRIGSTR_123")
    call QuestItemSetCompletedBJ(udg_QuestFountainReq, true)
    call FlashQuestDialogButtonBJ()
    call QuestSetCompletedBJ(udg_QuestFountain, true)
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    if ( Trig_Fountain_Found_Func016001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_ALWAYSHINT, "TRIGSTR_670")
endfunction

//===========================================================================
function InitTrig_Fountain_Found takes nothing returns nothing
    set gg_trg_Fountain_Found=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Fountain_Found, gg_rct_FountainOfLifeZone)
    call TriggerAddCondition(gg_trg_Fountain_Found, Condition(function Trig_Fountain_Found_Conditions))
    call TriggerAddAction(gg_trg_Fountain_Found, function Trig_Fountain_Found_Actions)
endfunction

//===========================================================================
// Trigger: StartDefend
//===========================================================================
function Trig_StartDefend_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_StartDefend_Func008002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GetEnumUnit(), "attack", GetRectCenter(gg_rct_DefendZone))
endfunction

function Trig_StartDefend_Func010001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_StartDefend_Func027001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_StartDefend_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call PanCameraToTimedLocForPlayer(Player(1), GetRectCenter(gg_rct_ArcherPanCamera), 1.00)
    call SetPlayerAllianceStateBJ(Player(6), Player(9), bj_ALLIANCE_UNALLIED)
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_ArcherVisibility), 1024.00)
    set udg_ArcherVis=GetLastCreatedFogModifier()
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_SkeletonArchers), function Trig_StartDefend_Func008002)
    call TriggerSleepAction(1.00)
    if ( Trig_StartDefend_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    call SetSpeechVolumeGroupsBJ()
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), gg_unit_hfoo_0042, "TRIGSTR_024", gg_snd_H03Footman13, "TRIGSTR_046", bj_TIMETYPE_ADD, 0.00, false)
    call TriggerSleepAction(2.00)
    call AttachSoundToUnitBJ(gg_snd_DefendCaster, gg_unit_hfoo_0042)
    call PlaySoundBJ(gg_snd_DefendCaster)
    call IssueImmediateOrderBJ(gg_unit_hfoo_0042, "defend")
    call TriggerSleepAction(0.10)
    call AttachSoundToUnitBJ(gg_snd_DefendCaster01, gg_unit_hfoo_0043)
    call PlaySoundBJ(gg_snd_DefendCaster01)
    call IssueImmediateOrderBJ(gg_unit_hfoo_0043, "defend")
    call TriggerSleepAction(0.20)
    call AttachSoundToUnitBJ(gg_snd_DefendCaster02, gg_unit_hfoo_0005)
    call PlaySoundBJ(gg_snd_DefendCaster02)
    call IssueImmediateOrderBJ(gg_unit_hfoo_0005, "defend")
    call TriggerSleepAction(2.00)
    call WaitForSoundBJ(gg_snd_H03Footman13, 0)
    if ( Trig_StartDefend_Func027001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_047", gg_snd_H03Arthas17, "TRIGSTR_049", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
endfunction

//===========================================================================
function InitTrig_StartDefend takes nothing returns nothing
    set gg_trg_StartDefend=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_StartDefend, gg_rct_DefendZone)
    call TriggerAddCondition(gg_trg_StartDefend, Condition(function Trig_StartDefend_Conditions))
    call TriggerAddAction(gg_trg_StartDefend, function Trig_StartDefend_Actions)
endfunction

//===========================================================================
// Trigger: SkeletonsDyingCheck
//===========================================================================
function Trig_SkeletonsDyingCheck_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetDyingUnit(), udg_SkeletonsArcher) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_SkeletonsDyingCheck_Func004001 takes nothing returns boolean
    return ( CountUnitsInGroup(udg_SkeletonsArcher) <= 0 )
endfunction

function Trig_SkeletonsDyingCheck_Func005001 takes nothing returns boolean
    return ( CountUnitsInGroup(udg_SkeletonsArcher) <= 0 )
endfunction

function Trig_SkeletonsDyingCheck_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetDyingUnit(), udg_SkeletonsArcher)
    call DestroyFogModifier(udg_ArcherVis)
    if ( Trig_SkeletonsDyingCheck_Func004001() ) then
        call QueuedTriggerAddBJ(gg_trg_SkeletonsAllDead, true)
    else
        call DoNothing()
    endif
    if ( Trig_SkeletonsDyingCheck_Func005001() ) then
        call DisableTrigger(GetTriggeringTrigger())
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_SkeletonsDyingCheck takes nothing returns nothing
    set gg_trg_SkeletonsDyingCheck=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_SkeletonsDyingCheck, Player(6), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_SkeletonsDyingCheck, Condition(function Trig_SkeletonsDyingCheck_Conditions))
    call TriggerAddAction(gg_trg_SkeletonsDyingCheck, function Trig_SkeletonsDyingCheck_Actions)
endfunction

//===========================================================================
// Trigger: SkeletonsAllDead
//===========================================================================
function Trig_SkeletonsAllDead_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_SkeletonsAllDead_Func004001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_SkeletonsAllDead_Func006002 takes nothing returns nothing
    call IssueImmediateOrderBJ(GetEnumUnit(), "stop")
endfunction

function Trig_SkeletonsAllDead_Func007002 takes nothing returns nothing
    call SetUnitFacingToFaceUnitTimed(GetEnumUnit(), udg_Arthas, 0.20)
endfunction

function Trig_SkeletonsAllDead_Func009001 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_DefendersGroup) == false )
endfunction

function Trig_SkeletonsAllDead_Func010001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_SkeletonsAllDead_Func011001 takes nothing returns boolean
    return ( IsUnitGroupDeadBJ(udg_DefendersGroup) == false )
endfunction

function Trig_SkeletonsAllDead_Func012001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_SkeletonsAllDead_Func015002 takes nothing returns nothing
    call RescueUnitBJ(GetEnumUnit(), Player(1), true)
endfunction

function Trig_SkeletonsAllDead_Func016002 takes nothing returns nothing
    call IssueImmediateOrderBJ(GetEnumUnit(), "undefend")
endfunction

function Trig_SkeletonsAllDead_Func018001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_SkeletonsAllDead_Actions takes nothing returns nothing
    call DisableTrigger(gg_trg_SkeletonsDyingCheck)
    call TriggerSleepAction(1.00)
    if ( Trig_SkeletonsAllDead_Func004001() ) then
        return
    else
        call DoNothing()
    endif
    call status_check_location(20)
    call ForGroupBJ(udg_FootmenDefending, function Trig_SkeletonsAllDead_Func006002)
    call ForGroupBJ(udg_FootmenDefending, function Trig_SkeletonsAllDead_Func007002)
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_SkeletonsAllDead_Func009001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_362", gg_snd_H03Arthas14, "TRIGSTR_363", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_SkeletonsAllDead_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_SkeletonsAllDead_Func011001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), GroupPickRandomUnit(udg_DefendersGroup), "TRIGSTR_334", gg_snd_H03Footman15, "TRIGSTR_335", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_SkeletonsAllDead_Func012001() ) then
        return
    else
        call DoNothing()
    endif
    call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_069", gg_snd_H03Arthas16, "TRIGSTR_070", bj_TIMETYPE_ADD, 0.00, true)
    call VolumeGroupResetBJ()
    call ForGroupBJ(udg_FootmenDefending, function Trig_SkeletonsAllDead_Func015002)
    call ForGroupBJ(udg_FootmenDefending, function Trig_SkeletonsAllDead_Func016002)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
    if ( Trig_SkeletonsAllDead_Func018001() ) then
        return
    else
        call DoNothing()
    endif
    call QueuedTriggerAddBJ(gg_trg_Defend_Hint_Que, true)
endfunction

//===========================================================================
function InitTrig_SkeletonsAllDead takes nothing returns nothing
    set gg_trg_SkeletonsAllDead=CreateTrigger()
    call TriggerAddCondition(gg_trg_SkeletonsAllDead, Condition(function Trig_SkeletonsAllDead_Conditions))
    call TriggerAddAction(gg_trg_SkeletonsAllDead, function Trig_SkeletonsAllDead_Actions)
endfunction

//===========================================================================
// Trigger: Defend Hint Que
//===========================================================================
function Trig_Defend_Hint_Que_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Defend_Hint_Que_Func003001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_Defend_Hint_Que_Actions takes nothing returns nothing
    call TriggerSleepAction(2)
    if ( Trig_Defend_Hint_Que_Func003001() ) then
        return
    else
        call DoNothing()
    endif
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_HINT, "TRIGSTR_300")
    call TriggerSleepAction(bj_QUEUE_DELAY_HINT)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Defend_Hint_Que takes nothing returns nothing
    set gg_trg_Defend_Hint_Que=CreateTrigger()
    call TriggerAddCondition(gg_trg_Defend_Hint_Que, Condition(function Trig_Defend_Hint_Que_Conditions))
    call TriggerAddAction(gg_trg_Defend_Hint_Que, function Trig_Defend_Hint_Que_Actions)
endfunction

//===========================================================================
// Trigger: RemoveDeadFromGroup
//===========================================================================
function Trig_RemoveDeadFromGroup_Conditions takes nothing returns boolean
    if ( not ( IsUnitInGroup(GetDyingUnit(), udg_FootmenDefending) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_RemoveDeadFromGroup_Actions takes nothing returns nothing
    call GroupRemoveUnitSimple(GetDyingUnit(), udg_FootmenDefending)
endfunction

//===========================================================================
function InitTrig_RemoveDeadFromGroup takes nothing returns nothing
    set gg_trg_RemoveDeadFromGroup=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_RemoveDeadFromGroup, Player(9), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_RemoveDeadFromGroup, Condition(function Trig_RemoveDeadFromGroup_Conditions))
    call TriggerAddAction(gg_trg_RemoveDeadFromGroup, function Trig_RemoveDeadFromGroup_Actions)
endfunction

//===========================================================================
// Trigger: Holy Light Hint
//===========================================================================
function Trig_Holy_Light_Hint_Conditions takes nothing returns boolean
    if ( not ( GetEnteringUnit() == udg_Arthas ) ) then
        return false
    endif
    return true
endfunction

function Trig_Holy_Light_Hint_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call QueuedTriggerAddBJ(gg_trg_Holy_Light_Hint_Q, true)
endfunction

//===========================================================================
function InitTrig_Holy_Light_Hint takes nothing returns nothing
    set gg_trg_Holy_Light_Hint=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_Holy_Light_Hint, gg_rct_HolyLightHintArea)
    call TriggerAddCondition(gg_trg_Holy_Light_Hint, Condition(function Trig_Holy_Light_Hint_Conditions))
    call TriggerAddAction(gg_trg_Holy_Light_Hint, function Trig_Holy_Light_Hint_Actions)
endfunction

//===========================================================================
// Trigger: Holy Light Hint Q
//===========================================================================
function Trig_Holy_Light_Hint_Q_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_Holy_Light_Hint_Q_Actions takes nothing returns nothing
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_HINT, "TRIGSTR_540")
    call TriggerSleepAction(bj_QUEUE_DELAY_HINT)
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_Holy_Light_Hint_Q takes nothing returns nothing
    set gg_trg_Holy_Light_Hint_Q=CreateTrigger()
    call TriggerAddCondition(gg_trg_Holy_Light_Hint_Q, Condition(function Trig_Holy_Light_Hint_Q_Conditions))
    call TriggerAddAction(gg_trg_Holy_Light_Hint_Q, function Trig_Holy_Light_Hint_Q_Actions)
endfunction

//===========================================================================
// Trigger: AmbushStart
//===========================================================================
function Trig_AmbushStart_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_AmbushStart_Func004002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GetEnumUnit(), "attack", GetRectCenter(gg_rct_AmbushSkeletons))
endfunction

function Trig_AmbushStart_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(1.00)
    call ForGroupBJ(udg_SkeletonsAmbush, function Trig_AmbushStart_Func004002)
    // ***********************
endfunction

//===========================================================================
function InitTrig_AmbushStart takes nothing returns nothing
    set gg_trg_AmbushStart=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_AmbushStart, gg_rct_AmbushStart)
    call TriggerAddCondition(gg_trg_AmbushStart, Condition(function Trig_AmbushStart_Conditions))
    call TriggerAddAction(gg_trg_AmbushStart, function Trig_AmbushStart_Actions)
endfunction

//===========================================================================
// Trigger: AttackingSkeletons01
//===========================================================================
function Trig_AttackingSkeletons01_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_AttackingSkeletons01_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(1.00)
    call IssueTargetOrderBJ(gg_unit_uske_0066, "attack", gg_unit_nvil_0068)
    call IssueTargetOrderBJ(gg_unit_uske_0065, "attack", gg_unit_nvil_0068)
endfunction

//===========================================================================
function InitTrig_AttackingSkeletons01 takes nothing returns nothing
    set gg_trg_AttackingSkeletons01=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_AttackingSkeletons01, gg_rct_VillageRaiseSkeletonStart)
    call TriggerAddCondition(gg_trg_AttackingSkeletons01, Condition(function Trig_AttackingSkeletons01_Conditions))
    call TriggerAddAction(gg_trg_AttackingSkeletons01, function Trig_AttackingSkeletons01_Actions)
endfunction

//===========================================================================
// Trigger: AttackingSkeletons02
//===========================================================================
function Trig_AttackingSkeletons02_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_AttackingSkeletons02_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(1.00)
    call IssueTargetOrderBJ(gg_unit_uske_0098, "attack", gg_unit_nvil_0099)
endfunction

//===========================================================================
function InitTrig_AttackingSkeletons02 takes nothing returns nothing
    set gg_trg_AttackingSkeletons02=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_AttackingSkeletons02, gg_rct_VillageRaiseSkeletonStart)
    call TriggerAddCondition(gg_trg_AttackingSkeletons02, Condition(function Trig_AttackingSkeletons02_Conditions))
    call TriggerAddAction(gg_trg_AttackingSkeletons02, function Trig_AttackingSkeletons02_Actions)
endfunction

//===========================================================================
// Trigger: AttackingSkeletons03
//===========================================================================
function Trig_AttackingSkeletons03_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    return true
endfunction

function Trig_AttackingSkeletons03_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call TriggerSleepAction(1.00)
    call IssuePointOrderLocBJ(gg_unit_nvil_0085, "move", GetRectCenter(gg_rct_VillagerRunDest09))
    call IssueTargetOrderBJ(gg_unit_uske_0069, "attack", gg_unit_nvil_0085)
    call IssueTargetOrderBJ(gg_unit_nska_0105, "attack", gg_unit_nvil_0085)
endfunction

//===========================================================================
function InitTrig_AttackingSkeletons03 takes nothing returns nothing
    set gg_trg_AttackingSkeletons03=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_AttackingSkeletons03, gg_rct_VillageRaiseSkeletonStart)
    call TriggerAddCondition(gg_trg_AttackingSkeletons03, Condition(function Trig_AttackingSkeletons03_Conditions))
    call TriggerAddAction(gg_trg_AttackingSkeletons03, function Trig_AttackingSkeletons03_Actions)
endfunction

//===========================================================================
// Trigger: CrateSkeleton01
//===========================================================================
function Trig_CrateSkeleton01_Actions takes nothing returns nothing
    call TriggerSleepAction(0.10)
    call CreateNUnitsAtLoc(1, 'uske', Player(6), GetRectCenter(gg_rct_CrateSkeleton01), 65.00)
    call SetUnitAnimation(GetLastCreatedUnit(), "birth")
endfunction

//===========================================================================
function InitTrig_CrateSkeleton01 takes nothing returns nothing
    set gg_trg_CrateSkeleton01=CreateTrigger()
    call TriggerRegisterDeathEvent(gg_trg_CrateSkeleton01, gg_dest_LTcr_1798)
    call TriggerAddAction(gg_trg_CrateSkeleton01, function Trig_CrateSkeleton01_Actions)
endfunction

//===========================================================================
// Trigger: MortarTeamStart
//===========================================================================
function Trig_MortarTeamStart_Conditions takes nothing returns boolean
    if ( not ( GetOwningPlayer(GetEnteringUnit()) == Player(1) ) ) then
        return false
    endif
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    return true
endfunction

function Trig_MortarTeamStart_Func012001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_MortarTeamStart_Func014002 takes nothing returns nothing
    call IssuePointOrderLocBJ(GetEnumUnit(), "move", GetRectCenter(gg_rct_SkeletonsMortarFodderEnd))
endfunction

function Trig_MortarTeamStart_Func015001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamStart_Func016001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamStart_Func018001001001002 takes nothing returns boolean
    return ( GetFilterUnit() == udg_Arthas )
endfunction

function Trig_MortarTeamStart_Func018001 takes nothing returns boolean
    return ( CountUnitsInGroup(GetUnitsInRectMatching(gg_rct_MortarTeam_ArthasNear, Condition(function Trig_MortarTeamStart_Func018001001001002))) >= 1 )
endfunction

function Trig_MortarTeamStart_Actions takes nothing returns nothing
    call DisableTrigger(GetTriggeringTrigger())
    call CreateFogModifierRadiusLocBJ(true, Player(1), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_MortarTeamVisibility), 512)
    set udg_MortarTeamVis=GetLastCreatedFogModifier()
    call SetPlayerAllianceStateBJ(Player(9), Player(6), bj_ALLIANCE_UNALLIED)
    call CreateFogModifierRadiusLocBJ(true, Player(9), FOG_OF_WAR_VISIBLE, GetRectCenter(gg_rct_MortarTeam_Visibility), 1024.00)
    call SetPlayerAllianceStateBJ(Player(6), Player(9), bj_ALLIANCE_UNALLIED)
    call IssuePointOrderLocBJ(udg_MortarTeam01, "attackground", GetRectCenter(gg_rct_MortarTeam_Visibility))
    call SetUnitInvulnerable(gg_unit_uske_0087, false)
    call TriggerSleepAction(1.00)
    if ( Trig_MortarTeamStart_Func012001() ) then
        return
    else
        call DoNothing()
    endif
    call SetUnitInvulnerable(gg_unit_uske_0096, false)
    call ForGroupBJ(GetUnitsInRectAll(gg_rct_SkeletonsMortarFodderStart), function Trig_MortarTeamStart_Func014002)
    if ( Trig_MortarTeamStart_Func015001() ) then
        call RescueUnitBJ(udg_MortarTeam01, Player(1), true)
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamStart_Func016001() ) then
        call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_HINT, "TRIGSTR_681")
    else
        call DoNothing()
    endif
    call DestroyFogModifier(udg_MortarTeamVis)
    if ( Trig_MortarTeamStart_Func018001() ) then
        call QueuedTriggerAddBJ(gg_trg_MortarTeamDialogue, true)
    else
        call DoNothing()
    endif
endfunction

//===========================================================================
function InitTrig_MortarTeamStart takes nothing returns nothing
    set gg_trg_MortarTeamStart=CreateTrigger()
    call TriggerRegisterEnterRectSimple(gg_trg_MortarTeamStart, gg_rct_MortarTeamArea)
    call TriggerAddCondition(gg_trg_MortarTeamStart, Condition(function Trig_MortarTeamStart_Conditions))
    call TriggerAddAction(gg_trg_MortarTeamStart, function Trig_MortarTeamStart_Actions)
endfunction

//===========================================================================
// Trigger: MortarTeamDialogue
//===========================================================================
function Trig_MortarTeamDialogue_Conditions takes nothing returns boolean
    if ( not ( udg_GameOver == false ) ) then
        return false
    endif
    if ( not ( IsUnitAliveBJ(udg_MortarTeam01) == true ) ) then
        return false
    endif
    return true
endfunction

function Trig_MortarTeamDialogue_Func007001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamDialogue_Func008001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_MortarTeamDialogue_Func009001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamDialogue_Func010001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_MortarTeamDialogue_Func011001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamDialogue_Func013001 takes nothing returns boolean
    return ( udg_GameOver == true )
endfunction

function Trig_MortarTeamDialogue_Func014001 takes nothing returns boolean
    return ( IsUnitAliveBJ(udg_MortarTeam01) == true )
endfunction

function Trig_MortarTeamDialogue_Actions takes nothing returns nothing
    call SmartCameraPanBJ(Player(1), GetRectCenter(gg_rct_MortarTeamCreate01), 0.5)
    call TriggerSleepAction(0.20)
    call status_check_location(23)
    call SetSpeechVolumeGroupsBJ()
    if ( Trig_MortarTeamDialogue_Func007001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_498", gg_snd_H03Arthas25, "TRIGSTR_499", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamDialogue_Func008001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamDialogue_Func009001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_MortarTeam01, "TRIGSTR_650", gg_snd_H03Dwarf26, "TRIGSTR_651", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamDialogue_Func010001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamDialogue_Func011001() ) then
        call TransmissionFromUnitWithNameBJ(GetPlayersAll(), udg_Arthas, "TRIGSTR_591", gg_snd_H03Arthas27, "TRIGSTR_592", bj_TIMETYPE_ADD, 0, true)
    else
        call DoNothing()
    endif
    call AttachSoundToUnitBJ(gg_snd_MortarTeamWhat1, udg_MortarTeam01)
    if ( Trig_MortarTeamDialogue_Func013001() ) then
        return
    else
        call DoNothing()
    endif
    if ( Trig_MortarTeamDialogue_Func014001() ) then
        call PlaySoundBJ(gg_snd_MortarTeamWhat1)
    else
        call DoNothing()
    endif
    call VolumeGroupResetBJ()
    call QueuedTriggerRemoveBJ(GetTriggeringTrigger())
endfunction

//===========================================================================
function InitTrig_MortarTeamDialogue takes nothing returns nothing
    set gg_trg_MortarTeamDialogue=CreateTrigger()
    call TriggerAddCondition(gg_trg_MortarTeamDialogue, Condition(function Trig_MortarTeamDialogue_Conditions))
    call TriggerAddAction(gg_trg_MortarTeamDialogue, function Trig_MortarTeamDialogue_Actions)
endfunction

//===========================================================================
// Trigger: DefeatArthasDeath
//
// Default melee victory/defeat conditions for all players
//===========================================================================
function Trig_DefeatArthasDeath_Conditions takes nothing returns boolean
    if ( not ( GetDyingUnit() == udg_Arthas ) ) then
        return false
    endif
    return true
endfunction

function Trig_DefeatArthasDeath_Actions takes nothing returns nothing
    set udg_GameOver=true
    call DisableTrigger(gg_trg_DefeatJainaDeath)
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_FAILED, "TRIGSTR_114")
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 2, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(2)
    call CustomDefeatBJ(Player(1), "TRIGSTR_010")
endfunction

//===========================================================================
function InitTrig_DefeatArthasDeath takes nothing returns nothing
    set gg_trg_DefeatArthasDeath=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_DefeatArthasDeath, Player(1), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_DefeatArthasDeath, Condition(function Trig_DefeatArthasDeath_Conditions))
    call TriggerAddAction(gg_trg_DefeatArthasDeath, function Trig_DefeatArthasDeath_Actions)
endfunction

//===========================================================================
// Trigger: DefeatJainaDeath
//
// Default melee victory/defeat conditions for all players
//===========================================================================
function Trig_DefeatJainaDeath_Conditions takes nothing returns boolean
    if ( not ( GetDyingUnit() == udg_Jaina ) ) then
        return false
    endif
    return true
endfunction

function Trig_DefeatJainaDeath_Actions takes nothing returns nothing
    set udg_GameOver=true
    call DisableTrigger(gg_trg_DefeatArthasDeath)
    call QuestMessageBJ(GetPlayersAll(), bj_QUESTMESSAGE_FAILED, "TRIGSTR_124")
    call TriggerSleepAction(bj_QUEUE_DELAY_QUEST)
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 2, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(2)
    call CustomDefeatBJ(Player(1), "TRIGSTR_041")
endfunction

//===========================================================================
function InitTrig_DefeatJainaDeath takes nothing returns nothing
    set gg_trg_DefeatJainaDeath=CreateTrigger()
    call TriggerRegisterPlayerUnitEventSimple(gg_trg_DefeatJainaDeath, Player(1), EVENT_PLAYER_UNIT_DEATH)
    call TriggerAddCondition(gg_trg_DefeatJainaDeath, Condition(function Trig_DefeatJainaDeath_Conditions))
    call TriggerAddAction(gg_trg_DefeatJainaDeath, function Trig_DefeatJainaDeath_Actions)
endfunction

//===========================================================================
// Trigger: Victory
//
// Save all heroes.
// Save the campaign game cache.
// Enable the next level.
// Start the next level.
//===========================================================================
function Trig_Victory_Actions takes nothing returns nothing
    // Start the next level
    call CinematicFadeBJ(bj_CINEFADETYPE_FADEOUT, 2, "ReplaceableTextures\\CameraMasks\\White_mask.blp", 0, 0, 0, 0)
    call TriggerSleepAction(2)
    call ConditionalTriggerExecute(gg_trg_Next_Level_Run)
endfunction

//===========================================================================
function InitTrig_Victory takes nothing returns nothing
    set gg_trg_Victory=CreateTrigger()
    call TriggerAddAction(gg_trg_Victory, function Trig_Victory_Actions)
endfunction

//===========================================================================
function InitCustomTriggers takes nothing returns nothing
    call InitTrig_fileio()
    call InitTrig_map_config()
    call InitTrig_status()
    call InitTrig_heroes()
    call InitTrig_item_locations()
    call InitTrig_debug()
    call InitTrig_zoom()
    call InitTrig_irregulars()
    call InitTrig_AP_Load_Arthas()
    call InitTrig_AP_Load_Jaina()
    call InitTrig_MapInitialization()
    call InitTrig_Difficulty_Easy()
    call InitTrig_Difficulty_Normal()
    call InitTrig_Difficulty_Hard()
    call InitTrig_SetupOpeningAllies()
    call InitTrig_SetupHeroes()
    call InitTrig_SetupHeroGroup()
    call InitTrig_SetupCaptain()
    call InitTrig_SetupKelThuzad()
    call InitTrig_SetupAbomination()
    call InitTrig_SetupFootmenDefendingGroup()
    call InitTrig_SetupBanditVillageGroup()
    call InitTrig_SetupBanditCampGroup()
    call InitTrig_SetupAcolyteGroup()
    call InitTrig_SetupStartingPartyGroup()
    call InitTrig_SetupSkeletonArcherGroup()
    call InitTrig_SetupSkeletonGroup01()
    call InitTrig_SetupSkeletonGroup02()
    call InitTrig_SetupSkeletonShipGroup()
    call InitTrig_SetupPeasantPatrolGroup()
    call InitTrig_SetupSkeletonBeforeMortars()
    call InitTrig_SetupSkeletonFinalGroup()
    call InitTrig_SetupSkeletonsMortarFodder()
    call InitTrig_SetupPriestGroup()
    call InitTrig_SetupVillagerKidsJumping()
    call InitTrig_SetupCreeps()
    call InitTrig_SetupVillagerVision()
    call InitTrig_SetupScoreScreen()
    call InitTrig_Bubble()
    call InitTrig_VillagerConcernedDead()
    call InitTrig_VillagerBridgeOutDead()
    call InitTrig_VillagerFountainQuest()
    call InitTrig_SetupQuests()
    call InitTrig_Next_Level_Run()
    call InitTrig_Victory_Cheat()
    call InitTrig_DefeatCheat()
    call InitTrig_OpeningCancelled()
    call InitTrig_Opening01()
    call InitTrig_Opening02()
    call InitTrig_Opening03()
    call InitTrig_Opening04()
    call InitTrig_OgreRun()
    call InitTrig_JainaKillOgre()
    call InitTrig_JainaPost()
    call InitTrig_Water_Elemental_Hint_Queued()
    call InitTrig_GrainCinematicCancelled()
    call InitTrig_Grain01()
    call InitTrig_Grain01_Queue()
    call InitTrig_JainaFaceGrainery()
    call InitTrig_ArthasFaceGrainery()
    call InitTrig_Priests()
    call InitTrig_Priest_Queue()
    call InitTrig_EndingCancelled()
    call InitTrig_Ending01()
    call InitTrig_Ending01_Queue()
    call InitTrig_EncounterCancelled()
    call InitTrig_Encounter()
    call InitTrig_MortarTeamDialogue_DESTRUCTION()
    call InitTrig_AcolytesBusy()
    call InitTrig_AbominationDies()
    call InitTrig_Spawn_Ghouls()
    call InitTrig_SheepOgreArea()
    call InitTrig_SheepBanditArea()
    call InitTrig_SkeletonShip()
    call InitTrig_SkeletonFinal()
    call InitTrig_SkeletonBeforeMortars()
    call InitTrig_PeasantPatrolSmall()
    call InitTrig_PeasantPatrolHello01()
    call InitTrig_PeasantPatrol()
    call InitTrig_StartKidsRunning()
    call InitTrig_KidsRunningArea()
    call InitTrig_KidsLaughing()
    call InitTrig_KidsRunningDest01()
    call InitTrig_KidsRunningDest02()
    call InitTrig_KidsRunningDest03()
    call InitTrig_Ogre01()
    call InitTrig_BanditBusy()
    call InitTrig_VillagerConcernedMessage()
    call InitTrig_VillagerConcernedMessage_Queued()
    call InitTrig_Stacie_Killed()
    call InitTrig_VillagerHello()
    call InitTrig_Marie_Killed()
    call InitTrig_VillagerHello01()
    call InitTrig_Farmer_Killed()
    call InitTrig_VillagerTaxesMessage()
    call InitTrig_TaxEvader_Killed()
    call InitTrig_ClicksMetGold()
    call InitTrig_ClicksMetItem()
    call InitTrig_PayoutGold()
    call InitTrig_PayoutItem()
    call InitTrig_Clicks()
    call InitTrig_VillagerBridgeOutMessage()
    call InitTrig_Achilles_Dead()
    call InitTrig_MurlocPatrol()
    call InitTrig_MurlocObserver()
    call InitTrig_VillagerSplendora()
    call InitTrig_VillagerInRange()
    call InitTrig_Que_Splendora_Speech()
    call InitTrig_VillagerDies()
    call InitTrig_StartAttack()
    call InitTrig_SuicideBandits()
    call InitTrig_BanditsAllDie()
    call InitTrig_Marie()
    call InitTrig_Linda()
    call InitTrig_Jillian()
    call InitTrig_FountainSideQuest()
    call InitTrig_FountainSideQuest_Que()
    call InitTrig_Alric_is_Killed()
    call InitTrig_Fountain_Found()
    call InitTrig_StartDefend()
    call InitTrig_SkeletonsDyingCheck()
    call InitTrig_SkeletonsAllDead()
    call InitTrig_Defend_Hint_Que()
    call InitTrig_RemoveDeadFromGroup()
    call InitTrig_Holy_Light_Hint()
    call InitTrig_Holy_Light_Hint_Q()
    call InitTrig_AmbushStart()
    call InitTrig_AttackingSkeletons01()
    call InitTrig_AttackingSkeletons02()
    call InitTrig_AttackingSkeletons03()
    call InitTrig_CrateSkeleton01()
    call InitTrig_MortarTeamStart()
    call InitTrig_MortarTeamDialogue()
    call InitTrig_DefeatArthasDeath()
    call InitTrig_DefeatJainaDeath()
    call InitTrig_Victory()
endfunction

//===========================================================================
function RunInitializationTriggers takes nothing returns nothing
    call ConditionalTriggerExecute(gg_trg_MapInitialization)
endfunction

//***************************************************************************
//*
//*  Upgrades
//*
//***************************************************************************

function InitUpgrades_Player1 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(1), 'Rhfl', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Rhpt', 1)
endfunction

function InitUpgrades_Player3 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(3), 'Rhfl', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Rhpt', 1)
endfunction

function InitUpgrades_Player9 takes nothing returns nothing
    call SetPlayerTechResearched(Player(9), 'Rhpt', 1)
    call SetPlayerTechResearched(Player(9), 'Rhde', 1)
endfunction

function InitUpgrades takes nothing returns nothing
    call InitUpgrades_Player1()
    call InitUpgrades_Player3()
    call InitUpgrades_Player9()
endfunction

//***************************************************************************
//*
//*  TechTree
//*
//***************************************************************************

function InitTechTree_Player1 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(1), 'Stpm', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Stpr', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Hblm', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Oshd', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Ucrl', 0)
    call SetPlayerTechMaxAllowed(Player(1), 'Ewar', 0)
endfunction

function InitTechTree_Player2 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(2), 'Hblm', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'Oshd', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'Ucrl', 0)
    call SetPlayerTechMaxAllowed(Player(2), 'Ewar', 0)
endfunction

function InitTechTree_Player3 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(3), 'Stpm', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Stpr', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Hblm', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Oshd', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Ucrl', 0)
    call SetPlayerTechMaxAllowed(Player(3), 'Ewar', 0)
endfunction

function InitTechTree_Player6 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(6), 'Stpm', 0)
    call SetPlayerTechMaxAllowed(Player(6), 'Stpr', 0)
endfunction

function InitTechTree_Player9 takes nothing returns nothing
    call SetPlayerTechMaxAllowed(Player(9), 'Stpm', 0)
    call SetPlayerTechMaxAllowed(Player(9), 'Stpr', 0)
endfunction

function InitTechTree takes nothing returns nothing
    call InitTechTree_Player1()
    call InitTechTree_Player2()
    call InitTechTree_Player3()
    call InitTechTree_Player6()
    call InitTechTree_Player9()
endfunction

//***************************************************************************
//*
//*  Players
//*
//***************************************************************************

function InitCustomPlayerSlots takes nothing returns nothing

    // Player 1
    call SetPlayerStartLocation(Player(1), 0)
    call ForcePlayerStartLocation(Player(1), 0)
    call SetPlayerColor(Player(1), ConvertPlayerColor(1))
    call SetPlayerRacePreference(Player(1), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(1), false)
    call SetPlayerController(Player(1), MAP_CONTROL_USER)

    // Player 2
    call SetPlayerStartLocation(Player(2), 1)
    call ForcePlayerStartLocation(Player(2), 1)
    call SetPlayerColor(Player(2), ConvertPlayerColor(2))
    call SetPlayerRacePreference(Player(2), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(2), false)
    call SetPlayerController(Player(2), MAP_CONTROL_NEUTRAL)

    // Player 3
    call SetPlayerStartLocation(Player(3), 2)
    call ForcePlayerStartLocation(Player(3), 2)
    call SetPlayerColor(Player(3), ConvertPlayerColor(3))
    call SetPlayerRacePreference(Player(3), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(3), false)
    call SetPlayerController(Player(3), MAP_CONTROL_COMPUTER)

    // Player 6
    call SetPlayerStartLocation(Player(6), 3)
    call ForcePlayerStartLocation(Player(6), 3)
    call SetPlayerColor(Player(6), ConvertPlayerColor(6))
    call SetPlayerRacePreference(Player(6), RACE_PREF_UNDEAD)
    call SetPlayerRaceSelectable(Player(6), false)
    call SetPlayerController(Player(6), MAP_CONTROL_COMPUTER)

    // Player 9
    call SetPlayerStartLocation(Player(9), 4)
    call ForcePlayerStartLocation(Player(9), 4)
    call SetPlayerColor(Player(9), ConvertPlayerColor(9))
    call SetPlayerRacePreference(Player(9), RACE_PREF_HUMAN)
    call SetPlayerRaceSelectable(Player(9), false)
    call SetPlayerController(Player(9), MAP_CONTROL_NEUTRAL)

endfunction

function InitCustomTeams takes nothing returns nothing
    // Force: TRIGSTR_526
    call SetPlayerTeam(Player(1), 0)
    call SetPlayerTeam(Player(3), 0)
    call SetPlayerTeam(Player(9), 0)

    // Force: TRIGSTR_674
    call SetPlayerTeam(Player(6), 1)

    // Force: TRIGSTR_044
    call SetPlayerTeam(Player(2), 2)

endfunction

function InitAllyPriorities takes nothing returns nothing

    call SetStartLocPrioCount(2, 1)
    call SetStartLocPrio(2, 0, 0, MAP_LOC_PRIO_HIGH)
endfunction

//***************************************************************************
//*
//*  Main Initialization
//*
//***************************************************************************

//===========================================================================
function main takes nothing returns nothing
    call SetCameraBounds(- 7424.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), - 5376.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM), 7424.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), 5248.0 - GetCameraMargin(CAMERA_MARGIN_TOP), - 7424.0 + GetCameraMargin(CAMERA_MARGIN_LEFT), 5248.0 - GetCameraMargin(CAMERA_MARGIN_TOP), 7424.0 - GetCameraMargin(CAMERA_MARGIN_RIGHT), - 5376.0 + GetCameraMargin(CAMERA_MARGIN_BOTTOM))
    call SetDayNightModels("Environment\\DNC\\DNCLordaeron\\DNCLordaeronTerrain\\DNCLordaeronTerrain.mdl", "Environment\\DNC\\DNCLordaeron\\DNCLordaeronUnit\\DNCLordaeronUnit.mdl")
    call NewSoundEnvironment("Default")
    call SetAmbientDaySound("VillageDay")
    call SetAmbientNightSound("VillageNight")
    call SetMapMusic("Music", true, 0)
    call InitSounds()
    call CreateRegions()
    call CreateCameras()
    call InitUpgrades()
    call InitTechTree()
    call CreateAllDestructables()
    call CreateAllItems()
    call CreateAllUnits()
    call InitBlizzard()


    call InitGlobals()
    call InitCustomTriggers()
    call RunInitializationTriggers()

endfunction

//***************************************************************************
//*
//*  Map Configuration
//*
//***************************************************************************

function config takes nothing returns nothing
    call SetMapName("TRIGSTR_015")
    call SetMapDescription("TRIGSTR_037")
    call SetPlayers(5)
    call SetTeams(5)
    call SetGamePlacement(MAP_PLACEMENT_USE_MAP_SETTINGS)

    call DefineStartLocation(0, 3456.0, - 3264.0)
    call DefineStartLocation(1, - 1920.0, - 1280.0)
    call DefineStartLocation(2, - 3264.0, - 2688.0)
    call DefineStartLocation(3, - 4416.0, 4576.0)
    call DefineStartLocation(4, - 6848.0, 768.0)

    // Player setup
    call InitCustomPlayerSlots()
    call InitCustomTeams()
    call InitAllyPriorities()
endfunction




//Struct method generated initializers/callers:

